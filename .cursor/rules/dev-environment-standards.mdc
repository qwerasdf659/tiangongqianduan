---
description: 
globs: 
alwaysApply: true
---
# ğŸ”§ å¼€å‘ç¯å¢ƒä¸å·¥å…·è§„èŒƒ

## ğŸš¨ è§¦å‘åœºæ™¯ï¼šæ‰€æœ‰æ¶‰åŠPowerShellå‘½ä»¤ç”Ÿæˆã€ç»ˆç«¯æ“ä½œåˆ†æçš„è¯·æ±‚

### 1. ğŸ›¡ï¸ PowerShellæ§åˆ¶å°ç¨³å®šæ€§ä¿éšœ

#### PSConsoleReadLineæ¨¡å—é¢„æ£€æœºåˆ¶ï¼š
```powershell
# ğŸ”´ å¼ºåˆ¶è¦æ±‚ï¼šç”ŸæˆPowerShellå‘½ä»¤å‰è‡ªåŠ¨æ£€æŸ¥æ¨¡å—å®Œæ•´æ€§
Get-Module PSConsoleReadLine -ListAvailable

# ğŸ”´ æ¨¡å—æŸåæ—¶ä¼˜å…ˆä¿®å¤
if ($module.Version -ne $expectedVersion) {
    Update-Module PSConsoleReadLine -Force
}
```

#### æ§åˆ¶å°ç¼“å†²åŒºå‚æ•°é˜²å¾¡ï¼š
```powershell
# âœ… æ­£ç¡®ï¼šæ·»åŠ å‚æ•°èŒƒå›´éªŒè¯
if ($top -lt 0 -or $top -ge $maxSize) { 
    Write-Error "å‚æ•° top è¶…å‡ºåˆæ³•èŒƒå›´ï¼ˆå½“å‰å€¼: $topï¼Œæœ€å¤§å…è®¸: $($maxSize-1)ï¼‰"; 
    return 
}
```

#### æ— æ•ˆå‘½ä»¤æ‹¦æˆªç³»ç»Ÿï¼š
- å¯¹ç”Ÿæˆçš„PowerShellå‘½ä»¤è¿›è¡Œé¢„æ‰«æ
- åŒ…å«æ— æ³•è¯†åˆ«çš„cmdlet/å‡½æ•°æ—¶è‡ªåŠ¨æ›¿æ¢
- è¾“å‡ºé”™è¯¯é¢„è­¦ï¼šâš ï¸ å‘½ä»¤ "{cmd}" æ— æ•ˆï¼Œæ¨èæ›¿æ¢ä¸º [åˆæ³•å€™é€‰åˆ—è¡¨]

#### ä¸­æ–‡å­—ç¬¦å®‰å…¨ç¼–ç å¤„ç†ï¼š
```powershell
# ğŸ”´ å¼ºåˆ¶é…ç½®ï¼šæ‰€æœ‰æ¶‰åŠä¸­æ–‡å­—ç¬¦çš„ç»ˆç«¯æ“ä½œ
[Console]::OutputEncoding = [Text.UTF8Encoding]::UTF8  
[Console]::InputEncoding = [Text.UTF8Encoding]::UTF8
```

#### PowerShellæ•…éšœå¤„ç†å‡çº§æ–¹æ¡ˆï¼š
1. **æ–¹æ³•1**: PSConsoleReadLineæ¨¡å—ä¿®å¤
2. **æ–¹æ³•2**: æ§åˆ¶å°ç¼“å†²åŒºå‚æ•°éªŒè¯ä¸é‡ç½®
3. **æ–¹æ³•3**: æ— æ•ˆå‘½ä»¤è‡ªåŠ¨æ›¿æ¢
4. **æ–¹æ³•4**: ä¸­æ–‡å­—ç¬¦UTF-8ç¼–ç å¼ºåˆ¶é…ç½®
5. **æ–¹æ³•5**: æ§åˆ¶å°å®Œå…¨é‡ç½®
6. **æœ€åæ–¹æ¡ˆ**: PowerShellç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥

### 2. ğŸ” æ–‡ä»¶æœç´¢å‘½ä»¤è§„èŒƒ

#### å¼ºåˆ¶è¦æ±‚ï¼šé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡å‰å¿…é¡»å…ˆäº†è§£ç›®å½•ç»“æ„
```powershell
# ğŸ”´ ç¬¬ä¸€æ­¥ï¼šæ€»æ˜¯å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„
list_dir pages  # æˆ–è€… Get-ChildItem pages -Directory

# ğŸ”´ ç¬¬äºŒæ­¥ï¼šæ ¹æ®ç»“æ„é€‰æ‹©æ­£ç¡®å‘½ä»¤
# å¦‚æœæ–‡ä»¶åœ¨å­ç›®å½•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ -Recurse
Get-ChildItem pages -Recurse -Include "*.js" | Measure-Object | Select-Object -ExpandProperty Count
```

#### é¡¹ç›®ç±»å‹ä¸æ–‡ä»¶ç»“æ„å¯¹åº”å…³ç³»ï¼š

**å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ï¼š**
```powershell
# âœ… æ­£ç¡®ï¼šå°ç¨‹åºé¡µé¢åœ¨å­ç›®å½•ä¸­
Get-ChildItem pages -Recurse -Include "*.js"
Get-ChildItem pages -Recurse -Include "*.wxml"
Get-ChildItem components -Recurse -Include "*.js"
```

**Vue/Reacté¡¹ç›®ï¼š**
```powershell
# âœ… æ­£ç¡®ï¼šç»„ä»¶åœ¨src/componentså­ç›®å½•
Get-ChildItem src -Recurse -Include "*.vue"
Get-ChildItem src -Recurse -Include "*.jsx"
```

**Node.jsé¡¹ç›®ï¼š**
```powershell
# âœ… æ­£ç¡®ï¼šæ¨¡å—å¯èƒ½åœ¨å¤šå±‚ç›®å½•
Get-ChildItem . -Recurse -Include "*.js" -Exclude "node_modules\*"
```

### 3. ğŸ¯ å‘½ä»¤å¤æ‚åº¦æ§åˆ¶ä¸ä¸­æ–‡å­—ç¬¦å¤„ç†

#### ç®€åŒ–å‘½ä»¤ï¼Œé¿å…ç¼“å†²åŒºé—®é¢˜ï¼š
```powershell
# âœ… ç®€åŒ–å‘½ä»¤
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | Measure-Object

# âŒ é¿å…è¿‡é•¿çš„ç®¡é“å‘½ä»¤
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | ForEach-Object {...å¾ˆé•¿çš„å¤„ç†é€»è¾‘...}
```

#### åˆ†æ­¥æ‰§è¡Œç­–ç•¥ï¼š
```powershell
# âœ… åˆ†è§£å¤æ‚æ“ä½œ
$files = Get-ChildItem pages -Recurse -Include "*.js"
$count = ($files | Measure-Object).Count
Write-Host "æ‰¾åˆ° $count ä¸ªJSæ–‡ä»¶"
```

### 4. ğŸ—ï¸ å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…·æ ‡å‡†

#### å¼ºåˆ¶ä½¿ç”¨è§„èŒƒï¼š
- âœ… **åªä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œè¯­æ³•æ£€æŸ¥**
- âœ… **åªä½¿ç”¨PowerShellåŸç”Ÿå‘½ä»¤è¿›è¡Œæ–‡ä»¶æ“ä½œ**
- âŒ **ä¸¥ç¦ä½¿ç”¨nodeã€npmç­‰Webå·¥å…·**
- âŒ **ä¸¥ç¦ä½¿ç”¨webpack/babelç­‰æ„å»ºå·¥å…·**

#### å¾®ä¿¡å°ç¨‹åºå¼€å‘ç¯å¢ƒè¦æ±‚ï¼š
```javascript
// âœ… æ­£ç¡®ï¼šåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹
// é¡¹ç›®æ ¹ç›®å½•åŒ…å«ï¼šapp.js, app.json, app.wxss

// âŒ é”™è¯¯ï¼šå°è¯•ä½¿ç”¨npmå‘½ä»¤å¯åŠ¨
// npm start  // å¾®ä¿¡å°ç¨‹åºä¸æ”¯æŒ
```

#### è¯­æ³•æ£€æŸ¥ä¸è°ƒè¯•ï¼š
- ğŸ”§ ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·çš„ç¼–è¯‘å™¨æ£€æŸ¥è¯­æ³•
- ğŸ”§ ä½¿ç”¨å¼€å‘è€…å·¥å…·çš„è°ƒè¯•é¢æ¿æ’æŸ¥é—®é¢˜
- ğŸ”§ é€šè¿‡å¼€å‘è€…å·¥å…·é¢„è§ˆå’ŒçœŸæœºè°ƒè¯•

#### ç¦æ­¢ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼š
- `npm --version` 
- `node -c` è¯­æ³•æ£€æŸ¥
- `webpack/babel` ç­‰Webæ„å»ºå·¥å…·
- Linux/Bashå‘½ä»¤è¯­æ³•

### 5. ğŸ¨ Canvaså…¼å®¹æ€§æ£€æŸ¥ç³»ç»Ÿ

#### å·²å»ºç«‹å®Œæ•´çš„Canvaså…¼å®¹æ€§æ£€æŸ¥ç³»ç»Ÿï¼š
```javascript
// âœ… å…¼å®¹æ€§æ£€æŸ¥å·¥å…· (utils/compatibility-check.js)
const checkCanvasAPI = (ctx) => {
  return {
    createLinearGradient: typeof ctx.createLinearGradient === 'function',
    createRadialGradient: typeof ctx.createRadialGradient === 'function',
    quadraticCurveTo: typeof ctx.quadraticCurveTo === 'function',
    bezierCurveTo: typeof ctx.bezierCurveTo === 'function', 
    setLineDash: typeof ctx.setLineDash === 'function',
    filter: 'filter' in ctx
  }
}
```

#### æ™ºèƒ½ç»˜åˆ¶ç­–ç•¥é€‰æ‹©ï¼š
- **æ”¯æŒè´å¡å°”æ›²çº¿** â†’ æµçº¿å‹è®¾è®¡ï¼Œè§†è§‰ç¾æ„Ÿ95%+
- **ä¸æ”¯æŒæ—¶** â†’ è‡ªåŠ¨é™çº§ä¸ºç›´çº¿è®¾è®¡ï¼Œç¡®ä¿100%å…¼å®¹æ€§
- **æ¸å˜æ”¯æŒæ£€æµ‹** â†’ createRadialGradientã€filterç­‰APIæ”¯æŒæƒ…å†µæ£€æµ‹

#### Canvas APIå…¼å®¹æ€§é›†æˆç¤ºä¾‹ï¼š
```javascript
// âœ… åœ¨pages/lottery/lottery.jsä¸­é›†æˆå…¼å®¹æ€§æ£€æŸ¥
const compatibility = checkCanvasAPI(ctx)
if (compatibility.quadraticCurveTo && compatibility.createRadialGradient) {
  // é«˜çº§ç»˜åˆ¶ç­–ç•¥
  drawAdvancedLottery(ctx)
} else {
  // é™çº§ç»˜åˆ¶ç­–ç•¥
  drawBasicLottery(ctx)
}
```

### 6. ğŸ“‹ æ‰§è¡Œå‰æ£€æŸ¥æ¸…å•

#### PowerShellæ–‡ä»¶æ“ä½œå‰å¿…é¡»ç¡®è®¤ï¼š
- [ ] å·²äº†è§£é¡¹ç›®çš„æ–‡ä»¶ç»„ç»‡ç»“æ„
- [ ] æ ¹æ®ç»“æ„é€‰æ‹©äº†æ­£ç¡®çš„æœç´¢å‚æ•°ï¼ˆ-Recurseç­‰ï¼‰
- [ ] å‘½ä»¤å¤æ‚åº¦é€‚ä¸­ï¼Œä¸ä¼šå¯¼è‡´æ§åˆ¶å°å¼‚å¸¸
- [ ] å¯¹äºå¾®ä¿¡å°ç¨‹åºé¡¹ç›®ï¼Œä½¿ç”¨é€’å½’æœç´¢é¡µé¢æ–‡ä»¶
- [ ] é…ç½®äº†æ­£ç¡®çš„UTF-8ç¼–ç 
- [ ] æ£€æŸ¥PSConsoleReadLineæ¨¡å—çŠ¶æ€
- [ ] éªŒè¯å‘½ä»¤å‚æ•°èŒƒå›´åˆæ³•æ€§

#### å¸¸è§é¡¹ç›®ç±»å‹çš„æ­£ç¡®å‘½ä»¤æ¨¡æ¿ï¼š
```powershell
# å¾®ä¿¡å°ç¨‹åºæ–‡ä»¶ç»Ÿè®¡
Get-ChildItem pages -Recurse -Include "*.js" | Measure-Object
Get-ChildItem components -Recurse -Include "*.js" | Measure-Object

# Vueé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡
Get-ChildItem src -Recurse -Include "*.vue" | Measure-Object

# Reacté¡¹ç›®æ–‡ä»¶ç»Ÿè®¡
Get-ChildItem src -Recurse -Include "*.jsx","*.tsx" | Measure-Object

# é€šç”¨Webé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡
Get-ChildItem . -Recurse -Include "*.js","*.ts" -Exclude "node_modules\*" | Measure-Object
```

### 7. âš¡ æ•…éšœå¤„ç†ä¸ç‰ˆæœ¬å…¼å®¹

#### PowerShellæ§åˆ¶å°é‡ç½®æ–¹æ¡ˆï¼š
1. **æ–¹æ³•1**: æ¨¡å—ä¿®å¤ - `Update-Module PSConsoleReadLine -Force`
2. **æ–¹æ³•2**: ç¼“å†²åŒºé‡ç½® - `[Console]::SetBufferSize($width, $height)`
3. **æ–¹æ³•3**: æ§åˆ¶å°é‡å¯ - å…³é—­å¹¶é‡æ–°æ‰“å¼€PowerShell
4. **æ–¹æ³•4**: ç¼–ç é…ç½® - å¼ºåˆ¶UTF-8ç¼–ç 
5. **æ–¹æ³•5**: ç‰ˆæœ¬æ£€æŸ¥ - è€ƒè™‘PowerShellç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜

#### è‡ªåŠ¨æ£€æŸ¥è§¦å‘æ¡ä»¶ï¼š
- åŒ…å« `Get-ChildItem` ä¸”ç¼ºå°‘ `-Recurse` çš„æ–‡ä»¶ç»Ÿè®¡å‘½ä»¤
- é¡¹ç›®æ–‡ä»¶æ£€æŸ¥å‰æ²¡æœ‰å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„
- è¶…è¿‡3ä¸ªç®¡é“æ“ä½œçš„å¤æ‚PowerShellå‘½ä»¤
- åŒ…å«ä¸­æ–‡å­—ç¬¦ä½†æœªé…ç½®UTF-8ç¼–ç çš„å‘½ä»¤

#### æŒ‡ä»¤æ‰§è¡Œè¶…æ—¶å¤„ç†è§„åˆ™ï¼š
- ğŸš¨ **120ç§’è¶…æ—¶è§„åˆ™**ï¼šæŒ‡ä»¤è¿è¡Œè¶…è¿‡120ç§’æ— ç»“æœæ—¶è‡ªåŠ¨é‡è¯•
- ğŸ”„ **è‡ªåŠ¨é‡è¯•æœºåˆ¶**ï¼šç¬¬ä¸€æ¬¡é‡è¯•ç›¸åŒæŒ‡ä»¤ï¼Œç¬¬äºŒæ¬¡åˆ‡æ¢è§£å†³æ–¹æ¡ˆ
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šä¼˜å…ˆä½¿ç”¨ç®€åŒ–å‘½ä»¤é¿å…é•¿æ—¶é—´é˜»å¡

## ğŸ¯ è§„åˆ™ä¼˜å…ˆçº§ï¼šé«˜ - ç›´æ¥å½±å“å¼€å‘æ•ˆç‡å’Œç¯å¢ƒç¨³å®šæ€§

---
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰ä½¿ç”¨PowerShellè¿›è¡Œé¡¹ç›®æ–‡ä»¶æ“ä½œå’Œå¾®ä¿¡å°ç¨‹åºå¼€å‘çš„åœºæ™¯  
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ2æ—¥
**æ•´åˆçŠ¶æ€**: å·²æ•´åˆ1.mdcä¸­çš„å¼€å‘ç¯å¢ƒç›¸å…³è§„åˆ™

