---
description: 
globs: 
alwaysApply: true
---
# ğŸ”§ å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¯å¢ƒç»Ÿä¸€è§„èŒƒ

## ğŸš¨ æ ¸å¿ƒç›®æ ‡ï¼šç¡®ä¿å¼€å‘ç¯å¢ƒç¨³å®šæ€§å’Œè§„åˆ™è‡ªåŠ¨åŒ–æ‰§è¡Œ

### ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€å‘ç¯å¢ƒä¸å·¥å…·è§„èŒƒ

#### 1. ğŸ›¡ï¸ PowerShellæ§åˆ¶å°ç¨³å®šæ€§ä¿éšœ

##### PSConsoleReadLineæ¨¡å—é¢„æ£€æœºåˆ¶
```powershell
# ğŸ”´ å¼ºåˆ¶è¦æ±‚ï¼šç”ŸæˆPowerShellå‘½ä»¤å‰è‡ªåŠ¨æ£€æŸ¥æ¨¡å—å®Œæ•´æ€§
Get-Module PSConsoleReadLine -ListAvailable

# ğŸ”´ æ¨¡å—æŸåæ—¶ä¼˜å…ˆä¿®å¤
if ($module.Version -ne $expectedVersion) {
    Update-Module PSConsoleReadLine -Force
}

# ğŸ”´ å¼ºåˆ¶é…ç½®ï¼šæ‰€æœ‰æ¶‰åŠä¸­æ–‡å­—ç¬¦çš„ç»ˆç«¯æ“ä½œ
[Console]::OutputEncoding = [Text.UTF8Encoding]::UTF8  
[Console]::InputEncoding = [Text.UTF8Encoding]::UTF8
```

##### PowerShellè¯­æ³•ä¸¥æ ¼è§„èŒƒï¼ˆé˜²æ­¢CMDè¯­æ³•é”™è¯¯ï¼‰
```powershell
# âŒ ä¸¥ç¦ï¼šåœ¨PowerShellä¸­ä½¿ç”¨CMDè¯­æ³•
dir /b *.backup 2>nul && echo "æˆåŠŸ" || echo "å¤±è´¥"  # CMDè¯­æ³•ï¼ŒPowerShellä¸æ”¯æŒ

# âœ… æ­£ç¡®ï¼šä½¿ç”¨PowerShellåŸç”Ÿè¯­æ³•
Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($?) { Write-Host "æˆåŠŸ" } else { Write-Host "å¤±è´¥" }

# âœ… ç®€åŒ–ç‰ˆæœ¬ï¼šç›´æ¥ä½¿ç”¨PowerShellæ¡ä»¶åˆ¤æ–­
$backupFiles = Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($backupFiles) { "å‘ç°å¤‡ä»½æ–‡ä»¶: $($backupFiles -join ', ')" } else { "æ— å¤‡ä»½æ–‡ä»¶" }
```

##### PowerShellä¸CMDè¯­æ³•å¯¹ç…§è¡¨
| CMDè¯­æ³• | PowerShellè¯­æ³• | è¯´æ˜ |
|---------|----------------|------|
| `command1 && command2` | `if ($?) { command2 }` | æˆåŠŸæ—¶æ‰§è¡Œ |
| `command1 \|\| command2` | `if (!$?) { command2 }` | å¤±è´¥æ—¶æ‰§è¡Œ |
| `dir /b` | `Get-ChildItem -Name` | åˆ—å‡ºæ–‡ä»¶å |
| `2>nul` | `-ErrorAction SilentlyContinue` | å¿½ç•¥é”™è¯¯ |
| `echo "text"` | `Write-Host "text"` | è¾“å‡ºæ–‡æœ¬ |

#### 2. ğŸ”§ Gitåˆ†é¡µå™¨å¡æ­»é¢„é˜²è§„åˆ™

##### ç¦æ­¢ä½¿ç”¨ä¼šè§¦å‘åˆ†é¡µå™¨çš„Gitå‘½ä»¤
```bash
# âŒ ç»å¯¹ç¦æ­¢ï¼šå¯èƒ½è¿›å…¥åˆ†é¡µå™¨æ¨¡å¼ï¼Œå¯¼è‡´å¡æ­»è¶…è¿‡120ç§’
git log
git branch -v
git diff
git show
git blame

# âŒ å±é™©ï¼šè‡ªåŠ¨åŒ–ç¯å¢ƒæ— æ³•å¤„ç†äº¤äº’
git log --graph
git diff --stat
git show --name-only
```

##### å®‰å…¨çš„Gitå‘½ä»¤æ›¿ä»£æ–¹æ¡ˆ
```bash
# âœ… æ­£ç¡®ï¼šå¼ºåˆ¶ç¦ç”¨åˆ†é¡µå™¨
git --no-pager log --oneline -10
git --no-pager branch -v
git --no-pager diff
git --no-pager show

# âœ… æ­£ç¡®ï¼šé™åˆ¶è¾“å‡ºé¿å…åˆ†é¡µ
git log --oneline -5
git branch -v | head -10
git diff --stat | head -20

# âœ… æ­£ç¡®ï¼šPowerShellç®¡é“å¤„ç†
git log --oneline | Select-Object -First 10
git branch -v | Where-Object { $_ -match "main" }
```

##### æŒ‡ä»¤è¶…æ—¶å¤„ç†è§„åˆ™
```
ğŸš¨ 120ç§’è¶…æ—¶è§„åˆ™ï¼š
- ä¸€æ—¦æŒ‡ä»¤è¿è¡Œè¶…è¿‡120ç§’æ²¡å‡ºä»»ä½•ç»“æœæˆ–æ²¡æœ‰æ­£ç¡®é€€å‡º
- è‡ªåŠ¨é‡æ–°è¿è¡Œè¿™ä¸ªæŒ‡ä»¤ï¼Œå†ä¸è¡Œå°±æ¢å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ
- ç¬¬ä¸€æ¬¡é‡è¯•ï¼šgit --no-pager [åŸå‘½ä»¤]
- ç¬¬äºŒæ¬¡é‡è¯•ï¼šåº”ç”¨å…¨å±€é…ç½®åé‡è¯•
- æœ€åæ–¹æ¡ˆï¼šä½¿ç”¨ç®€åŒ–çš„ç­‰æ•ˆå‘½ä»¤
```

#### 3. ğŸ” æ–‡ä»¶æœç´¢å‘½ä»¤è§„èŒƒ

##### å¼ºåˆ¶è¦æ±‚ï¼šé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡å‰å¿…é¡»å…ˆäº†è§£ç›®å½•ç»“æ„
```powershell
# ğŸ”´ ç¬¬ä¸€æ­¥ï¼šæ€»æ˜¯å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œæ·±åº¦æ€è€ƒç†è§£é¡¹ç›®æ–‡ä»¶ç»„ç»‡
list_dir pages  # æˆ–è€… Get-ChildItem pages -Directory

# ğŸ”´ ç¬¬äºŒæ­¥ï¼šæ ¹æ®ç»“æ„é€‰æ‹©æ­£ç¡®å‘½ä»¤
# å¦‚æœæ–‡ä»¶åœ¨å­ç›®å½•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ -Recurse
Get-ChildItem pages -Recurse -Include "*.js" | Measure-Object | Select-Object -ExpandProperty Count
```

##### å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ–‡ä»¶æ“ä½œè§„èŒƒ
```powershell
# âœ… æ­£ç¡®ï¼šå°ç¨‹åºé¡µé¢åœ¨å­ç›®å½•ä¸­ï¼Œæ³¨æ„ç¬¦åˆå¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†
Get-ChildItem pages -Recurse -Include "*.js"
Get-ChildItem pages -Recurse -Include "*.wxml"
Get-ChildItem components -Recurse -Include "*.js"
Get-ChildItem utils -Recurse -Include "*.js"
```

##### å‘½ä»¤å¤æ‚åº¦æ§åˆ¶ä¸ä¸­æ–‡å­—ç¬¦å¤„ç†
```powershell
# âŒ å·²ç¡®è®¤è§¦å‘å¼‚å¸¸çš„å±é™©å‘½ä»¤ï¼ˆ2025å¹´07æœˆ02æ—¥éªŒè¯ï¼‰
Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count
# é”™è¯¯ï¼šSystem.ArgumentOutOfRangeException: å‚æ•°å: top å®é™…å€¼æ˜¯ -1

# âœ… å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ
ls pages  # ç®€å•ç›´æ¥ï¼Œ100%å¯é 
Get-ChildItem pages -Directory  # åŸºç¡€å‘½ä»¤ï¼Œæ— ç®¡é“é£é™©

# âœ… åˆ†è§£å¤æ‚æ“ä½œ
$dirs = Get-ChildItem pages -Directory
$count = ($dirs | Measure-Object).Count
Write-Host "æ‰¾åˆ° $count ä¸ªç›®å½•"

# âœ… ç®€åŒ–å‘½ä»¤ï¼Œé¿å…ç¼“å†²åŒºé—®é¢˜
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | Measure-Object

# âŒ é¿å…è¿‡é•¿çš„ç®¡é“å‘½ä»¤
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | ForEach-Object {...å¾ˆé•¿çš„å¤„ç†é€»è¾‘...}
```

##### PowerShellå¼‚å¸¸å¿«é€Ÿæ¢å¤ç­–ç•¥ï¼ˆ2025å¹´07æœˆ02æ—¥æ›´æ–°ï¼‰
```powershell
# ğŸ”´ å¼‚å¸¸å‘ç”Ÿæ—¶çš„æ ‡å‡†æ¢å¤æµç¨‹
if (PSConsoleReadLineå¼‚å¸¸) {
    # ç¬¬ä¸€é€‰æ‹©ï¼šä½¿ç”¨ç®€åŒ–çš„ç­‰æ•ˆå‘½ä»¤
    ls pages                    # ä»£æ›¿å¤æ‚çš„Get-ChildItemç®¡é“
    
    # ç¬¬äºŒé€‰æ‹©ï¼šåˆ†è§£å¤æ‚æ“ä½œ
    $items = Get-ChildItem pages
    $count = $items.Count
    
    # ç¬¬ä¸‰é€‰æ‹©ï¼šä½¿ç”¨cmdå…¼å®¹å‘½ä»¤
    dir pages /b
}

# ğŸ”´ é¢„é˜²æ€§æ£€æŸ¥æ¸…å•
function Test-PowerShellCommandSafety($command) {
    $riskFactors = @(
        ($command.Length -gt 80),                    # å‘½ä»¤è¿‡é•¿
        ($command -match '[\u4e00-\u9fa5]'),        # åŒ…å«ä¸­æ–‡
        ($command.Split('|').Count -gt 3),          # ç®¡é“è¿‡å¤š
        ($command -match 'Select-Object.*Expand')    # ç‰¹å®šå±é™©ç»„åˆ
    )
    
    return ($riskFactors | Where-Object { $_ }).Count -eq 0
}
```

#### 4. ğŸ—ï¸ å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…·æ ‡å‡†

##### å¼ºåˆ¶ä½¿ç”¨è§„èŒƒ
- âœ… **åªä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œè¯­æ³•æ£€æŸ¥**
- âœ… **åªä½¿ç”¨PowerShellåŸç”Ÿå‘½ä»¤è¿›è¡Œæ–‡ä»¶æ“ä½œ**
- âŒ **ä¸¥ç¦ä½¿ç”¨nodeã€npmç­‰Webå·¥å…·**
- âŒ **ä¸¥ç¦ä½¿ç”¨webpack/babelç­‰æ„å»ºå·¥å…·**

##### ç¦æ­¢ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨
- `npm --version` 
- `node -c` è¯­æ³•æ£€æŸ¥
- `webpack/babel` ç­‰Webæ„å»ºå·¥å…·
- Linux/Bashå‘½ä»¤è¯­æ³•

### ç¬¬äºŒéƒ¨åˆ†ï¼šè§„åˆ™é¢„é˜²ä¸è‡ªåŠ¨åŒ–ç³»ç»Ÿ

#### ğŸ›¡ï¸ Claude 4 Sonnet ç»¼åˆè§„åˆ™é¢„é˜²æ£€æŸ¥ç³»ç»Ÿ

##### è§„åˆ™ç†è§£ç¡®è®¤æ¸…å• - 2025å¹´7æœˆ4æ—¥æœ€æ–°æ›´æ–°

###### ğŸš¨ å…¨å±€è§„åˆ™ç†è§£ç¡®è®¤ (æ–°å¢ä¼šè¯é—®é¢˜åˆ†æè§„åˆ™)

**1. ä¼šè¯é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆè§„åˆ™ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)**
- âœ… **Açº§é—®é¢˜ï¼ˆä¸¥é‡ï¼‰**: å·¥å…·è°ƒç”¨å‚æ•°éªŒè¯é”™è¯¯ã€å¾®ä¿¡å°ç¨‹åºå¯åŠ¨æ–¹å¼é”™è¯¯ã€PowerShellæ§åˆ¶å°å¼‚å¸¸
- âœ… **Bçº§é—®é¢˜ï¼ˆä¸­ç­‰ï¼‰**: å¹¶è¡Œå·¥å…·è°ƒç”¨åˆ©ç”¨ä¸å……åˆ†ã€å¤§æ–‡ä»¶ç¼–è¾‘ç­–ç•¥é€‰æ‹©ä¸å½“ã€ä¿¡æ¯æ”¶é›†ç­–ç•¥ä¸å®Œæ•´
- âœ… **Cçº§é—®é¢˜ï¼ˆè½»å¾®ï¼‰**: Mockæ•°æ®æ£€æµ‹ä¸å®Œæ•´ã€æœç´¢ç­–ç•¥è¿‡åº¦ç»†åˆ†ã€ä»»åŠ¡éªŒè¯ä¸å®Œæ•´
- âœ… **é¢„é˜²æœºåˆ¶**: å·¥å…·è°ƒç”¨å‚æ•°éªŒè¯ã€å¹¶è¡Œæ‰§è¡Œå¼ºåˆ¶ä¼˜åŒ–ã€æœç´¢ç­–ç•¥ä¼˜åŒ–ã€å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯†åˆ«
- ğŸ†• **2025å¹´7æœˆ4æ—¥æ–°å¢**: 12é¡¹é—®é¢˜è§£å†³æ–¹æ¡ˆå’Œå¼ºåˆ¶é¢„é˜²è§„åˆ™

**2. å¼€å‘è‡ªåŠ¨åŒ–æ ¸å¿ƒè§„åˆ™ (æ›´æ–°)**
- âœ… **PowerShellå‘½ä»¤å®‰å…¨**: ä¸­æ–‡å­—ç¬¦+é•¿å‘½ä»¤æ£€æŸ¥ã€æ§åˆ¶å°ç¨³å®šæ€§ä¿éšœã€120ç§’è¶…æ—¶åˆ‡æ¢
- âœ… **Gitåˆ†é¡µå™¨é¢„é˜²**: å¼ºåˆ¶ç¦ç”¨åˆ†é¡µå™¨ã€å®‰å…¨æ›¿ä»£æ–¹æ¡ˆã€æŒ‡ä»¤è¶…æ—¶å¤„ç†
- âœ… **å¾®ä¿¡å°ç¨‹åºè¯†åˆ«**: é¡¹ç›®ç±»å‹è‡ªåŠ¨è¯†åˆ«ã€å¯åŠ¨æ–¹å¼è§„èŒƒã€å·¥å…·å…¼å®¹æ€§æ£€æŸ¥
- ğŸ†• **2025å¹´7æœˆ4æ—¥æ–°å¢**: å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ

##### ğŸ”§ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ä¸å¯åŠ¨è§„èŒƒ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

```javascript
// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ£€æµ‹å™¨
class WechatMiniProgramDetector {
    constructor() {
        this.requiredFiles = [
            'app.js',      // ä¸»åº”ç”¨é€»è¾‘
            'app.json',    // åº”ç”¨é…ç½®
            'app.wxss',    // å…¨å±€æ ·å¼
            'project.config.json', // é¡¹ç›®é…ç½®
            'pages/',      // é¡µé¢ç›®å½•
            'components/', // ç»„ä»¶ç›®å½•
            'utils/'       // å·¥å…·åº“ç›®å½•
        ]
        
        this.prohibitedCommands = [
            'npm start',
            'npm run dev',
            'node server.js',
            'webpack-dev-server',
            'vite',
            'yarn start'
        ]
    }
    
    // ğŸ”´ é¡¹ç›®ç±»å‹æ£€æµ‹
    detectProjectType(projectPath) {
        const detectedFiles = this.requiredFiles.filter(file => 
            fs.existsSync(path.join(projectPath, file))
        )
        
        const confidence = detectedFiles.length / this.requiredFiles.length
        
        return {
            isMiniProgram: confidence >= 0.7, // 70%ä»¥ä¸Šç‰¹å¾åŒ¹é…
            confidence: confidence,
            detectedFeatures: detectedFiles,
            missingFeatures: this.requiredFiles.filter(file => 
                !detectedFiles.includes(file)
            ),
            startupMethod: confidence >= 0.7 ? 'wechat_devtools' : 'standard_web'
        }
    }
    
    // ğŸ”´ å¯åŠ¨æŒ‡ä»¤éªŒè¯
    validateStartupCommand(command) {
        const isProhibited = this.prohibitedCommands.some(prohibited => 
            command.toLowerCase().includes(prohibited)
        )
        
        if (isProhibited) {
            return {
                valid: false,
                error: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸æ”¯æŒæ­¤å¯åŠ¨æ–¹å¼',
                suggestion: 'è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€é¡¹ç›®',
                prohibitedCommand: command
            }
        }
        
        return { valid: true }
    }
    
    // ğŸ”´ ç”Ÿæˆå¯åŠ¨æŒ‡å—
    generateStartupGuide(projectPath) {
        const detection = this.detectProjectType(projectPath)
        
        if (detection.isMiniProgram) {
            return {
                projectType: 'å¾®ä¿¡å°ç¨‹åº',
                startupMethod: 'å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                steps: [
                    '1. ç¡®ä¿å·²å®‰è£…å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '2. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '3. é€‰æ‹©"å¯¼å…¥é¡¹ç›®"æˆ–"æ‰“å¼€ç›®å½•"',
                    '4. é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•',
                    '5. å¡«å†™AppIDï¼ˆå¯ä½¿ç”¨æµ‹è¯•å·ï¼‰',
                    '6. ç‚¹å‡»"ç¡®å®š"å¼€å§‹å¼€å‘'
                ],
                prohibited: [
                    'âŒ ç¦æ­¢ä½¿ç”¨ npm start',
                    'âŒ ç¦æ­¢ä½¿ç”¨ node å‘½ä»¤',
                    'âŒ ç¦æ­¢ä½¿ç”¨ webpack ç­‰æ„å»ºå·¥å…·',
                    'âŒ ç¦æ­¢ä½¿ç”¨ä»»ä½•Webå¼€å‘æœåŠ¡å™¨'
                ],
                requirements: [
                    'âœ… å¾®ä¿¡å¼€å‘è€…å·¥å…· (å¿…éœ€)',
                    'âœ… å¾®ä¿¡å°ç¨‹åºAppID (å»ºè®®)',
                    'âœ… é¡¹ç›®é…ç½®æ–‡ä»¶å®Œæ•´'
                ]
            }
        }
        
        return {
            projectType: 'æ ‡å‡†Webé¡¹ç›®',
            startupMethod: 'æ ‡å‡†å¯åŠ¨æ–¹å¼',
            steps: ['npm install', 'npm start'],
            prohibited: [],
            requirements: ['Node.js', 'npmæˆ–yarn']
        }
    }
}

// ğŸ”´ å…¨å±€é¡¹ç›®æ£€æµ‹å™¨
const projectDetector = new WechatMiniProgramDetector()

// ğŸ”´ å¼ºåˆ¶ä½¿ç”¨ç¤ºä¾‹
const checkProjectAndStart = (projectPath) => {
    console.log('ğŸ” æ£€æµ‹é¡¹ç›®ç±»å‹...')
    const detection = projectDetector.detectProjectType(projectPath)
    
    if (detection.isMiniProgram) {
        console.log('âœ… æ£€æµ‹åˆ°å¾®ä¿¡å°ç¨‹åºé¡¹ç›®')
        console.log(`ğŸ“Š ç½®ä¿¡åº¦: ${(detection.confidence * 100).toFixed(1)}%`)
        console.log('ğŸ”§ æ£€æµ‹åˆ°çš„ç‰¹å¾:', detection.detectedFeatures.join(', '))
        
        const guide = projectDetector.generateStartupGuide(projectPath)
        console.log('ğŸ“‹ å¯åŠ¨æŒ‡å—:')
        guide.steps.forEach(step => console.log(`   ${step}`))
        console.log('ğŸš¨ ç¦æ­¢æ“ä½œ:')
        guide.prohibited.forEach(prohibition => console.log(`   ${prohibition}`))
        
        return guide
    }
    
    console.log('ğŸ“± æ ‡å‡†Webé¡¹ç›®ï¼Œå¯ä½¿ç”¨npm startç­‰æ–¹å¼å¯åŠ¨')
    return projectDetector.generateStartupGuide(projectPath)
}
```

##### ğŸ”§ Mockæ•°æ®æ£€æµ‹ä¸æ¸…é™¤è‡ªåŠ¨åŒ–è§„åˆ™ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

```javascript
// ğŸ”´ Mockæ•°æ®æ£€æµ‹å™¨
class MockDataDetector {
    constructor() {
        this.mockPatterns = {
            // å‡½æ•°åæ¨¡å¼
            functions: [
                /mock\w*/gi,                    // mockå¼€å¤´çš„å‡½æ•°
                /\w*mock\w*/gi,                 // åŒ…å«mockçš„å‡½æ•°
                /fake\w*/gi,                    // fakeå¼€å¤´çš„å‡½æ•°
                /simulate\w*/gi,                // simulateå¼€å¤´çš„å‡½æ•°
                /dummy\w*/gi,                   // dummyå¼€å¤´çš„å‡½æ•°
                /stub\w*/gi,                    // stubå¼€å¤´çš„å‡½æ•°
                /test\w*data/gi,                // test dataç›¸å…³
                /sample\w*data/gi               // sample dataç›¸å…³
            ],
            
            // å˜é‡åæ¨¡å¼
            variables: [
                /const\s+\w*mock\w*/gi,         // const mockå˜é‡
                /let\s+\w*mock\w*/gi,           // let mockå˜é‡
                /var\s+\w*mock\w*/gi,           // var mockå˜é‡
                /\w*MockData\w*/gi,             // MockDataå˜é‡
                /\w*FakeData\w*/gi,             // FakeDataå˜é‡
                /\w*TestData\w*/gi,             // TestDataå˜é‡
                /\w*SampleData\w*/gi            // SampleDataå˜é‡
            ],
            
            // ç¡¬ç¼–ç æ•°æ®æ¨¡å¼
            hardcoded: [
                /\[\s*\{[\s\S]*?\}\s*\]/g,      // ç¡¬ç¼–ç æ•°ç»„å¯¹è±¡
                /setTimeout\s*\(\s*\(\s*\)\s*=>\s*\{[\s\S]*?\}\s*,\s*\d+\s*\)/g, // setTimeoutæ¨¡æ‹Ÿå¼‚æ­¥
                /Promise\.resolve\s*\(\s*\{[\s\S]*?\}\s*\)/g, // Promise.resolveæ¨¡æ‹Ÿ
                /return\s+\{[\s\S]*?total_points\s*:\s*\d+[\s\S]*?\}/g // ç¡¬ç¼–ç ç§¯åˆ†è¿”å›
            ],
            
            // æ¡ä»¶åˆ¤æ–­æ¨¡å¼
            conditionals: [
                /if\s*\(\s*\w*mock\w*/gi,       // if(mockæ¡ä»¶)
                /\w*mock\w*\s*\?\s*\w+\s*:\s*\w+/gi, // mockä¸‰å…ƒè¿ç®—ç¬¦
                /shouldUseMock/gi,              // shouldUseMockæ¡ä»¶
                /enableMock/gi,                 // enableMockæ¡ä»¶
                /mockMode/gi,                   // mockModeæ¡ä»¶
                /isDev.*mock/gi                 // isDev && mockæ¡ä»¶
            ]
        }
        
        this.approvedPatterns = [
            /console\.log.*mock/gi,             // è°ƒè¯•æ—¥å¿—ä¸­çš„mock (å…è®¸)
            /\/\*[\s\S]*?mock[\s\S]*?\*\//gi,   // æ³¨é‡Šä¸­çš„mock (å…è®¸)
            /\/\/.*mock.*/gi,                   // å•è¡Œæ³¨é‡Šä¸­çš„mock (å…è®¸)
            /import.*mock.*from.*test/gi       // æµ‹è¯•æ–‡ä»¶å¯¼å…¥ (å…è®¸)
        ]
    }
    
    // ğŸ”´ æ£€æµ‹æ–‡ä»¶ä¸­çš„Mockæ•°æ®
    detectMockData(filePath, fileContent) {
        const violations = []
        
        // æ£€æŸ¥å„ç§Mockæ¨¡å¼
        for (const [category, patterns] of Object.entries(this.mockPatterns)) {
            patterns.forEach((pattern, index) => {
                const matches = fileContent.match(pattern)
                if (matches) {
                    // æ£€æŸ¥æ˜¯å¦ä¸ºå…è®¸çš„æ¨¡å¼
                    const isApproved = this.approvedPatterns.some(approvedPattern => 
                        matches.some(match => match.match(approvedPattern))
                    )
                    
                    if (!isApproved) {
                        violations.push({
                            category: category,
                            pattern: pattern.source,
                            matches: matches,
                            severity: this.getSeverity(category),
                            line: this.getLineNumber(fileContent, matches[0])
                        })
                    }
                }
            })
        }
        
        return {
            filePath: filePath,
            hasViolations: violations.length > 0,
            violations: violations,
            totalViolations: violations.length,
            severityBreakdown: this.getSeverityBreakdown(violations)
        }
    }
    
    // ğŸ”´ è·å–è¿è§„ä¸¥é‡ç¨‹åº¦
    getSeverity(category) {
        const severityMap = {
            'hardcoded': 'CRITICAL',        // ç¡¬ç¼–ç æ•°æ®æœ€ä¸¥é‡
            'functions': 'HIGH',            // Mockå‡½æ•°é«˜ä¸¥é‡
            'variables': 'MEDIUM',          // Mockå˜é‡ä¸­ç­‰ä¸¥é‡
            'conditionals': 'LOW'           // æ¡ä»¶åˆ¤æ–­ä½ä¸¥é‡
        }
        return severityMap[category] || 'MEDIUM'
    }
    
    // ğŸ”´ è·å–è¡Œå·
    getLineNumber(content, match) {
        const beforeMatch = content.substring(0, content.indexOf(match))
        return beforeMatch.split('\n').length
    }
    
    // ğŸ”´ ç»Ÿè®¡ä¸¥é‡ç¨‹åº¦åˆ†å¸ƒ
    getSeverityBreakdown(violations) {
        const breakdown = { CRITICAL: 0, HIGH: 0, MEDIUM: 0, LOW: 0 }
        violations.forEach(violation => {
            breakdown[violation.severity]++
        })
        return breakdown
    }
    
    // ğŸ”´ ç”Ÿæˆä¿®å¤å»ºè®®
    generateFixSuggestions(violations) {
        const suggestions = []
        
        violations.forEach(violation => {
            switch (violation.severity) {
                case 'CRITICAL':
                    suggestions.push({
                        type: 'IMMEDIATE_ACTION',
                        message: 'ç«‹å³åˆ é™¤ç¡¬ç¼–ç æ•°æ®ï¼Œä½¿ç”¨çœŸå®APIè°ƒç”¨',
                        code: violation.matches[0],
                        fix: 'api.getData().then(result => { /* ä½¿ç”¨çœŸå®æ•°æ® */ })'
                    })
                    break
                case 'HIGH':
                    suggestions.push({
                        type: 'REPLACE_FUNCTION',
                        message: 'åˆ é™¤Mockå‡½æ•°ï¼Œæ›¿æ¢ä¸ºçœŸå®APIè°ƒç”¨',
                        code: violation.matches[0],
                        fix: 'åˆ é™¤æ­¤å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨çœŸå®API'
                    })
                    break
                case 'MEDIUM':
                    suggestions.push({
                        type: 'REMOVE_VARIABLE',
                        message: 'åˆ é™¤Mockå˜é‡ï¼Œä½¿ç”¨åç«¯æ•°æ®',
                        code: violation.matches[0],
                        fix: 'ä»åç«¯APIè·å–æ•°æ®'
                    })
                    break
                case 'LOW':
                    suggestions.push({
                        type: 'REMOVE_CONDITION',
                        message: 'åˆ é™¤Mockæ¡ä»¶åˆ¤æ–­ï¼Œç®€åŒ–é€»è¾‘',
                        code: violation.matches[0],
                        fix: 'ç›´æ¥ä½¿ç”¨çœŸå®APIï¼Œæ— éœ€æ¡ä»¶åˆ¤æ–­'
                    })
                    break
            }
        })
        
        return suggestions
    }
}

// ğŸ”´ å…¨å±€Mockæ•°æ®æ£€æµ‹å™¨
const mockDetector = new MockDataDetector()

// ğŸ”´ æ‰¹é‡æ£€æµ‹é¡¹ç›®ä¸­çš„Mockæ•°æ®
const scanProjectForMockData = async (projectPath) => {
    const jsFiles = await getAllJSFiles(projectPath)
    const results = []
    
    for (const filePath of jsFiles) {
        const content = await fs.readFile(filePath, 'utf8')
        const detection = mockDetector.detectMockData(filePath, content)
        
        if (detection.hasViolations) {
            results.push(detection)
        }
    }
    
    return {
        totalFiles: jsFiles.length,
        violationFiles: results.length,
        totalViolations: results.reduce((sum, r) => sum + r.totalViolations, 0),
        results: results,
        summary: generateMockDataSummary(results)
    }
}

// ğŸ”´ ç”ŸæˆMockæ•°æ®æ£€æµ‹æŠ¥å‘Š
const generateMockDataSummary = (results) => {
    const summary = {
        CRITICAL: 0,
        HIGH: 0,
        MEDIUM: 0,
        LOW: 0
    }
    
    results.forEach(result => {
        Object.keys(summary).forEach(severity => {
            summary[severity] += result.severityBreakdown[severity] || 0
        })
    })
    
    return {
        severityBreakdown: summary,
        requiresImmediateAction: summary.CRITICAL > 0 || summary.HIGH > 0,
        complianceScore: Math.max(0, 100 - (summary.CRITICAL * 25 + summary.HIGH * 15 + summary.MEDIUM * 10 + summary.LOW * 5)),
        recommendations: generateComplianceRecommendations(summary)
    }
}

// ğŸ”´ ç”Ÿæˆåˆè§„å»ºè®®
const generateComplianceRecommendations = (summary) => {
    const recommendations = []
    
    if (summary.CRITICAL > 0) {
        recommendations.push('ğŸš¨ ç«‹å³ä¿®å¤: å‘ç°ç¡¬ç¼–ç æ•°æ®è¿è§„ï¼Œå¿…é¡»ç«‹å³åˆ é™¤')
    }
    
    if (summary.HIGH > 0) {
        recommendations.push('âš ï¸ é«˜ä¼˜å…ˆçº§: åˆ é™¤Mockå‡½æ•°ï¼Œä½¿ç”¨çœŸå®API')
    }
    
    if (summary.MEDIUM > 0) {
        recommendations.push('ğŸ“‹ ä¸­ä¼˜å…ˆçº§: æ¸…ç†Mockå˜é‡ï¼Œç»Ÿä¸€æ•°æ®æ¥æº')
    }
    
    if (summary.LOW > 0) {
        recommendations.push('ğŸ”§ ä½ä¼˜å…ˆçº§: ç®€åŒ–æ¡ä»¶åˆ¤æ–­ï¼Œå»é™¤Mocké€»è¾‘')
    }
    
    return recommendations
}
```

##### ğŸ”§ ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–è§„åˆ™ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

```javascript
// ğŸ”´ ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–ç³»ç»Ÿ
class TaskValidationAutomation {
    constructor() {
        this.validationRules = {
            // ä»£ç è´¨é‡æ£€æŸ¥
            code_quality: [
                'syntax_check',           // è¯­æ³•æ£€æŸ¥
                'style_consistency',      // é£æ ¼ä¸€è‡´æ€§
                'comment_coverage',       // æ³¨é‡Šè¦†ç›–ç‡
                'error_handling',         // é”™è¯¯å¤„ç†
                'performance_check'       // æ€§èƒ½æ£€æŸ¥
            ],
            
            // åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥
            functionality: [
                'feature_completeness',   // åŠŸèƒ½å®Œæ•´æ€§
                'api_integration',        // APIé›†æˆ
                'data_validation',        // æ•°æ®éªŒè¯
                'user_experience',        // ç”¨æˆ·ä½“éªŒ
                'compatibility'           // å…¼å®¹æ€§
            ],
            
            // å®‰å…¨è§„åˆ™æ£€æŸ¥
            security: [
                'mock_data_removal',      // Mockæ•°æ®æ¸…é™¤
                'sensitive_data_check',   // æ•æ„Ÿæ•°æ®æ£€æŸ¥
                'authorization_check',    // æˆæƒæ£€æŸ¥
                'input_validation',       // è¾“å…¥éªŒè¯
                'secure_communication'    // å®‰å…¨é€šä¿¡
            ],
            
            // é¡¹ç›®é…ç½®æ£€æŸ¥
            project_config: [
                'environment_setup',      // ç¯å¢ƒè®¾ç½®
                'dependency_check',       // ä¾èµ–æ£€æŸ¥
                'build_configuration',    // æ„å»ºé…ç½®
                'deployment_readiness',   // éƒ¨ç½²å°±ç»ª
                'documentation_update'    // æ–‡æ¡£æ›´æ–°
            ]
        }
        
        this.validationResults = {}
    }
    
    // ğŸ”´ æ‰§è¡Œå…¨é¢ä»»åŠ¡éªŒè¯
    async executeFullValidation(projectPath, taskType) {
        console.log(`ğŸ” å¼€å§‹æ‰§è¡Œ${taskType}ä»»åŠ¡éªŒè¯...`)
        
        const validationPlan = this.createValidationPlan(taskType)
        const results = {}
        
        for (const [category, rules] of Object.entries(validationPlan)) {
            console.log(`ğŸ“‹ éªŒè¯ç±»åˆ«: ${category}`)
            results[category] = await this.validateCategory(projectPath, category, rules)
        }
        
        const summary = this.generateValidationSummary(results)
        return {
            taskType: taskType,
            validationResults: results,
            summary: summary,
            passed: summary.overallScore >= 80, // 80åˆ†ä»¥ä¸Šé€šè¿‡
            recommendations: this.generateRecommendations(results)
        }
    }
    
    // ğŸ”´ åˆ›å»ºéªŒè¯è®¡åˆ’
    createValidationPlan(taskType) {
        const basePlan = {
            code_quality: this.validationRules.code_quality,
            security: this.validationRules.security
        }
        
        switch (taskType) {
            case 'frontend_development':
                return {
                    ...basePlan,
                    functionality: this.validationRules.functionality,
                    project_config: this.validationRules.project_config
                }
            case 'api_integration':
                return {
                    ...basePlan,
                    functionality: ['api_integration', 'data_validation'],
                    project_config: ['environment_setup', 'dependency_check']
                }
            case 'security_audit':
                return {
                    security: this.validationRules.security,
                    code_quality: ['syntax_check', 'error_handling']
                }
            default:
                return basePlan
        }
    }
    
    // ğŸ”´ éªŒè¯ç‰¹å®šç±»åˆ«
    async validateCategory(projectPath, category, rules) {
        const results = {}
        
        for (const rule of rules) {
            results[rule] = await this.executeValidationRule(projectPath, category, rule)
        }
        
        return {
            category: category,
            rules: results,
            passed: Object.values(results).every(r => r.passed),
            score: this.calculateCategoryScore(results)
        }
    }
    
    // ğŸ”´ æ‰§è¡Œå…·ä½“éªŒè¯è§„åˆ™
    async executeValidationRule(projectPath, category, rule) {
        switch (rule) {
            case 'mock_data_removal':
                const mockScan = await scanProjectForMockData(projectPath)
                return {
                    passed: mockScan.totalViolations === 0,
                    score: mockScan.summary.complianceScore,
                    details: mockScan.results,
                    message: mockScan.totalViolations === 0 ? 
                        'âœ… æœªå‘ç°Mockæ•°æ®è¿è§„' : 
                        `âŒ å‘ç°${mockScan.totalViolations}ä¸ªMockæ•°æ®è¿è§„`
                }
                
            case 'project_type_detection':
                const detection = projectDetector.detectProjectType(projectPath)
                return {
                    passed: detection.confidence > 0.8,
                    score: detection.confidence * 100,
                    details: detection,
                    message: detection.isMiniProgram ? 
                        'âœ… å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯†åˆ«æ­£ç¡®' : 
                        'âœ… æ ‡å‡†Webé¡¹ç›®è¯†åˆ«æ­£ç¡®'
                }
                
            case 'syntax_check':
                // æ‰§è¡Œè¯­æ³•æ£€æŸ¥
                return await this.performSyntaxCheck(projectPath)
                
            case 'api_integration':
                // æ‰§è¡ŒAPIé›†æˆæ£€æŸ¥
                return await this.checkAPIIntegration(projectPath)
                
            default:
                return {
                    passed: true,
                    score: 100,
                    message: `âœ… ${rule} éªŒè¯é€šè¿‡`
                }
        }
    }
    
    // ğŸ”´ è®¡ç®—ç±»åˆ«è¯„åˆ†
    calculateCategoryScore(results) {
        const scores = Object.values(results).map(r => r.score)
        return scores.reduce((sum, score) => sum + score, 0) / scores.length
    }
    
    // ğŸ”´ ç”ŸæˆéªŒè¯æ‘˜è¦
    generateValidationSummary(results) {
        const categoryScores = Object.entries(results).map(([category, result]) => ({
            category: category,
            score: result.score,
            passed: result.passed
        }))
        
        const overallScore = categoryScores.reduce((sum, c) => sum + c.score, 0) / categoryScores.length
        const allPassed = categoryScores.every(c => c.passed)
        
        return {
            overallScore: overallScore,
            allPassed: allPassed,
            categoryScores: categoryScores,
            grade: this.getGrade(overallScore),
            status: allPassed ? 'PASSED' : 'FAILED'
        }
    }
    
    // ğŸ”´ è·å–ç­‰çº§
    getGrade(score) {
        if (score >= 95) return 'A+'
        if (score >= 90) return 'A'
        if (score >= 80) return 'B'
        if (score >= 70) return 'C'
        return 'F'
    }
    
    // ğŸ”´ ç”Ÿæˆæ”¹è¿›å»ºè®®
    generateRecommendations(results) {
        const recommendations = []
        
        Object.entries(results).forEach(([category, result]) => {
            if (!result.passed) {
                recommendations.push({
                    category: category,
                    priority: result.score < 50 ? 'HIGH' : 'MEDIUM',
                    message: `${category}éœ€è¦æ”¹è¿›ï¼Œå½“å‰å¾—åˆ†: ${result.score.toFixed(1)}`,
                    actions: this.getCategoryActions(category, result)
                })
            }
        })
        
        return recommendations
    }
    
    // ğŸ”´ è·å–ç±»åˆ«æ”¹è¿›è¡ŒåŠ¨
    getCategoryActions(category, result) {
        const actions = {
            'code_quality': [
                'æ£€æŸ¥ä»£ç è¯­æ³•å’Œé£æ ¼',
                'å¢åŠ ä»£ç æ³¨é‡Š',
                'ä¼˜åŒ–é”™è¯¯å¤„ç†',
                'æå‡æ€§èƒ½'
            ],
            'security': [
                'æ¸…é™¤Mockæ•°æ®',
                'æ£€æŸ¥æ•æ„Ÿæ•°æ®',
                'éªŒè¯æˆæƒé€»è¾‘',
                'åŠ å¼ºè¾“å…¥éªŒè¯'
            ],
            'functionality': [
                'å®Œå–„åŠŸèƒ½å®ç°',
                'é›†æˆAPIæ¥å£',
                'éªŒè¯æ•°æ®æµç¨‹',
                'ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ'
            ],
            'project_config': [
                'æ£€æŸ¥ç¯å¢ƒé…ç½®',
                'æ›´æ–°ä¾èµ–é¡¹',
                'å®Œå–„æ„å»ºé…ç½®',
                'å‡†å¤‡éƒ¨ç½²'
            ]
        }
        
        return actions[category] || ['éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥å’Œä¼˜åŒ–']
    }
}

// ğŸ”´ å…¨å±€ä»»åŠ¡éªŒè¯å™¨
const taskValidator = new TaskValidationAutomation()

// ğŸ”´ ä½¿ç”¨ç¤ºä¾‹
const validateTask = async (projectPath, taskType) => {
    console.log(`ğŸš€ å¼€å§‹éªŒè¯ä»»åŠ¡: ${taskType}`)
    
    const validation = await taskValidator.executeFullValidation(projectPath, taskType)
    
    console.log(`ğŸ“Š éªŒè¯ç»“æœ: ${validation.summary.status}`)
    console.log(`ğŸ“ˆ æ€»ä½“å¾—åˆ†: ${validation.summary.overallScore.toFixed(1)} (${validation.summary.grade})`)
    
    if (!validation.passed) {
        console.log('ğŸ”§ æ”¹è¿›å»ºè®®:')
        validation.recommendations.forEach(rec => {
            console.log(`   ${rec.priority}: ${rec.message}`)
        })
    }
    
    return validation
}
```

#### ğŸ¯ è‡ªåŠ¨åŒ–è§„åˆ™æ‰§è¡Œæµç¨‹

##### æ ‡å‡†ä»»åŠ¡æ‰§è¡Œæ¨¡æ¿
```javascript
// ğŸ”´ å¼ºåˆ¶ä½¿ç”¨çš„ä»»åŠ¡æ‰§è¡Œæ¨¡æ¿
async function executeTaskWithRuleCompliance(taskDescription, taskFunction) {
    // Phase 1: ä»»åŠ¡å¼€å§‹å‰æ£€æŸ¥
    console.log('ğŸ¤– ä½¿ç”¨æ¨¡å‹: Claude 4 Sonnet') // ç”¨æˆ·è§„åˆ™ç¬¬10æ¡
    console.log(`ğŸ“… å½“å‰æ—¥æœŸ: ${rulePreventionSystem.getCurrentDate()}`)
    
    // æ•°æ®å®‰å…¨é¢„æ£€æŸ¥
    const securityViolations = await rulePreventionSystem.checkDataSecurityRules(taskDescription)
    if (securityViolations.length > 0) {
        throw new Error(`ğŸš¨ æ•°æ®å®‰å…¨è§„åˆ™è¿è§„: ${securityViolations.join(', ')}`)
    }
    
    // Phase 2: æ‰§è¡Œä»»åŠ¡ï¼ˆå¸¦å®æ—¶ç›‘æ§ï¼‰
    let result
    try {
        result = await rulePreventionSystem.setupTimeoutPrevention(taskFunction())
    } catch (error) {
        console.error('âŒ ä»»åŠ¡æ‰§è¡Œå¤±è´¥:', error.message)
        
        // ç”¨æˆ·è§„åˆ™ç¬¬12æ¡ï¼š120ç§’è¶…æ—¶è‡ªåŠ¨é‡è¯•
        if (error.message.includes('è¶…æ—¶')) {
            console.log('ğŸ”„ æ£€æµ‹åˆ°è¶…æ—¶ï¼Œæ‰§è¡Œè‡ªåŠ¨é‡è¯•...')
            result = await taskFunction() // é‡è¯•æœºåˆ¶
        } else {
            throw error
        }
    }
    
    // Phase 3: ä»»åŠ¡å®ŒæˆåéªŒè¯
    const validationPassed = await taskValidator.runFinalValidation()
    if (!validationPassed) {
        throw new Error('âŒ ä»»åŠ¡å®ŒæˆéªŒè¯å¤±è´¥ï¼Œéœ€è¦ä¿®å¤åå†ç»§ç»­')
    }
    
    console.log('âœ… ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰€æœ‰è§„åˆ™éªŒè¯é€šè¿‡')
    return result
}
```

#### ğŸ“Š æ•ˆç‡ä¼˜åŒ–æŒ‡æ ‡ä¸ç›‘æ§

##### Claude 4 Sonnet è¯·æ±‚æ¬¡æ•°ä¼˜åŒ–ç›®æ ‡
```javascript
// ğŸ”´ è¯·æ±‚æ¬¡æ•°ä¼˜åŒ–ç›‘æ§
class EfficiencyOptimizer {
    constructor() {
        this.metrics = {
            totalRequests: 0,
            parallelRequests: 0,
            wastedRequests: 0,
            timeoutViolations: 0,
            ruleViolations: 0
        }
        this.optimizationTarget = {
            parallelRatio: 0.8,        // 80%å¹¶è¡Œè°ƒç”¨ç‡
            wasteReduction: 0.6,       // 60%æµªè´¹å‡å°‘
            timeoutPrevention: 0.95,   // 95%è¶…æ—¶é¢„é˜²
            ruleCompliance: 1.0        // 100%è§„åˆ™éµå¾ª
        }
    }
    
    // ğŸ”´ æ•ˆç‡æŠ¥å‘Šç”Ÿæˆ
    generateEfficiencyReport() {
        const parallelRatio = this.metrics.parallelRequests / this.metrics.totalRequests
        const wasteRatio = this.metrics.wastedRequests / this.metrics.totalRequests
        const complianceRatio = 1 - (this.metrics.ruleViolations / this.metrics.totalRequests)
        
        return {
            summary: {
                totalRequests: this.metrics.totalRequests,
                parallelRatio: (parallelRatio * 100).toFixed(1) + '%',
                wasteRatio: (wasteRatio * 100).toFixed(1) + '%',
                complianceRate: (complianceRatio * 100).toFixed(1) + '%'
            },
            recommendations: this.generateOptimizationRecommendations(parallelRatio, wasteRatio, complianceRatio)
        }
    }
}

// ğŸ”´ å…¨å±€æ•ˆç‡ä¼˜åŒ–å™¨
const efficiencyOptimizer = new EfficiencyOptimizer()
```

#### ğŸš¨ è¿è§„é¢„è­¦ä¸å¤„ç†æœºåˆ¶

##### å®æ—¶è¿è§„æ£€æµ‹
```javascript
// ğŸ”´ è¿è§„å®æ—¶æ£€æµ‹ä¸å¤„ç†
class RuleViolationHandler {
    constructor() {
        this.violationTypes = {
            DATA_SECURITY: 'æ•°æ®å®‰å…¨è¿è§„',
            EFFICIENCY_WASTE: 'æ•ˆç‡æµªè´¹',
            TIMEOUT_VIOLATION: 'è¶…æ—¶è¿è§„', 
            STANDARD_VIOLATION: 'æ ‡å‡†è¿è§„',
            CLEANUP_VIOLATION: 'æ¸…ç†è¿è§„'
        }
        this.violationLog = []
    }
    
    // ğŸ”´ è¿è§„å¤„ç†æµç¨‹
    async handleViolation(violationType, details) {
        const violation = {
            type: violationType,
            details: details,
            timestamp: new Date().toISOString(),
            resolved: false
        }
        
        this.violationLog.push(violation)
        
        // ç«‹å³åœæ­¢æ“ä½œ
        console.error(`ğŸš¨ æ£€æµ‹åˆ°è§„åˆ™è¿è§„: ${violationType}`)
        console.error(`è¯¦ç»†ä¿¡æ¯: ${details}`)
        
        // æ ¹æ®è¿è§„ç±»å‹æ‰§è¡Œå¯¹åº”å¤„ç†
        switch (violationType) {
            case this.violationTypes.DATA_SECURITY:
                await this.handleDataSecurityViolation(details)
                break
            case this.violationTypes.EFFICIENCY_WASTE:
                await this.handleEfficiencyViolation(details)
                break
            case this.violationTypes.TIMEOUT_VIOLATION:
                await this.handleTimeoutViolation(details)
                break
            default:
                await this.handleGenericViolation(details)
        }
        
        violation.resolved = true
        return violation
    }
    
    // ğŸ”´ æ•°æ®å®‰å…¨è¿è§„å¤„ç†
    async handleDataSecurityViolation(details) {
        console.error('ğŸ” æ•°æ®å®‰å…¨è¿è§„å¤„ç†:')
        console.error('1. ç«‹å³åœæ­¢æ‰€æœ‰å¼€å‘å·¥ä½œ')
        console.error('2. ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç æ•°æ®')
        console.error('3. æ”¹ä¸ºçœŸå®åç«¯APIè°ƒç”¨')
        console.error('4. æ·»åŠ åç«¯å¼‚å¸¸å¤„ç†æœºåˆ¶')
        
        throw new Error('ğŸš¨ ä¸¥é‡è¿è§„ï¼è¿åå¤©å·¥é¡¹ç›®æ ¸å¿ƒå®‰å…¨è§„åˆ™ï¼Œç¦æ­¢ç»§ç»­å¼€å‘ï¼')
    }
}

// ğŸ”´ å…¨å±€è¿è§„å¤„ç†å™¨
const violationHandler = new RuleViolationHandler()
```

## ğŸ“‹ å®Œæ•´æ‰§è¡Œæ£€æŸ¥æ¸…å•

### âœ… ä»»åŠ¡å¼€å§‹å‰å¿…é¡»ç¡®è®¤
- [ ] å·²å£°æ˜ä½¿ç”¨Claude 4 Sonnetæ¨¡å‹
- [ ] å·²è·å–å½“å‰å‡†ç¡®æ—¥æœŸï¼ˆ2025å¹´07æœˆ02æ—¥ï¼‰
- [ ] å·²è¿›è¡Œæ•°æ®å®‰å…¨è§„åˆ™é¢„æ£€æŸ¥
- [ ] å·²è§„åˆ’å¹¶è¡Œå·¥å…·è°ƒç”¨ç­–ç•¥
- [ ] å·²è®¾ç½®120ç§’è¶…æ—¶ç›‘æ§
- [ ] å·²ç¡®è®¤å¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†
- [ ] å·²å‡†å¤‡ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†æœºåˆ¶

### âœ… ä»»åŠ¡æ‰§è¡Œä¸­å¿…é¡»ç›‘æ§
- [ ] å®æ—¶ç›‘æ§å·¥å…·è°ƒç”¨æ•ˆç‡
- [ ] æ£€æµ‹Mockæ•°æ®ä½¿ç”¨æƒ…å†µ
- [ ] ç›‘æ§è¶…æ—¶é£é™©
- [ ] éªŒè¯ä»£ç å…¼å®¹æ€§
- [ ] ç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§

### âœ… ä»»åŠ¡å®Œæˆåå¿…é¡»éªŒè¯
- [ ] é¡¹ç›®è¿è¡ŒçŠ¶æ€å¥åº·æ£€æŸ¥
- [ ] ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
- [ ] æ•°æ®å®‰å…¨è§„åˆ™éªŒè¯
- [ ] ä»£ç è´¨é‡æ ‡å‡†æ£€æŸ¥
- [ ] ç”¨æˆ·è§„åˆ™éµå¾ªéªŒè¯
- [ ] æ•ˆç‡ä¼˜åŒ–æŠ¥å‘Šç”Ÿæˆ

## ğŸ¯ è§„åˆ™é¢„é˜²ç³»ç»Ÿå¯ç”¨ç¡®è®¤

**æ‰€æœ‰è§„åˆ™ç†è§£ç¡®è®¤**: âœ… å®Œæˆ  
**é¢„é˜²æ£€æŸ¥æœºåˆ¶**: âœ… å·²ç”Ÿæˆ  
**è‡ªåŠ¨åŒ–éªŒè¯æµç¨‹**: âœ… å·²å»ºç«‹  
**è¿è§„å¤„ç†æœºåˆ¶**: âœ… å·²éƒ¨ç½²  
**æ•ˆç‡ä¼˜åŒ–ç›‘æ§**: âœ… å·²æ¿€æ´»  

---

**åˆ›å»ºæ—¶é—´**: 2025å¹´07æœˆ02æ—¥  
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰Claude 4 Sonnetå¼€å‘ä»»åŠ¡  
**ç»´æŠ¤çŠ¶æ€**: âœ… æ¿€æ´»ä¸­ - å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¯å¢ƒè§„èŒƒå·²å…¨é¢éƒ¨ç½²  
**ä½¿ç”¨æ¨¡å‹**: Claude 4 Sonnet  
**ä¼˜åŒ–ç›®æ ‡**: é›¶è¿è§„ã€é«˜æ•ˆç‡ã€å®Œå…¨åˆè§„ã€ç¯å¢ƒç¨³å®š

# ğŸ”§ ä¼šè¯é—®é¢˜è§£å†³æ–¹æ¡ˆæ‰©å±• - 2025å¹´7æœˆ4æ—¥

## ğŸš¨ æ–°å¢è‡ªåŠ¨åŒ–è§„èŒƒ

### å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

#### 1. å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ£€æµ‹å™¨
```javascript
// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨æ£€æµ‹å™¨
class WechatMiniProgramDetector {
    constructor() {
        this.requiredFiles = [
            'app.js',      // ä¸»åº”ç”¨é€»è¾‘
            'app.json',    // åº”ç”¨é…ç½®
            'app.wxss',    // å…¨å±€æ ·å¼
            'project.config.json', // é¡¹ç›®é…ç½®
            'pages/',      // é¡µé¢ç›®å½•
            'components/', // ç»„ä»¶ç›®å½•
            'utils/'       // å·¥å…·åº“ç›®å½•
        ]
        
        this.prohibitedCommands = [
            'npm start',
            'npm run dev',
            'node server.js',
            'webpack-dev-server',
            'vite',
            'yarn start'
        ]
    }
    
    // ğŸ”´ é¡¹ç›®ç±»å‹æ£€æµ‹
    detectProjectType(projectPath) {
        const detectedFiles = this.requiredFiles.filter(file => 
            fs.existsSync(path.join(projectPath, file))
        )
        
        const confidence = detectedFiles.length / this.requiredFiles.length
        
        return {
            isMiniProgram: confidence >= 0.7, // 70%ä»¥ä¸Šç‰¹å¾åŒ¹é…
            confidence: confidence,
            detectedFeatures: detectedFiles,
            missingFeatures: this.requiredFiles.filter(file => 
                !detectedFiles.includes(file)
            ),
            startupMethod: confidence >= 0.7 ? 'wechat_devtools' : 'standard_web'
        }
    }
    
    // ğŸ”´ å¯åŠ¨æŒ‡ä»¤éªŒè¯
    validateStartupCommand(command) {
        const isProhibited = this.prohibitedCommands.some(prohibited => 
            command.toLowerCase().includes(prohibited)
        )
        
        if (isProhibited) {
            return {
                valid: false,
                error: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸æ”¯æŒæ­¤å¯åŠ¨æ–¹å¼',
                suggestion: 'è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€é¡¹ç›®',
                prohibitedCommand: command
            }
        }
        
        return { valid: true }
    }
    
    // ğŸ”´ ç”Ÿæˆå¯åŠ¨æŒ‡å—
    generateStartupGuide(projectPath) {
        const detection = this.detectProjectType(projectPath)
        
        if (detection.isMiniProgram) {
            return {
                projectType: 'å¾®ä¿¡å°ç¨‹åº',
                startupMethod: 'å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                steps: [
                    '1. ç¡®ä¿å·²å®‰è£…å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '2. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '3. é€‰æ‹©"å¯¼å…¥é¡¹ç›®"æˆ–"æ‰“å¼€ç›®å½•"',
                    '4. é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•',
                    '5. å¡«å†™AppIDï¼ˆå¯ä½¿ç”¨æµ‹è¯•å·ï¼‰',
                    '6. ç‚¹å‡»"ç¡®å®š"å¼€å§‹å¼€å‘'
                ],
                prohibited: [
                    'âŒ ç¦æ­¢ä½¿ç”¨ npm start',
                    'âŒ ç¦æ­¢ä½¿ç”¨ node å‘½ä»¤',
                    'âŒ ç¦æ­¢ä½¿ç”¨ webpack ç­‰æ„å»ºå·¥å…·',
                    'âŒ ç¦æ­¢ä½¿ç”¨ä»»ä½•Webå¼€å‘æœåŠ¡å™¨'
                ],
                requirements: [
                    'âœ… å¾®ä¿¡å¼€å‘è€…å·¥å…· (å¿…éœ€)',
                    'âœ… å¾®ä¿¡å°ç¨‹åºAppID (å»ºè®®)',
                    'âœ… é¡¹ç›®é…ç½®æ–‡ä»¶å®Œæ•´'
                ]
            }
        }
        
        return {
            projectType: 'æ ‡å‡†Webé¡¹ç›®',
            startupMethod: 'æ ‡å‡†å¯åŠ¨æ–¹å¼',
            steps: ['npm install', 'npm start'],
            prohibited: [],
            requirements: ['Node.js', 'npmæˆ–yarn']
        }
    }
}

// ğŸ”´ å…¨å±€é¡¹ç›®æ£€æµ‹å™¨
const projectDetector = new WechatMiniProgramDetector()
```

#### 2. å¯åŠ¨æ–¹å¼è‡ªåŠ¨çº æ­£ç³»ç»Ÿ
```javascript
// ğŸ”´ å¯åŠ¨æ–¹å¼è‡ªåŠ¨çº æ­£ç³»ç»Ÿ
class StartupMethodCorrector {
    constructor() {
        this.corrections = {
            'npm start': {
                webProject: 'npm start',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            },
            'npm run dev': {
                webProject: 'npm run dev',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            },
            'yarn start': {
                webProject: 'yarn start',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            }
        }
    }
    
    // ğŸ”´ è‡ªåŠ¨çº æ­£å¯åŠ¨æ–¹å¼
    correctStartupMethod(command, projectType) {
        const correction = this.corrections[command]
        
        if (!correction) {
            return { needsCorrection: false, originalCommand: command }
        }
        
        const correctMethod = projectType.isMiniProgram ? 
            correction.miniProgram : 
            correction.webProject
        
        if (correctMethod !== command) {
            return {
                needsCorrection: true,
                originalCommand: command,
                correctMethod: correctMethod,
                message: correction.message,
                projectType: projectType.isMiniProgram ? 'miniProgram' : 'webProject'
            }
        }
        
        return { needsCorrection: false, originalCommand: command }
    }
    
    // ğŸ”´ ç”Ÿæˆçº æ­£æç¤º
    generateCorrectionPrompt(correction) {
        if (correction.projectType === 'miniProgram') {
            return `
âš ï¸ å¯åŠ¨æ–¹å¼é”™è¯¯æ£€æµ‹

âŒ é”™è¯¯å‘½ä»¤: ${correction.originalCommand}
âœ… æ­£ç¡®æ–¹å¼: ${correction.correctMethod}
ğŸ“ è¯´æ˜: ${correction.message}

ğŸ”§ å¾®ä¿¡å°ç¨‹åºæ­£ç¡®å¯åŠ¨æ­¥éª¤:
1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. é€‰æ‹©"å¯¼å…¥é¡¹ç›®"
3. é€‰æ‹©å½“å‰é¡¹ç›®ç›®å½•
4. å¡«å†™AppIDï¼ˆå¯ä½¿ç”¨æµ‹è¯•å·ï¼‰
5. ç‚¹å‡»"å¯¼å…¥"å¼€å§‹å¼€å‘

âŒ ç¦æ­¢ä½¿ç”¨çš„å‘½ä»¤:
- npm start
- npm run dev
- yarn start
- node server.js
- webpack-dev-server
            `
        } else {
            return `
âœ… Webé¡¹ç›®å¯åŠ¨æ–¹å¼æ­£ç¡®
å‘½ä»¤: ${correction.originalCommand}
ç±»å‹: æ ‡å‡†Webé¡¹ç›®
            `
        }
    }
}

// ğŸ”´ å…¨å±€å¯åŠ¨æ–¹å¼çº æ­£å™¨
const startupCorrector = new StartupMethodCorrector()
```

### ä¿¡æ¯æ”¶é›†ç­–ç•¥è§„èŒƒ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

#### 2. ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ç­–ç•¥
```javascript
// ğŸ”´ ä¿¡æ¯æ”¶é›†ç­–ç•¥ç®¡ç†å™¨
class InformationGatheringStrategy {
    constructor() {
        this.phases = {
            phase1: 'project_overview',     // é¡¹ç›®æ¦‚è§ˆé˜¶æ®µ
            phase2: 'detailed_analysis',    // è¯¦ç»†åˆ†æé˜¶æ®µ
            phase3: 'specific_targeting'    // ç‰¹å®šç›®æ ‡é˜¶æ®µ
        }
    }
    
    // ğŸ”´ Phase 1: é¡¹ç›®æ¦‚è§ˆå¹¶è¡Œæ”¶é›†
    async phase1_ProjectOverview(projectPath) {
        console.log('ğŸ“Š Phase 1: é¡¹ç›®æ¦‚è§ˆä¿¡æ¯æ”¶é›†ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰')
        
        // å¹¶è¡Œæ‰§è¡ŒåŸºç¡€ä¿¡æ¯æ”¶é›†
        const [
            projectStructure,
            configFiles,
            packageInfo,
            readmeInfo
        ] = await Promise.all([
            this.getProjectStructure(projectPath),
            this.findConfigFiles(projectPath),
            this.getPackageInfo(projectPath),
            this.getReadmeInfo(projectPath)
        ])
        
        // é¡¹ç›®ç±»å‹æ£€æµ‹
        const projectType = await projectDetector.detectProjectType(projectPath)
        
        return {
            projectStructure,
            configFiles,
            packageInfo,
            readmeInfo,
            projectType,
            phase: 'overview_complete'
        }
    }
    
    // ğŸ”´ å®Œæ•´ä¿¡æ¯æ”¶é›†æµç¨‹
    async executeComprehensiveGathering(projectPath, requirements) {
        console.log('ğŸš€ å¼€å§‹ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ç­–ç•¥')
        
        try {
            // Phase 1: é¡¹ç›®æ¦‚è§ˆ
            const phase1Results = await this.phase1_ProjectOverview(projectPath)
            console.log('âœ… Phase 1 å®Œæˆ')
            
            // Phase 2: è¯¦ç»†åˆ†æ
            const phase2Results = await this.phase2_DetailedAnalysis(phase1Results, requirements.analysisTargets)
            console.log('âœ… Phase 2 å®Œæˆ')
            
            // Phase 3: ç‰¹å®šç›®æ ‡
            const phase3Results = await this.phase3_SpecificTargeting(phase2Results, requirements.specificTargets)
            console.log('âœ… Phase 3 å®Œæˆ')
            
            return {
                phase1: phase1Results,
                phase2: phase2Results,
                phase3: phase3Results,
                status: 'complete'
            }
            
        } catch (error) {
            console.error('âŒ ä¿¡æ¯æ”¶é›†å¤±è´¥:', error)
            throw error
        }
    }
}

// ğŸ”´ å…¨å±€ä¿¡æ¯æ”¶é›†ç­–ç•¥ç®¡ç†å™¨
const informationGatherer = new InformationGatheringStrategy()
```

---

**æ›´æ–°æ—¶é—´**: 2025å¹´7æœˆ4æ—¥  
**æ–°å¢åŠŸèƒ½**: å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ã€ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ç­–ç•¥  
**é€‚ç”¨åœºæ™¯**: æ‰€æœ‰å¾®ä¿¡å°ç¨‹åºå¼€å‘é¡¹ç›®å’ŒWebé¡¹ç›®

# ğŸš€ å·¥å…·è°ƒç”¨æ•ˆç‡ä¸å¹¶è¡Œå¤„ç†è§„èŒƒ (æ–°å¢ - 2025å¹´1æœˆ3æ—¥)

## ğŸ“Š å·¥å…·è°ƒç”¨æ•ˆç‡é—®é¢˜åˆ†æ

### ğŸ”´ é—®é¢˜1ï¼šä¸²è¡Œæ‰§è¡Œæ•ˆç‡ä½ä¸‹
```javascript
// âŒ é”™è¯¯ï¼šä¸²è¡Œæ‰§è¡Œï¼Œæµªè´¹æ—¶é—´
await readFile1()
await readFile2()
await readFile3()
// æ€»æ—¶é—´ï¼š3xå•æ¬¡æ—¶é—´

// âœ… æ­£ç¡®ï¼šå¹¶è¡Œæ‰§è¡Œï¼Œæ˜¾è‘—æå‡æ•ˆç‡
const [result1, result2, result3] = await Promise.all([
    readFile1(),
    readFile2(),
    readFile3()
])
// æ€»æ—¶é—´ï¼šmax(å•æ¬¡æ—¶é—´) â‰ˆ å•æ¬¡æ—¶é—´
```

### ğŸ”´ é—®é¢˜2ï¼šå·¥å…·è°ƒç”¨å‚æ•°éªŒè¯é”™è¯¯
```javascript
// âŒ é”™è¯¯ï¼šå‚æ•°éªŒè¯å¤±è´¥
read_file({
    target_file: 'file.js',
    start_line_one_indexed: 100,
    end_line_one_indexed_inclusive: 50  // é”™è¯¯ï¼šç»“æŸè¡Œå°äºå¼€å§‹è¡Œ
})

// âœ… æ­£ç¡®ï¼šå‚æ•°éªŒè¯é€šè¿‡
read_file({
    target_file: 'file.js',
    start_line_one_indexed: 50,
    end_line_one_indexed_inclusive: 100,  // æ­£ç¡®ï¼šç»“æŸè¡Œå¤§äºå¼€å§‹è¡Œ
    should_read_entire_file: false
})
```

### ğŸ”´ é—®é¢˜3ï¼šsearch_replaceå­—ç¬¦ä¸²åŒ¹é…å¤±è´¥
```javascript
// âŒ é”™è¯¯ï¼šä¸Šä¸‹æ–‡ä¸è¶³ï¼ŒåŒ¹é…å¤±è´¥
const old_string = `const result = api.call()`

// âœ… æ­£ç¡®ï¼šåŒ…å«è¶³å¤Ÿä¸Šä¸‹æ–‡ï¼Œç¡®ä¿å”¯ä¸€åŒ¹é…
const old_string = `
// è°ƒç”¨APIè·å–æ•°æ®
const result = api.call()
if (!result.success) {
    console.error('APIè°ƒç”¨å¤±è´¥')
}
`
```

## ğŸ¯ å¼ºåˆ¶å¹¶è¡Œå·¥å…·è°ƒç”¨è§„èŒƒ

### 1. ğŸ”´ å¤šæ–‡ä»¶è¯»å–å¿…é¡»å¹¶è¡Œ
```javascript
// ğŸ”´ å¼ºåˆ¶è§„åˆ™ï¼šè¯»å–å¤šä¸ªæ–‡ä»¶å¿…é¡»å¹¶è¡Œæ‰§è¡Œ
const readMultipleFiles = async (filePaths) => {
    // âŒ ç¦æ­¢ï¼šä¸²è¡Œè¯»å–
    const results = []
    for (const path of filePaths) {
        results.push(await readFile(path))
    }
    
    // âœ… å¼ºåˆ¶ï¼šå¹¶è¡Œè¯»å–
    const results = await Promise.all(
        filePaths.map(path => readFile(path))
    )
    
    return results
}
```

### 2. ğŸ”´ ä¿¡æ¯æ”¶é›†å¿…é¡»å¹¶è¡Œ
```javascript
// ğŸ”´ ä¿¡æ¯æ”¶é›†é˜¶æ®µå¼ºåˆ¶å¹¶è¡Œ
const gatherProjectInfo = async () => {
    // âœ… æ‰€æœ‰ä¿¡æ¯æ”¶é›†å·¥å…·å¿…é¡»å¹¶è¡Œè°ƒç”¨
    const [
        projectStructure,
        packageInfo,
        configInfo,
        dependencyInfo
    ] = await Promise.all([
        listDirectory('./'),
        readFile('./package.json'),
        readFile('./project.config.json'),
        grepSearch('import.*from', '*.js')
    ])
    
    return {
        projectStructure,
        packageInfo,
        configInfo,
        dependencyInfo
    }
}
```

### 3. ğŸ”´ æœç´¢æ“ä½œå¿…é¡»å¹¶è¡Œ
```javascript
// ğŸ”´ å¤šé‡æœç´¢å¿…é¡»å¹¶è¡Œæ‰§è¡Œ
const comprehensiveSearch = async (searchTerms) => {
    // âœ… æ‰€æœ‰æœç´¢å¿…é¡»å¹¶è¡Œ
    const searchResults = await Promise.all([
        codebaseSearch(searchTerms.semantic),
        grepSearch(searchTerms.exact),
        fileSearch(searchTerms.fileName)
    ])
    
    return {
        semantic: searchResults[0],
        exact: searchResults[1],
        fileName: searchResults[2]
    }
}
```

## ğŸ”§ å·¥å…·è°ƒç”¨å‚æ•°éªŒè¯å¢å¼ºè§„åˆ™

### 1. ğŸ”´ read_fileå‚æ•°å¼ºåˆ¶éªŒè¯
```javascript
const validateReadFileParams = (params) => {
    const errors = []
    
    // æ£€æŸ¥å¿…è¦å‚æ•°
    if (!params.target_file) {
        errors.push('âŒ target_file å‚æ•°ä¸èƒ½ä¸ºç©º')
    }
    
    // æ£€æŸ¥è¡Œå·å‚æ•°
    if (params.start_line_one_indexed && params.end_line_one_indexed_inclusive) {
        if (params.start_line_one_indexed > params.end_line_one_indexed_inclusive) {
            errors.push('âŒ start_line_one_indexed ä¸èƒ½å¤§äº end_line_one_indexed_inclusive')
        }
        
        if (params.start_line_one_indexed < 1) {
            errors.push('âŒ start_line_one_indexed å¿…é¡»å¤§äºç­‰äº1')
        }
        
        const lineRange = params.end_line_one_indexed_inclusive - params.start_line_one_indexed + 1
        if (lineRange < 200) {
            errors.push(`âš ï¸ è¡ŒèŒƒå›´å¤ªå° (${lineRange}è¡Œ)ï¼Œå»ºè®®è‡³å°‘200è¡Œ`)
        }
        
        if (lineRange > 250) {
            errors.push(`âŒ è¡ŒèŒƒå›´å¤ªå¤§ (${lineRange}è¡Œ)ï¼Œæœ€å¤š250è¡Œ`)
        }
    }
    
    if (errors.length > 0) {
        throw new Error('read_fileå‚æ•°éªŒè¯å¤±è´¥:\n' + errors.join('\n'))
    }
    
    return true
}
```

### 2. ğŸ”´ search_replaceå®‰å…¨åŒ¹é…è§„åˆ™
```javascript
const createSafeSearchReplace = (targetContent, newContent, contextLines = 5) => {
    // ğŸ”´ å¼ºåˆ¶åŒ…å«è¶³å¤Ÿä¸Šä¸‹æ–‡
    const lines = targetContent.split('\n')
    const targetIndex = lines.findIndex(line => line.includes(targetContent))
    
    if (targetIndex === -1) {
        throw new Error('âŒ ç›®æ ‡å†…å®¹ä¸å­˜åœ¨')
    }
    
    // åŒ…å«ä¸Šä¸‹æ–‡è¡Œ
    const startIndex = Math.max(0, targetIndex - contextLines)
    const endIndex = Math.min(lines.length - 1, targetIndex + contextLines)
    
    const safeOldString = lines.slice(startIndex, endIndex + 1).join('\n')
    
    // éªŒè¯å”¯ä¸€æ€§
    const occurrences = (targetContent.match(new RegExp(safeOldString, 'g')) || []).length
    if (occurrences > 1) {
        throw new Error('âŒ åŒ¹é…å­—ç¬¦ä¸²ä¸å”¯ä¸€ï¼Œè¯·å¢åŠ æ›´å¤šä¸Šä¸‹æ–‡')
    }
    
    return {
        old_string: safeOldString,
        new_string: newContent,
        confidence: 100
    }
}
```

## ğŸ¯ å‘½ä»¤å…¼å®¹æ€§å¤„ç†è§„èŒƒ

### 1. ğŸ”´ Windows PowerShellå…¼å®¹æ€§
```javascript
// ğŸ”´ Windowså‘½ä»¤å…¼å®¹æ€§å¤„ç†
const getCompatibleCommand = (command, platform = 'win32') => {
    if (platform === 'win32') {
        // Windows PowerShellä¸æ”¯æŒ && è¿æ¥ç¬¦
        return command.replace(/\s*&&\s*/g, '; ')
    }
    return command
}

// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®å¯åŠ¨å‘½ä»¤ä¿®æ­£
const getWechatStartCommand = () => {
    // âŒ é”™è¯¯ï¼šnpm start (å¾®ä¿¡å°ç¨‹åºä¸æ”¯æŒ)
    // âœ… æ­£ç¡®ï¼šä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨
    return 'è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€é¡¹ç›®ç›®å½•å¯åŠ¨å°ç¨‹åº'
}
```

### 2. ğŸ”´ Mockæ•°æ®æ£€æµ‹å¢å¼º
```javascript
// ğŸ”´ Mockæ•°æ®å®Œæ•´æ€§æ£€æµ‹
const detectMockData = (codeContent) => {
    const mockPatterns = [
        /mock.*data/gi,
        /setTimeout.*callback/gi,
        /Math\.random\(\)/gi,
        /const.*=.*\{.*test.*\}/gi,
        /shouldUseMock/gi,
        /smartApiCall/gi
    ]
    
    const detectedMocks = []
    
    mockPatterns.forEach((pattern, index) => {
        const matches = codeContent.match(pattern)
        if (matches) {
            detectedMocks.push({
                pattern: pattern.source,
                matches: matches,
                severity: 'HIGH'
            })
        }
    })
    
    return {
        hasMockData: detectedMocks.length > 0,
        mockCount: detectedMocks.length,
        details: detectedMocks
    }
}
```

## ğŸ“ˆ æ•ˆç‡æå‡ç›®æ ‡

- **å¹¶è¡Œå·¥å…·è°ƒç”¨**: å‡å°‘æ‰§è¡Œæ—¶é—´70%+
- **å‚æ•°éªŒè¯**: å‡å°‘è°ƒç”¨å¤±è´¥ç‡90%+
- **æœç´¢åŒ¹é…**: æå‡æˆåŠŸç‡95%+
- **å‘½ä»¤å…¼å®¹**: æ¶ˆé™¤å¹³å°é”™è¯¯100%

## ğŸ”´ å¼ºåˆ¶æ‰§è¡Œæ£€æŸ¥æ¸…å•

### æ¯æ¬¡å·¥å…·è°ƒç”¨å‰å¿…é¡»ç¡®è®¤ï¼š
- [ ] å¤šä¸ªåªè¯»æ“ä½œæ˜¯å¦å·²å¹¶è¡Œæ‰§è¡Œ
- [ ] read_fileå‚æ•°æ˜¯å¦å·²éªŒè¯
- [ ] search_replaceæ˜¯å¦åŒ…å«è¶³å¤Ÿä¸Šä¸‹æ–‡
- [ ] å‘½ä»¤æ˜¯å¦å…¼å®¹å½“å‰å¹³å°
- [ ] Mockæ•°æ®æ˜¯å¦å·²å®Œå…¨æ¸…é™¤

**ğŸ“… åˆ›å»ºæ—¶é—´**: 2025å¹´1æœˆ3æ—¥  
**ğŸ¯ è§£å†³é—®é¢˜**: å·¥å…·è°ƒç”¨æ•ˆç‡ã€å‚æ•°éªŒè¯ã€å‘½ä»¤å…¼å®¹æ€§  
**ğŸ“Š é¢„æœŸæ•ˆæœ**: æ•´ä½“å¼€å‘æ•ˆç‡æå‡60%+ï¼Œé”™è¯¯ç‡é™ä½85%+

# ğŸ”§ ä¼šè¯é—®é¢˜è§£å†³æ–¹æ¡ˆæ‰©å±• - 2025å¹´7æœˆ4æ—¥

## ğŸš¨ æ–°å¢è‡ªåŠ¨åŒ–è§„èŒƒ

### å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

#### 1. å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ£€æµ‹å™¨
```javascript
// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨æ£€æµ‹å™¨
class WechatMiniProgramDetector {
    constructor() {
        this.requiredFiles = [
            'app.js',      // ä¸»åº”ç”¨é€»è¾‘
            'app.json',    // åº”ç”¨é…ç½®
            'app.wxss',    // å…¨å±€æ ·å¼
            'project.config.json', // é¡¹ç›®é…ç½®
            'pages/',      // é¡µé¢ç›®å½•
            'components/', // ç»„ä»¶ç›®å½•
            'utils/'       // å·¥å…·åº“ç›®å½•
        ]
        
        this.prohibitedCommands = [
            'npm start',
            'npm run dev',
            'node server.js',
            'webpack-dev-server',
            'vite',
            'yarn start'
        ]
    }
    
    // ğŸ”´ é¡¹ç›®ç±»å‹æ£€æµ‹
    detectProjectType(projectPath) {
        const detectedFiles = this.requiredFiles.filter(file => 
            fs.existsSync(path.join(projectPath, file))
        )
        
        const confidence = detectedFiles.length / this.requiredFiles.length
        
        return {
            isMiniProgram: confidence >= 0.7, // 70%ä»¥ä¸Šç‰¹å¾åŒ¹é…
            confidence: confidence,
            detectedFeatures: detectedFiles,
            missingFeatures: this.requiredFiles.filter(file => 
                !detectedFiles.includes(file)
            ),
            startupMethod: confidence >= 0.7 ? 'wechat_devtools' : 'standard_web'
        }
    }
    
    // ğŸ”´ å¯åŠ¨æŒ‡ä»¤éªŒè¯
    validateStartupCommand(command) {
        const isProhibited = this.prohibitedCommands.some(prohibited => 
            command.toLowerCase().includes(prohibited)
        )
        
        if (isProhibited) {
            return {
                valid: false,
                error: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸æ”¯æŒæ­¤å¯åŠ¨æ–¹å¼',
                suggestion: 'è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€é¡¹ç›®',
                prohibitedCommand: command
            }
        }
        
        return { valid: true }
    }
    
    // ğŸ”´ ç”Ÿæˆå¯åŠ¨æŒ‡å—
    generateStartupGuide(projectPath) {
        const detection = this.detectProjectType(projectPath)
        
        if (detection.isMiniProgram) {
            return {
                projectType: 'å¾®ä¿¡å°ç¨‹åº',
                startupMethod: 'å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                steps: [
                    '1. ç¡®ä¿å·²å®‰è£…å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '2. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '3. é€‰æ‹©"å¯¼å…¥é¡¹ç›®"æˆ–"æ‰“å¼€ç›®å½•"',
                    '4. é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•',
                    '5. å¡«å†™AppIDï¼ˆå¯ä½¿ç”¨æµ‹è¯•å·ï¼‰',
                    '6. ç‚¹å‡»"ç¡®å®š"å¼€å§‹å¼€å‘'
                ],
                prohibited: [
                    'âŒ ç¦æ­¢ä½¿ç”¨ npm start',
                    'âŒ ç¦æ­¢ä½¿ç”¨ node å‘½ä»¤',
                    'âŒ ç¦æ­¢ä½¿ç”¨ webpack ç­‰æ„å»ºå·¥å…·',
                    'âŒ ç¦æ­¢ä½¿ç”¨ä»»ä½•Webå¼€å‘æœåŠ¡å™¨'
                ],
                requirements: [
                    'âœ… å¾®ä¿¡å¼€å‘è€…å·¥å…· (å¿…éœ€)',
                    'âœ… å¾®ä¿¡å°ç¨‹åºAppID (å»ºè®®)',
                    'âœ… é¡¹ç›®é…ç½®æ–‡ä»¶å®Œæ•´'
                ]
            }
        }
        
        return {
            projectType: 'æ ‡å‡†Webé¡¹ç›®',
            startupMethod: 'æ ‡å‡†å¯åŠ¨æ–¹å¼',
            steps: ['npm install', 'npm start'],
            prohibited: [],
            requirements: ['Node.js', 'npmæˆ–yarn']
        }
    }
}

// ğŸ”´ å…¨å±€é¡¹ç›®æ£€æµ‹å™¨
const projectDetector = new WechatMiniProgramDetector()
```

#### 2. å¯åŠ¨æ–¹å¼è‡ªåŠ¨çº æ­£ç³»ç»Ÿ
```javascript
// ğŸ”´ å¯åŠ¨æ–¹å¼è‡ªåŠ¨çº æ­£ç³»ç»Ÿ
class StartupMethodCorrector {
    constructor() {
        this.corrections = {
            'npm start': {
                webProject: 'npm start',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            },
            'npm run dev': {
                webProject: 'npm run dev',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            },
            'yarn start': {
                webProject: 'yarn start',
                miniProgram: 'wechat_devtools',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯·ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¯åŠ¨'
            }
        }
    }
    
    // ğŸ”´ è‡ªåŠ¨çº æ­£å¯åŠ¨æ–¹å¼
    correctStartupMethod(command, projectType) {
        const correction = this.corrections[command]
        
        if (!correction) {
            return { needsCorrection: false, originalCommand: command }
        }
        
        const correctMethod = projectType.isMiniProgram ? 
            correction.miniProgram : 
            correction.webProject
        
        if (correctMethod !== command) {
            return {
                needsCorrection: true,
                originalCommand: command,
                correctMethod: correctMethod,
                message: correction.message,
                projectType: projectType.isMiniProgram ? 'miniProgram' : 'webProject'
            }
        }
        
        return { needsCorrection: false, originalCommand: command }
    }
    
    // ğŸ”´ ç”Ÿæˆçº æ­£æç¤º
    generateCorrectionPrompt(correction) {
        if (correction.projectType === 'miniProgram') {
            return `
âš ï¸ å¯åŠ¨æ–¹å¼é”™è¯¯æ£€æµ‹

âŒ é”™è¯¯å‘½ä»¤: ${correction.originalCommand}
âœ… æ­£ç¡®æ–¹å¼: ${correction.correctMethod}
ğŸ“ è¯´æ˜: ${correction.message}

ğŸ”§ å¾®ä¿¡å°ç¨‹åºæ­£ç¡®å¯åŠ¨æ­¥éª¤:
1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. é€‰æ‹©"å¯¼å…¥é¡¹ç›®"
3. é€‰æ‹©å½“å‰é¡¹ç›®ç›®å½•
4. å¡«å†™AppIDï¼ˆå¯ä½¿ç”¨æµ‹è¯•å·ï¼‰
5. ç‚¹å‡»"å¯¼å…¥"å¼€å§‹å¼€å‘

âŒ ç¦æ­¢ä½¿ç”¨çš„å‘½ä»¤:
- npm start
- npm run dev
- yarn start
- node server.js
- webpack-dev-server
            `
        } else {
            return `
âœ… Webé¡¹ç›®å¯åŠ¨æ–¹å¼æ­£ç¡®
å‘½ä»¤: ${correction.originalCommand}
ç±»å‹: æ ‡å‡†Webé¡¹ç›®
            `
        }
    }
}

// ğŸ”´ å…¨å±€å¯åŠ¨æ–¹å¼çº æ­£å™¨
const startupCorrector = new StartupMethodCorrector()
```

### ä¿¡æ¯æ”¶é›†ç­–ç•¥è§„èŒƒ (æ–°å¢ - 2025å¹´7æœˆ4æ—¥)

#### 3. ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ç­–ç•¥
```javascript
// ğŸ”´ ä¿¡æ¯æ”¶é›†ç­–ç•¥ç®¡ç†å™¨
class InformationGatheringStrategy {
    constructor() {
        this.phases = {
            phase1: 'project_overview',     // é¡¹ç›®æ¦‚è§ˆé˜¶æ®µ
            phase2: 'detailed_analysis',    // è¯¦ç»†åˆ†æé˜¶æ®µ
            phase3: 'specific_targeting'    // ç‰¹å®šç›®æ ‡é˜¶æ®µ
        }
    }
    
    // ğŸ”´ Phase 1: é¡¹ç›®æ¦‚è§ˆå¹¶è¡Œæ”¶é›†
    async phase1_ProjectOverview(projectPath) {
        console.log('ğŸ“Š Phase 1: é¡¹ç›®æ¦‚è§ˆä¿¡æ¯æ”¶é›†ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰')
        
        // å¹¶è¡Œæ‰§è¡ŒåŸºç¡€ä¿¡æ¯æ”¶é›†
        const [
            projectStructure,
            configFiles,
            packageInfo,
            readmeInfo
        ] = await Promise.all([
            this.getProjectStructure(projectPath),
            this.findConfigFiles(projectPath),
            this.getPackageInfo(projectPath),
            this.getReadmeInfo(projectPath)
        ])
        
        // é¡¹ç›®ç±»å‹æ£€æµ‹
        const projectType = await projectDetector.detectProjectType(projectPath)
        
        return {
            projectStructure,
            configFiles,
            packageInfo,
            readmeInfo,
            projectType,
            phase: 'overview_complete'
        }
    }
    
    // ğŸ”´ Phase 2: è¯¦ç»†åˆ†æå¹¶è¡Œæ”¶é›†
    async phase2_DetailedAnalysis(phase1Results, analysisTargets) {
        console.log('ğŸ” Phase 2: è¯¦ç»†åˆ†æä¿¡æ¯æ”¶é›†ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰')
        
        // æ ¹æ®Phase1ç»“æœç¡®å®šåˆ†æç›®æ ‡
        const analysisGroups = this.planAnalysisGroups(phase1Results, analysisTargets)
        
        // å¹¶è¡Œæ‰§è¡Œè¯¦ç»†åˆ†æ
        const detailedResults = await Promise.all(
            analysisGroups.map(group => this.executeAnalysisGroup(group))
        )
        
        return {
            detailedResults,
            phase: 'analysis_complete'
        }
    }
    
    // ğŸ”´ Phase 3: ç‰¹å®šç›®æ ‡å¹¶è¡Œæ”¶é›†
    async phase3_SpecificTargeting(phase2Results, specificTargets) {
        console.log('ğŸ¯ Phase 3: ç‰¹å®šç›®æ ‡ä¿¡æ¯æ”¶é›†ï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰')
        
        // åŸºäºå‰ä¸¤ä¸ªé˜¶æ®µçš„ç»“æœï¼Œç²¾ç¡®å®šä½ç‰¹å®šä¿¡æ¯
        const targetingGroups = this.planTargetingGroups(phase2Results, specificTargets)
        
        // å¹¶è¡Œæ‰§è¡Œç‰¹å®šç›®æ ‡æ”¶é›†
        const specificResults = await Promise.all(
            targetingGroups.map(group => this.executeTargetingGroup(group))
        )
        
        return {
            specificResults,
            phase: 'targeting_complete'
        }
    }
    
    // ğŸ”´ å®Œæ•´ä¿¡æ¯æ”¶é›†æµç¨‹
    async executeComprehensiveGathering(projectPath, requirements) {
        console.log('ğŸš€ å¼€å§‹ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ç­–ç•¥')
        
        try {
            // Phase 1: é¡¹ç›®æ¦‚è§ˆ
            const phase1Results = await this.phase1_ProjectOverview(projectPath)
            console.log('âœ… Phase 1 å®Œæˆ')
            
            // Phase 2: è¯¦ç»†åˆ†æ
            const phase2Results = await this.phase2_DetailedAnalysis(phase1Results, requirements.analysisTargets)
            console.log('âœ… Phase 2 å®Œæˆ')
            
            // Phase 3: ç‰¹å®šç›®æ ‡
            const phase3Results = await this.phase3_SpecificTargeting(phase2Results, requirements.specificTargets)
            console.log('âœ… Phase 3 å®Œæˆ')
            
            return {
                phase1: phase1Results,
                phase2: phase2Results,
                phase3: phase3Results,
                status: 'complete',
                efficiency: this.calculateEfficiency()
            }
            
        } catch (error) {
            console.error('âŒ ä¿¡æ¯æ”¶é›†å¤±è´¥:', error)
            throw error
        }
    }
    
    // ğŸ”´ æ•ˆç‡è®¡ç®—
    calculateEfficiency() {
        const totalCalls = this.phases.length * 3 // 3ä¸ªé˜¶æ®µ
        const actualCalls = this.getActualCallCount()
        const efficiency = (totalCalls - actualCalls) / totalCalls * 100
        
        return {
            totalPossibleCalls: totalCalls,
            actualCalls: actualCalls,
            efficiency: efficiency,
            timeSaved: (totalCalls - actualCalls) * 3000 // ä¼°ç®—èŠ‚çœæ—¶é—´
        }
    }
}

// ğŸ”´ å…¨å±€ä¿¡æ¯æ”¶é›†ç­–ç•¥ç®¡ç†å™¨
const informationGatherer = new InformationGatheringStrategy()
```

#### 4. ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–ç³»ç»Ÿ
```javascript
// ğŸ”´ ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–ç³»ç»Ÿ
class TaskValidationSystem {
    constructor() {
        this.validationCategories = {
            'code_quality': ['syntax_check', 'style_check', 'comment_check'],
            'functionality': ['api_integration', 'data_flow', 'error_handling'],
            'security': ['mock_data_check', 'sensitive_data_check', 'auth_check'],
            'performance': ['load_time', 'memory_usage', 'network_calls'],
            'compatibility': ['browser_support', 'device_support', 'api_compatibility']
        }
    }
    
    // ğŸ”´ å…¨é¢ä»»åŠ¡éªŒè¯
    async validateTaskCompletion(taskType, projectPath, modifiedFiles) {
        console.log(`ğŸ” å¼€å§‹ä»»åŠ¡éªŒè¯ï¼š${taskType}`)
        
        // å¹¶è¡Œæ‰§è¡ŒéªŒè¯æ£€æŸ¥
        const validationResults = await Promise.all([
            this.validateCodeQuality(modifiedFiles),
            this.validateFunctionality(projectPath),
            this.validateSecurity(projectPath),
            this.validatePerformance(projectPath),
            this.validateCompatibility(projectPath)
        ])
        
        // ç»¼åˆéªŒè¯ç»“æœ
        const overallResult = this.synthesizeResults(validationResults)
        
        return {
            taskType,
            validationResults,
            overallResult,
            passed: overallResult.score >= 80,
            recommendations: this.generateRecommendations(overallResult)
        }
    }
    
    // ğŸ”´ ç”Ÿæˆæ”¹è¿›å»ºè®®
    generateRecommendations(overallResult) {
        const recommendations = []
        
        if (overallResult.codeQuality < 80) {
            recommendations.push({
                priority: 'HIGH',
                category: 'code_quality',
                message: 'ä»£ç è´¨é‡éœ€è¦æ”¹è¿›',
                actions: ['å¢åŠ ä»£ç æ³¨é‡Š', 'ä¼˜åŒ–ä»£ç ç»“æ„', 'å¤„ç†æ½œåœ¨é”™è¯¯']
            })
        }
        
        if (overallResult.security < 90) {
            recommendations.push({
                priority: 'CRITICAL',
                category: 'security',
                message: 'å®‰å…¨æ€§éœ€è¦åŠ å¼º',
                actions: ['ç§»é™¤Mockæ•°æ®', 'åŠ å¼ºæ•°æ®éªŒè¯', 'å®Œå–„è®¤è¯æœºåˆ¶']
            })
        }
        
        return recommendations
    }
}

// ğŸ”´ å…¨å±€ä»»åŠ¡éªŒè¯ç³»ç»Ÿ
const taskValidator = new TaskValidationSystem()
```

---

**æ›´æ–°æ—¶é—´**: 2025å¹´7æœˆ4æ—¥  
**æ–°å¢åŠŸèƒ½**: å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ã€å¯åŠ¨æ–¹å¼çº æ­£ã€ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ã€ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–  
**é€‚ç”¨åœºæ™¯**: æ‰€æœ‰å¾®ä¿¡å°ç¨‹åºå¼€å‘é¡¹ç›®å’ŒWebé¡¹ç›®  
**æ•ˆç‡æå‡**: é¢„è®¡å‡å°‘50-80%çš„é‡å¤æ€§å·¥ä½œå’Œé”™è¯¯çº æ­£æ—¶é—´

---

**æ›´æ–°æ—¶é—´**: 2025å¹´7æœˆ4æ—¥  
**æ–°å¢è§„åˆ™**: å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯†åˆ«ã€å¹¶è¡Œå·¥å…·è°ƒç”¨ä¼˜åŒ–ã€PowerShellå‘½ä»¤å®‰å…¨æ£€æŸ¥ã€120ç§’è¶…æ—¶å¤„ç†  
**ç›®æ ‡**: è§£å†³ä¼šè¯ä¸­çš„æ‰€æœ‰æ•ˆç‡é—®é¢˜ï¼Œé˜²æ­¢é‡å¤å‡ºç°

## ğŸ†• 2025å¹´7æœˆ4æ—¥æ–°å¢è§„åˆ™ - åŸºäºå‰ç«¯èŠå¤©è§„åˆ™æ•´ç†é—®é¢˜åˆ†æ

### ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¾®ä¿¡å°ç¨‹åºé¡¹ç›®è¯†åˆ«ä¸å¯åŠ¨è§„èŒƒ

#### ğŸ” å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ
```javascript
// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ£€æµ‹å™¨
class WechatMiniProgramDetector {
    constructor() {
        this.requiredFiles = [
            'app.js',                 // ä¸»åº”ç”¨é€»è¾‘
            'app.json',               // åº”ç”¨é…ç½®
            'app.wxss',               // å…¨å±€æ ·å¼
            'project.config.json',    // é¡¹ç›®é…ç½®
            'pages/',                 // é¡µé¢ç›®å½•
            'components/',            // ç»„ä»¶ç›®å½•
            'utils/'                  // å·¥å…·åº“ç›®å½•
        ]
        
        this.prohibitedCommands = [
            'npm start',              // Webé¡¹ç›®å¯åŠ¨æ–¹å¼
            'npm run dev',            // Webé¡¹ç›®å¼€å‘æ¨¡å¼
            'node server.js',         // Node.jsæœåŠ¡å™¨å¯åŠ¨
            'webpack-dev-server',     // Webpackå¼€å‘æœåŠ¡å™¨
            'vite',                   // Viteæ„å»ºå·¥å…·
            'yarn start',             // YarnåŒ…ç®¡ç†å™¨å¯åŠ¨
            'ng serve',               // Angularå¼€å‘æœåŠ¡å™¨
            'vue-cli-service serve'   // Vue CLIå¼€å‘æœåŠ¡å™¨
        ]
        
        this.wechatSpecificFiles = [
            'sitemap.json',           // å¾®ä¿¡å°ç¨‹åºé…ç½®
            'project.private.config.json', // ç§æœ‰é…ç½®
            'pages/index/index.js',   // é»˜è®¤é¦–é¡µ
            'pages/index/index.wxml', // é»˜è®¤é¦–é¡µæ¨¡æ¿
            'pages/index/index.wxss', // é»˜è®¤é¦–é¡µæ ·å¼
            'pages/index/index.json'  // é»˜è®¤é¦–é¡µé…ç½®
        ]
    }
    
    // ğŸ”´ é¡¹ç›®ç±»å‹æ£€æµ‹
    detectProjectType(projectPath) {
        const detectedFiles = this.requiredFiles.filter(file => 
            this.fileExists(path.join(projectPath, file))
        )
        
        const wechatFiles = this.wechatSpecificFiles.filter(file => 
            this.fileExists(path.join(projectPath, file))
        )
        
        const basicConfidence = detectedFiles.length / this.requiredFiles.length
        const wechatConfidence = wechatFiles.length / this.wechatSpecificFiles.length
        
        const totalConfidence = (basicConfidence * 0.7) + (wechatConfidence * 0.3)
        
        return {
            isMiniProgram: totalConfidence >= 0.6, // 60%ä»¥ä¸Šç‰¹å¾åŒ¹é…
            confidence: totalConfidence,
            basicFeatures: detectedFiles,
            wechatFeatures: wechatFiles,
            missingFeatures: this.requiredFiles.filter(file => 
                !detectedFiles.includes(file)
            ),
            startupMethod: totalConfidence >= 0.6 ? 'wechat_devtools' : 'standard_web',
            projectType: this.determineProjectType(totalConfidence)
        }
    }
    
    // ğŸ”´ å¯åŠ¨æŒ‡ä»¤éªŒè¯
    validateStartupCommand(command, projectType) {
        const lowerCommand = command.toLowerCase()
        
        const isProhibited = this.prohibitedCommands.some(prohibited => 
            lowerCommand.includes(prohibited)
        )
        
        if (isProhibited && projectType.startsWith('wechat_miniprogram')) {
            return {
                isValid: false,
                error: 'MINIPROGRAM_STARTUP_ERROR',
                message: 'å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸èƒ½ä½¿ç”¨Webé¡¹ç›®å¯åŠ¨æ–¹å¼',
                correctMethod: 'wechat_developer_tools',
                suggestions: [
                    '1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·',
                    '2. å¯¼å…¥é¡¹ç›®ç›®å½•',
                    '3. åœ¨å¼€å‘è€…å·¥å…·ä¸­é¢„è§ˆå’Œè°ƒè¯•',
                    '4. ä½¿ç”¨å¼€å‘è€…å·¥å…·çš„ç¼–è¯‘åŠŸèƒ½'
                ]
            }
        }
        
        return {
            isValid: true,
            message: 'å¯åŠ¨æŒ‡ä»¤éªŒè¯é€šè¿‡'
        }
    }
}

// ğŸ”´ å…¨å±€å¾®ä¿¡å°ç¨‹åºæ£€æµ‹å™¨
const miniProgramDetector = new WechatMiniProgramDetector()
```

#### ğŸš¨ å¾®ä¿¡å°ç¨‹åºå¯åŠ¨æ–¹å¼é”™è¯¯é¢„é˜²è§„åˆ™
```bash
# âŒ ç»å¯¹ç¦æ­¢ï¼šåœ¨å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸­ä½¿ç”¨è¿™äº›å‘½ä»¤
npm start                    # Webé¡¹ç›®å¯åŠ¨æ–¹å¼
npm run dev                  # Webé¡¹ç›®å¼€å‘æ¨¡å¼  
node server.js               # Node.jsæœåŠ¡å™¨å¯åŠ¨
webpack-dev-server          # Webpackå¼€å‘æœåŠ¡å™¨
vite                        # Viteæ„å»ºå·¥å…·
yarn start                  # YarnåŒ…ç®¡ç†å™¨å¯åŠ¨
ng serve                    # Angularå¼€å‘æœåŠ¡å™¨
vue-cli-service serve       # Vue CLIå¼€å‘æœåŠ¡å™¨

# âœ… æ­£ç¡®ï¼šå¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ“ä½œæ–¹å¼
# 1. ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€é¡¹ç›®
# 2. ä½¿ç”¨PowerShellè¿›è¡Œæ–‡ä»¶æ“ä½œ
# 3. ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶
# 4. ä½¿ç”¨Windowsèµ„æºç®¡ç†å™¨ç®¡ç†æ–‡ä»¶
```

### ç¬¬å››éƒ¨åˆ†ï¼šå¹¶è¡Œå·¥å…·è°ƒç”¨å¼ºåˆ¶ä¼˜åŒ–è§„èŒƒ

#### ğŸš€ å¹¶è¡Œå·¥å…·è°ƒç”¨æ£€æµ‹ä¸ä¼˜åŒ–ç³»ç»Ÿ
```javascript
// ğŸ”´ å¹¶è¡Œå·¥å…·è°ƒç”¨ä¼˜åŒ–ç®¡ç†å™¨
class ParallelToolCallOptimizer {
    constructor() {
        this.readOnlyTools = [
            'read_file',
            'grep_search', 
            'list_dir',
            'file_search',
            'codebase_search',
            'run_terminal_cmd' // åªè¯»å‘½ä»¤
        ]
        
        this.statistics = {
            totalCalls: 0,
            parallelCalls: 0,
            serialCalls: 0,
            timeSaved: 0,
            efficiencyGain: 0
        }
    }
    
    // ğŸ”´ æ£€æµ‹å¯å¹¶è¡Œçš„å·¥å…·è°ƒç”¨
    detectParallelOpportunities(toolCalls) {
        const opportunities = []
        
        // æŒ‰å·¥å…·ç±»å‹åˆ†ç»„
        const readOnlyGroup = toolCalls.filter(call => 
            this.readOnlyTools.includes(call.toolName)
        )
        
        // åªè¯»æ“ä½œå¯ä»¥å®Œå…¨å¹¶è¡Œ
        if (readOnlyGroup.length > 1) {
            opportunities.push({
                type: 'readonly_parallel',
                tools: readOnlyGroup,
                estimatedTimeSaving: (readOnlyGroup.length - 1) * 3000, // 3ç§’/å·¥å…·
                riskLevel: 'low'
            })
        }
        
        return opportunities
    }
    
    // ğŸ”´ æ‰§è¡Œå¹¶è¡Œå·¥å…·è°ƒç”¨
    async executeParallelToolCalls(opportunities) {
        console.log(`ğŸš€ å¼€å§‹å¹¶è¡Œå·¥å…·è°ƒç”¨ä¼˜åŒ–ï¼Œå‘ç°${opportunities.length}ä¸ªä¼˜åŒ–æœºä¼š`)
        
        const results = []
        
        for (const opportunity of opportunities) {
            const startTime = Date.now()
            
            console.log(`âš¡ å¹¶è¡Œæ‰§è¡Œ${opportunity.type}ï¼š${opportunity.tools.length}ä¸ªå·¥å…·`)
            
            try {
                const parallelResults = await Promise.all(
                    opportunity.tools.map(tool => this.executeTool(tool))
                )
                
                const endTime = Date.now()
                const actualTimeSaving = endTime - startTime
                
                results.push({
                    type: opportunity.type,
                    success: true,
                    results: parallelResults,
                    timeSaving: actualTimeSaving,
                    toolCount: opportunity.tools.length
                })
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                this.updateStatistics(opportunity.tools.length, actualTimeSaving)
                
                console.log(`âœ… ${opportunity.type}å®Œæˆï¼Œè€—æ—¶${actualTimeSaving}ms`)
                
            } catch (error) {
                console.error(`âŒ ${opportunity.type}æ‰§è¡Œå¤±è´¥:`, error)
                results.push({
                    type: opportunity.type,
                    success: false,
                    error: error.message
                })
            }
        }
        
        return results
    }
    
    // ğŸ”´ ç”Ÿæˆæ•ˆç‡æŠ¥å‘Š
    generateEfficiencyReport() {
        const report = {
            ...this.statistics,
            averageTimeSaving: this.statistics.timeSaved / this.statistics.parallelCalls,
            efficiencyPercentage: (this.statistics.efficiencyGain * 100).toFixed(1)
        }
        
        console.log('ğŸ“Š å¹¶è¡Œå·¥å…·è°ƒç”¨æ•ˆç‡æŠ¥å‘Šï¼š')
        console.log(`  - æ€»å·¥å…·è°ƒç”¨ï¼š${report.totalCalls}`)
        console.log(`  - å¹¶è¡Œè°ƒç”¨ï¼š${report.parallelCalls}`)
        console.log(`  - æ—¶é—´èŠ‚çœï¼š${report.timeSaved}ms`)
        console.log(`  - æ•ˆç‡æå‡ï¼š${report.efficiencyPercentage}%`)
        
        return report
    }
}

// ğŸ”´ å…¨å±€å¹¶è¡Œå·¥å…·è°ƒç”¨ä¼˜åŒ–å™¨
const parallelToolOptimizer = new ParallelToolCallOptimizer()
```

### ç¬¬äº”éƒ¨åˆ†ï¼šPowerShellå‘½ä»¤å®‰å…¨å¼ºåŒ–è§„èŒƒ

#### ğŸ›¡ï¸ PowerShellå‘½ä»¤å®‰å…¨æ£€æŸ¥ç³»ç»Ÿ
```javascript
// ğŸ”´ PowerShellå‘½ä»¤å®‰å…¨æ£€æŸ¥å™¨
class PowerShellSafetyChecker {
    constructor() {
        this.dangerousPatterns = [
            {
                pattern: /.*\|.*\|.*\|.*/,  // å¤šé‡ç®¡é“
                risk: 'high',
                message: 'å¤šé‡ç®¡é“æ“ä½œå¯èƒ½å¯¼è‡´æ§åˆ¶å°å¼‚å¸¸'
            },
            {
                pattern: /.*Select-Object.*ExpandProperty.*/,  // å±é™©çš„Select-Objectç»„åˆ
                risk: 'high', 
                message: 'Select-Object -ExpandPropertyç»„åˆå·²çŸ¥ä¼šå¯¼è‡´ç¼“å†²åŒºå¼‚å¸¸'
            },
            {
                pattern: /.*Get-ChildItem.*Measure-Object.*Select-Object.*/,  // å±é™©çš„ä¸‰é‡ç»„åˆ
                risk: 'critical',
                message: 'Get-ChildItem + Measure-Object + Select-Objectç»„åˆä¼šå¯¼è‡´æ§åˆ¶å°å´©æºƒ'
            },
            {
                pattern: /.*[\u4e00-\u9fa5].*\|.*\|.*/,  // ä¸­æ–‡å­—ç¬¦ + å¤šé‡ç®¡é“
                risk: 'critical',
                message: 'ä¸­æ–‡å­—ç¬¦ä¸å¤šé‡ç®¡é“ç»„åˆä¼šå¯¼è‡´PSConsoleReadLineå¼‚å¸¸'
            }
        ]
        
        this.safeModes = {
            'file_listing': {
                dangerous: 'Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count',
                safe: 'ls pages',
                alternative: '(Get-ChildItem pages -Directory).Count'
            },
            'file_counting': {
                dangerous: 'Get-ChildItem -Recurse -Include "*.js" | Measure-Object | Select-Object -ExpandProperty Count',
                safe: 'Get-ChildItem -Recurse -Include "*.js" | Measure-Object',
                alternative: '(Get-ChildItem -Recurse -Include "*.js").Count'
            }
        }
    }
    
    // ğŸ”´ æ£€æŸ¥å‘½ä»¤å®‰å…¨æ€§
    checkCommandSafety(command) {
        const results = {
            isSafe: true,
            riskLevel: 'low',
            warnings: [],
            errors: [],
            alternatives: []
        }
        
        // æ£€æŸ¥å±é™©æ¨¡å¼
        for (const pattern of this.dangerousPatterns) {
            if (pattern.pattern.test(command)) {
                results.isSafe = false
                results.riskLevel = pattern.risk
                results.errors.push(pattern.message)
                
                // å¯»æ‰¾å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ
                const alternative = this.findSafeAlternative(command)
                if (alternative) {
                    results.alternatives.push(alternative)
                }
            }
        }
        
        return results
    }
    
    // ğŸ”´ ç”Ÿæˆå®‰å…¨å‘½ä»¤å»ºè®®
    generateSafeCommand(unsafeCommand) {
        const safetyCheck = this.checkCommandSafety(unsafeCommand)
        
        if (safetyCheck.isSafe) {
            return {
                command: unsafeCommand,
                isSafe: true,
                message: 'å‘½ä»¤å®‰å…¨æ€§æ£€æŸ¥é€šè¿‡'
            }
        }
        
        // ç”Ÿæˆç®€åŒ–å‘½ä»¤
        const simplifiedCommand = this.simplifyCommand(unsafeCommand)
        return {
            command: simplifiedCommand,
            isSafe: true,
            message: `ä½¿ç”¨ç®€åŒ–å‘½ä»¤ï¼š${simplifiedCommand}`,
            originalCommand: unsafeCommand,
            reason: 'åŸå‘½ä»¤å­˜åœ¨å®‰å…¨é£é™©'
        }
    }
    
    // ğŸ”´ ç®€åŒ–å‘½ä»¤
    simplifyCommand(command) {
        // ç§»é™¤å¤æ‚çš„ç®¡é“æ“ä½œ
        const baseCommand = command.split('|')[0].trim()
        
        // ç§»é™¤å±é™©çš„å‚æ•°ç»„åˆ
        const simplifiedCommand = baseCommand
            .replace(/\s+\|\s+Measure-Object.*/, '')
            .replace(/\s+\|\s+Select-Object.*/, '')
            .replace(/\s+\|\s+Where-Object.*/, '')
        
        return simplifiedCommand || 'ls'
    }
}

// ğŸ”´ å…¨å±€PowerShellå®‰å…¨æ£€æŸ¥å™¨
const powershellSafetyChecker = new PowerShellSafetyChecker()
```

---

**æ›´æ–°æ—¶é—´**: 2025å¹´7æœˆ4æ—¥  
**æ–°å¢åŠŸèƒ½**: å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ã€å¯åŠ¨æ–¹å¼çº æ­£ã€ä¸‰é˜¶æ®µä¿¡æ¯æ”¶é›†ã€ä»»åŠ¡éªŒè¯è‡ªåŠ¨åŒ–  
**é€‚ç”¨åœºæ™¯**: æ‰€æœ‰å¾®ä¿¡å°ç¨‹åºå¼€å‘é¡¹ç›®å’ŒWebé¡¹ç›®  
**æ•ˆç‡æå‡**: é¢„è®¡å‡å°‘50-80%çš„é‡å¤æ€§å·¥ä½œå’Œé”™è¯¯çº æ­£æ—¶é—´



