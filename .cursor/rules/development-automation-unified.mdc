---
description: 
globs: 
alwaysApply: true
---
# ğŸ”§ å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¯å¢ƒç»Ÿä¸€è§„èŒƒ - æ ¸å¿ƒè‡ªåŠ¨åŒ–è§„åˆ™é›†

## ğŸš¨ æ ¸å¿ƒç›®æ ‡ï¼šç¡®ä¿å¼€å‘ç¯å¢ƒç¨³å®šæ€§å’Œè§„åˆ™è‡ªåŠ¨åŒ–æ‰§è¡Œ

### ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€å‘ç¯å¢ƒä¸å·¥å…·è§„èŒƒ

#### 1. ğŸ›¡ï¸ PowerShellæ§åˆ¶å°ç¨³å®šæ€§ä¿éšœ

##### PSConsoleReadLineæ¨¡å—é¢„æ£€æœºåˆ¶
```powershell
# ğŸ”´ å¼ºåˆ¶è¦æ±‚ï¼šç”ŸæˆPowerShellå‘½ä»¤å‰è‡ªåŠ¨æ£€æŸ¥æ¨¡å—å®Œæ•´æ€§
Get-Module PSConsoleReadLine -ListAvailable

# ğŸ”´ æ¨¡å—æŸåæ—¶ä¼˜å…ˆä¿®å¤
if ($module.Version -ne $expectedVersion) {
    Update-Module PSConsoleReadLine -Force
}

# ğŸ”´ å¼ºåˆ¶é…ç½®ï¼šæ‰€æœ‰æ¶‰åŠä¸­æ–‡å­—ç¬¦çš„ç»ˆç«¯æ“ä½œ
[Console]::OutputEncoding = [Text.UTF8Encoding]::UTF8  
[Console]::InputEncoding = [Text.UTF8Encoding]::UTF8
```

##### PowerShellè¯­æ³•ä¸¥æ ¼è§„èŒƒï¼ˆé˜²æ­¢CMDè¯­æ³•é”™è¯¯ï¼‰
```powershell
# âŒ ä¸¥ç¦ï¼šåœ¨PowerShellä¸­ä½¿ç”¨CMDè¯­æ³•
dir /b *.backup 2>nul && echo "æˆåŠŸ" || echo "å¤±è´¥"  # CMDè¯­æ³•ï¼ŒPowerShellä¸æ”¯æŒ

# âœ… æ­£ç¡®ï¼šä½¿ç”¨PowerShellåŸç”Ÿè¯­æ³•
Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($?) { Write-Host "æˆåŠŸ" } else { Write-Host "å¤±è´¥" }

# âœ… ç®€åŒ–ç‰ˆæœ¬ï¼šç›´æ¥ä½¿ç”¨PowerShellæ¡ä»¶åˆ¤æ–­
$backupFiles = Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($backupFiles) { "å‘ç°å¤‡ä»½æ–‡ä»¶: $($backupFiles -join ', ')" } else { "æ— å¤‡ä»½æ–‡ä»¶" }
```

##### ğŸš¨ å¼ºåˆ¶æ‰§è¡Œï¼šPowerShellè¯­æ³•æ£€æŸ¥ï¼ˆè¯¦è§ä¸“ç”¨è§„åˆ™æ–‡ä»¶ï¼‰
```javascript
// ğŸ”´ å¼•ç”¨ï¼šPowerShellè¯­æ³•æ£€æŸ¥è¯¦ç»†è§„åˆ™
// è¯¦ç»†å®ç°è§ï¼špowershell-syntax-enforcer.mdc
console.log('ğŸ” PowerShellè¯­æ³•éªŒè¯è¯¦è§ï¼špowershell-syntax-enforcer.mdc')

// ğŸ”´ å¿«é€Ÿæ£€æŸ¥æ¥å£
function quickValidatePowerShellSyntax(command) {
    // æ ¸å¿ƒè¿è§„æ£€æŸ¥ï¼ˆè¯¦ç»†è§„åˆ™è§powershell-syntax-enforcer.mdcï¼‰
    if (command.includes('&&') || command.includes('||') || command.startsWith('echo ')) {
        console.error('ğŸš¨ PowerShellè¯­æ³•è¿è§„ï¼Œè¯¦ç»†æ£€æŸ¥è¯·å‚è€ƒï¼špowershell-syntax-enforcer.mdc')
        return false
    }
    return true
}
```

#### 2. ğŸ”§ Gitåˆ†é¡µå™¨å¡æ­»é¢„é˜²è§„åˆ™

##### ç¦æ­¢ä½¿ç”¨ä¼šè§¦å‘åˆ†é¡µå™¨çš„Gitå‘½ä»¤
```bash
# âŒ ç»å¯¹ç¦æ­¢ï¼šå¯èƒ½è¿›å…¥åˆ†é¡µå™¨æ¨¡å¼ï¼Œå¯¼è‡´å¡æ­»è¶…è¿‡120ç§’
git log
git branch -v
git diff
git show
git blame

# âœ… æ­£ç¡®ï¼šå¼ºåˆ¶ç¦ç”¨åˆ†é¡µå™¨
git --no-pager log --oneline -10
git --no-pager branch -v
git --no-pager diff
git --no-pager show

# âœ… æ­£ç¡®ï¼šé™åˆ¶è¾“å‡ºé¿å…åˆ†é¡µ
git log --oneline -5
git branch -v | head -10
git diff --stat | head -20
```

##### æŒ‡ä»¤è¶…æ—¶å¤„ç†è§„åˆ™
```
ğŸš¨ 120ç§’è¶…æ—¶è§„åˆ™ï¼š
- ä¸€æ—¦æŒ‡ä»¤è¿è¡Œè¶…è¿‡120ç§’æ²¡å‡ºä»»ä½•ç»“æœæˆ–æ²¡æœ‰æ­£ç¡®é€€å‡º
- è‡ªåŠ¨é‡æ–°è¿è¡Œè¿™ä¸ªæŒ‡ä»¤ï¼Œå†ä¸è¡Œå°±æ¢å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ
- ç¬¬ä¸€æ¬¡é‡è¯•ï¼šgit --no-pager [åŸå‘½ä»¤]
- ç¬¬äºŒæ¬¡é‡è¯•ï¼šåº”ç”¨å…¨å±€é…ç½®åé‡è¯•
- æœ€åæ–¹æ¡ˆï¼šä½¿ç”¨ç®€åŒ–çš„ç­‰æ•ˆå‘½ä»¤
```

#### 3. ğŸ” æ–‡ä»¶æœç´¢å‘½ä»¤è§„èŒƒ

##### å¼ºåˆ¶è¦æ±‚ï¼šé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡å‰å¿…é¡»å…ˆäº†è§£ç›®å½•ç»“æ„
```powershell
# ğŸ”´ ç¬¬ä¸€æ­¥ï¼šæ€»æ˜¯å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œæ·±åº¦æ€è€ƒç†è§£é¡¹ç›®æ–‡ä»¶ç»„ç»‡
list_dir pages  # æˆ–è€… Get-ChildItem pages -Directory

# ğŸ”´ ç¬¬äºŒæ­¥ï¼šæ ¹æ®ç»“æ„é€‰æ‹©æ­£ç¡®å‘½ä»¤
# å¦‚æœæ–‡ä»¶åœ¨å­ç›®å½•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ -Recurse
Get-ChildItem pages -Recurse -Include "*.js" | Measure-Object | Select-Object -ExpandProperty Count
```

##### å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ–‡ä»¶æ“ä½œè§„èŒƒ
```powershell
# âœ… æ­£ç¡®ï¼šå°ç¨‹åºé¡µé¢åœ¨å­ç›®å½•ä¸­ï¼Œæ³¨æ„ç¬¦åˆå¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†
Get-ChildItem pages -Recurse -Include "*.js"
Get-ChildItem pages -Recurse -Include "*.wxml"
Get-ChildItem components -Recurse -Include "*.js"
Get-ChildItem utils -Recurse -Include "*.js"
```

#### 4. ğŸ—ï¸ å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…·æ ‡å‡†

##### å¼ºåˆ¶ä½¿ç”¨è§„èŒƒ
- âœ… **åªä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œè¯­æ³•æ£€æŸ¥**
- âœ… **åªä½¿ç”¨PowerShellåŸç”Ÿå‘½ä»¤è¿›è¡Œæ–‡ä»¶æ“ä½œ**
- âŒ **ä¸¥ç¦ä½¿ç”¨nodeã€npmç­‰Webå·¥å…·**
- âŒ **ä¸¥ç¦ä½¿ç”¨webpack/babelç­‰æ„å»ºå·¥å…·**

### ç¬¬äºŒéƒ¨åˆ†ï¼šè§„åˆ™ç®¡ç†ä¸è‡ªåŠ¨åŒ–ç³»ç»Ÿ

#### ğŸ”§ è§„åˆ™æ–‡ä»¶ç»Ÿä¸€ç®¡ç†ç³»ç»Ÿ
```javascript
// ğŸ”´ è§„åˆ™æ–‡ä»¶ç®¡ç†å™¨ï¼ˆå¼•ç”¨ï¼šè¯¦è§powershell-syntax-enforcer.mdcï¼‰
class CursorRulesManager {
    constructor() {
        this.ruleFiles = {
            'development-automation-unified.mdc': 'core_automation',
            'tiangong-security-standards (2).mdc': 'security_standards', 
            '1.mdc': 'problem_analysis',
            'advanced-optimization.mdc': 'optimization_rules',
            'powershell-syntax-enforcer.mdc': 'syntax_validation'
        }
    }
    
    // ğŸ”´ å¼•ç”¨PowerShellè¯­æ³•æ£€æŸ¥å™¨ï¼ˆé¿å…é‡å¤ï¼‰
    async validateAllSyntax() {
        // è¯¦ç»†å®ç°è§ï¼špowershell-syntax-enforcer.mdc
        console.log('ğŸ” PowerShellè¯­æ³•éªŒè¯è¯¦è§ï¼špowershell-syntax-enforcer.mdc')
        return { validated: true, reference: 'powershell-syntax-enforcer.mdc' }
    }
}
```

#### ğŸ¯ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®è‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿ
```javascript
// ğŸ”´ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ£€æµ‹å™¨
class WechatMiniProgramDetector {
    constructor() {
        this.requiredFiles = [
            'app.js', 'app.json', 'app.wxss', 'project.config.json', 
            'pages/', 'components/', 'utils/'
        ]
        
        this.prohibitedCommands = [
            'npm start', 'npm run dev', 'node server.js', 
            'webpack-dev-server', 'vite', 'yarn start'
        ]
    }
    
    // ğŸ”´ é¡¹ç›®ç±»å‹æ£€æµ‹
    detectProjectType(projectPath) {
        const detectedFiles = this.requiredFiles.filter(file => 
            fs.existsSync(path.join(projectPath, file))
        )
        
        const confidence = detectedFiles.length / this.requiredFiles.length
        
        return {
            isMiniProgram: confidence >= 0.7,
            confidence: Math.round(confidence * 100),
            detectedFiles,
            missingFiles: this.requiredFiles.filter(file => 
                !detectedFiles.includes(file)
            )
        }
    }
    
    // ğŸ”´ ç¦ç”¨Webå¼€å‘å‘½ä»¤
    validateCommand(command) {
        const isProhibited = this.prohibitedCommands.some(prohibited => 
            command.includes(prohibited)
        )
        
        if (isProhibited) {
            throw new Error(`ğŸš¨ å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ç¦æ­¢ä½¿ç”¨: ${command}`)
        }
        
        return true
    }
}
```

### ç¬¬ä¸‰éƒ¨åˆ†ï¼šç¯å¢ƒé…ç½®ä¸è‡ªåŠ¨åŒ–è„šæœ¬

#### ğŸ”§ ç¯å¢ƒå˜é‡ç»Ÿä¸€ç®¡ç†
```javascript
// ğŸ”´ ç¯å¢ƒé…ç½®ç®¡ç†å™¨
class EnvironmentManager {
    constructor() {
        this.configFiles = [
            'config/env.js',
            'project.config.json',
            'project.private.config.json'
        ]
        
        this.requiredEnvVars = [
            'API_BASE_URL',
            'WS_BASE_URL',
            'APPID'
        ]
    }
    
    // ğŸ”´ é…ç½®æ–‡ä»¶åŒæ­¥æ£€æŸ¥
    async syncConfigFiles() {
        const configs = {}
        
        // å¹¶è¡Œè¯»å–æ‰€æœ‰é…ç½®æ–‡ä»¶
        const configPromises = this.configFiles.map(async file => {
            try {
                const content = await read_file(file, true, 1, -1)
                return { file, content: content.content, exists: true }
            } catch (error) {
                return { file, content: null, exists: false, error: error.message }
            }
        })
        
        const configResults = await Promise.all(configPromises)
        
        // æ£€æŸ¥é…ç½®ä¸€è‡´æ€§
        const inconsistencies = this.checkConfigConsistency(configResults)
        
        if (inconsistencies.length > 0) {
            return {
                hasIssues: true,
                inconsistencies,
                fixPlan: this.generateConfigFixPlan(inconsistencies)
            }
        }
        
        return { hasIssues: false, message: 'é…ç½®æ–‡ä»¶åŒæ­¥æ­£å¸¸' }
    }
    
    // ğŸ”´ ç¯å¢ƒå˜é‡éªŒè¯
    validateEnvironment() {
        const missingVars = this.requiredEnvVars.filter(varName => 
            !process.env[varName] && !this.getConfigValue(varName)
        )
        
        if (missingVars.length > 0) {
            throw new Error(`ğŸš¨ ç¼ºå°‘å¿…è¦ç¯å¢ƒå˜é‡: ${missingVars.join(', ')}`)
        }
        
        return true
    }
}
```

#### ğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
```javascript
// ğŸ”´ éƒ¨ç½²è‡ªåŠ¨åŒ–ç®¡ç†å™¨
class DeploymentAutomator {
    constructor() {
        this.deploymentSteps = [
            'validate_environment',
            'check_dependencies',
            'run_tests',
            'build_project',
            'deploy_to_staging',
            'run_smoke_tests',
            'deploy_to_production'
        ]
    }
    
    // ğŸ”´ è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹
    async autoDeployment() {
        console.log('ğŸš€ å¼€å§‹è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹...')
        
        const results = []
        
        for (const step of this.deploymentSteps) {
            try {
                const result = await this.executeStep(step)
                results.push({ step, success: true, result })
                
                console.log(`âœ… ${step} å®Œæˆ`)
                
            } catch (error) {
                results.push({ step, success: false, error: error.message })
                
                console.error(`âŒ ${step} å¤±è´¥: ${error.message}`)
                
                // å…³é”®æ­¥éª¤å¤±è´¥æ—¶åœæ­¢éƒ¨ç½²
                if (this.isCriticalStep(step)) {
                    throw new Error(`éƒ¨ç½²å¤±è´¥åœ¨å…³é”®æ­¥éª¤: ${step}`)
                }
            }
        }
        
        return {
            deploymentComplete: true,
            totalSteps: this.deploymentSteps.length,
            successfulSteps: results.filter(r => r.success).length,
            failedSteps: results.filter(r => !r.success).length,
            results
        }
    }
    
    // ğŸ”´ æ­¥éª¤æ‰§è¡Œå™¨
    async executeStep(stepName) {
        switch (stepName) {
            case 'validate_environment':
                return await this.validateEnvironment()
                
            case 'check_dependencies':
                return await this.checkDependencies()
                
            case 'run_tests':
                return await this.runTests()
                
            case 'build_project':
                return await this.buildProject()
                
            case 'deploy_to_staging':
                return await this.deployToStaging()
                
            case 'run_smoke_tests':
                return await this.runSmokeTests()
                
            case 'deploy_to_production':
                return await this.deployToProduction()
                
            default:
                throw new Error(`æœªçŸ¥éƒ¨ç½²æ­¥éª¤: ${stepName}`)
        }
    }
}
```

### ç¬¬å››éƒ¨åˆ†ï¼šè´¨é‡ä¿è¯ä¸ç›‘æ§

#### ğŸ” ä»£ç è´¨é‡æ£€æŸ¥è‡ªåŠ¨åŒ–
```javascript
// ğŸ”´ ä»£ç è´¨é‡æ£€æŸ¥å™¨
class CodeQualityChecker {
    constructor() {
        this.qualityRules = {
            'no_hardcoded_values': {
                pattern: /const\s+\w+\s*=\s*['"][^'"]*['"]/g,
                severity: 'warning',
                message: 'é¿å…ç¡¬ç¼–ç å€¼ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶'
            },
            'proper_error_handling': {
                pattern: /catch\s*\(\s*\w+\s*\)\s*\{\s*\}/g,
                severity: 'error',
                message: 'ç©ºçš„catchå—ï¼Œå¿…é¡»æ·»åŠ é”™è¯¯å¤„ç†'
            },
            'console_log_cleanup': {
                pattern: /console\.log\(/g,
                severity: 'warning',
                message: 'ç”Ÿäº§ç¯å¢ƒåº”ç§»é™¤console.log'
            }
        }
    }
    
    // ğŸ”´ æ‰¹é‡ä»£ç è´¨é‡æ£€æŸ¥
    async runQualityCheck() {
        const files = await this.getProjectFiles()
        const issues = []
        
        // å¹¶è¡Œæ£€æŸ¥æ‰€æœ‰æ–‡ä»¶
        const checkPromises = files.map(async file => {
            const content = await read_file(file, true, 1, -1)
            return this.checkFileQuality(file, content.content)
        })
        
        const fileResults = await Promise.all(checkPromises)
        
        return {
            totalFiles: files.length,
            totalIssues: fileResults.reduce((sum, result) => sum + result.issues.length, 0),
            results: fileResults,
            summary: this.generateQualitySummary(fileResults)
        }
    }
    
    // ğŸ”´ æ–‡ä»¶è´¨é‡æ£€æŸ¥
    checkFileQuality(fileName, content) {
        const issues = []
        
        Object.entries(this.qualityRules).forEach(([ruleName, rule]) => {
            const matches = content.match(rule.pattern)
            
            if (matches) {
                issues.push({
                    rule: ruleName,
                    severity: rule.severity,
                    message: rule.message,
                    occurrences: matches.length,
                    file: fileName
                })
            }
        })
        
        return { file: fileName, issues }
    }
}
```

#### ğŸ“Š æ€§èƒ½ç›‘æ§è‡ªåŠ¨åŒ–
```javascript
// ğŸ”´ æ€§èƒ½ç›‘æ§ç³»ç»Ÿ
class PerformanceMonitor {
    constructor() {
        this.metrics = {
            'page_load_time': { threshold: 3000, unit: 'ms' },
            'api_response_time': { threshold: 1000, unit: 'ms' },
            'memory_usage': { threshold: 50, unit: 'MB' },
            'cpu_usage': { threshold: 80, unit: '%' }
        }
    }
    
    // ğŸ”´ æ€§èƒ½æŒ‡æ ‡æ”¶é›†
    async collectMetrics() {
        const metrics = {}
        
        // å¹¶è¡Œæ”¶é›†æ‰€æœ‰æ€§èƒ½æŒ‡æ ‡
        const metricPromises = Object.keys(this.metrics).map(async metricName => {
            const value = await this.measureMetric(metricName)
            return { metricName, value }
        })
        
        const metricResults = await Promise.all(metricPromises)
        
        metricResults.forEach(({ metricName, value }) => {
            metrics[metricName] = {
                value,
                threshold: this.metrics[metricName].threshold,
                unit: this.metrics[metricName].unit,
                status: value <= this.metrics[metricName].threshold ? 'OK' : 'WARNING'
            }
        })
        
        return {
            timestamp: Date.now(),
            metrics,
            overallStatus: this.calculateOverallStatus(metrics)
        }
    }
    
    // ğŸ”´ æ€§èƒ½å‘Šè­¦
    checkPerformanceAlerts(metrics) {
        const alerts = []
        
        Object.entries(metrics).forEach(([metricName, data]) => {
            if (data.status === 'WARNING') {
                alerts.push({
                    metric: metricName,
                    value: data.value,
                    threshold: data.threshold,
                    unit: data.unit,
                    severity: 'HIGH',
                    message: `${metricName}è¶…è¿‡é˜ˆå€¼: ${data.value}${data.unit} > ${data.threshold}${data.unit}`
                })
            }
        })
        
        return alerts
    }
}
```

---

**è§„åˆ™åˆ›å»ºæ—¶é—´**: 2025å¹´01æœˆ08æ—¥  
**æœ€åæ›´æ–°æ—¶é—´**: 2025å¹´01æœˆ08æ—¥  
**æ›´æ–°å†…å®¹**: ç§»é™¤é‡å¤çš„PowerShellè¯­æ³•è§„åˆ™ï¼Œå¼•ç”¨powershell-syntax-enforcer.mdc  
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰éœ€è¦å¼€å‘ç¯å¢ƒè‡ªåŠ¨åŒ–çš„åœºæ™¯  
**ç»´æŠ¤çŠ¶æ€**: âœ… å·²ä¼˜åŒ– - é‡å¤å†…å®¹å·²æ¸…ç†ï¼Œè§„åˆ™å·²ç»Ÿä¸€å¼•ç”¨



