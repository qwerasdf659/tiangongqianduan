---
description: 
globs: 
alwaysApply: false
---
# ğŸ”§ å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¯å¢ƒç»Ÿä¸€è§„èŒƒ

## ğŸš¨ æ ¸å¿ƒç›®æ ‡ï¼šç¡®ä¿å¼€å‘ç¯å¢ƒç¨³å®šæ€§å’Œè§„åˆ™è‡ªåŠ¨åŒ–æ‰§è¡Œ

### ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€å‘ç¯å¢ƒä¸å·¥å…·è§„èŒƒ

#### 1. ğŸ›¡ï¸ PowerShellæ§åˆ¶å°ç¨³å®šæ€§ä¿éšœ

##### PSConsoleReadLineæ¨¡å—é¢„æ£€æœºåˆ¶
```powershell
# ğŸ”´ å¼ºåˆ¶è¦æ±‚ï¼šç”ŸæˆPowerShellå‘½ä»¤å‰è‡ªåŠ¨æ£€æŸ¥æ¨¡å—å®Œæ•´æ€§
Get-Module PSConsoleReadLine -ListAvailable

# ğŸ”´ æ¨¡å—æŸåæ—¶ä¼˜å…ˆä¿®å¤
if ($module.Version -ne $expectedVersion) {
    Update-Module PSConsoleReadLine -Force
}

# ğŸ”´ å¼ºåˆ¶é…ç½®ï¼šæ‰€æœ‰æ¶‰åŠä¸­æ–‡å­—ç¬¦çš„ç»ˆç«¯æ“ä½œ
[Console]::OutputEncoding = [Text.UTF8Encoding]::UTF8  
[Console]::InputEncoding = [Text.UTF8Encoding]::UTF8
```

##### PowerShellè¯­æ³•ä¸¥æ ¼è§„èŒƒï¼ˆé˜²æ­¢CMDè¯­æ³•é”™è¯¯ï¼‰
```powershell
# âŒ ä¸¥ç¦ï¼šåœ¨PowerShellä¸­ä½¿ç”¨CMDè¯­æ³•
dir /b *.backup 2>nul && echo "æˆåŠŸ" || echo "å¤±è´¥"  # CMDè¯­æ³•ï¼ŒPowerShellä¸æ”¯æŒ

# âœ… æ­£ç¡®ï¼šä½¿ç”¨PowerShellåŸç”Ÿè¯­æ³•
Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($?) { Write-Host "æˆåŠŸ" } else { Write-Host "å¤±è´¥" }

# âœ… ç®€åŒ–ç‰ˆæœ¬ï¼šç›´æ¥ä½¿ç”¨PowerShellæ¡ä»¶åˆ¤æ–­
$backupFiles = Get-ChildItem -Name "*.backup" -ErrorAction SilentlyContinue
if ($backupFiles) { "å‘ç°å¤‡ä»½æ–‡ä»¶: $($backupFiles -join ', ')" } else { "æ— å¤‡ä»½æ–‡ä»¶" }
```

##### PowerShellä¸CMDè¯­æ³•å¯¹ç…§è¡¨
| CMDè¯­æ³• | PowerShellè¯­æ³• | è¯´æ˜ |
|---------|----------------|------|
| `command1 && command2` | `if ($?) { command2 }` | æˆåŠŸæ—¶æ‰§è¡Œ |
| `command1 \|\| command2` | `if (!$?) { command2 }` | å¤±è´¥æ—¶æ‰§è¡Œ |
| `dir /b` | `Get-ChildItem -Name` | åˆ—å‡ºæ–‡ä»¶å |
| `2>nul` | `-ErrorAction SilentlyContinue` | å¿½ç•¥é”™è¯¯ |
| `echo "text"` | `Write-Host "text"` | è¾“å‡ºæ–‡æœ¬ |

#### 2. ğŸ”§ Gitåˆ†é¡µå™¨å¡æ­»é¢„é˜²è§„åˆ™

##### ç¦æ­¢ä½¿ç”¨ä¼šè§¦å‘åˆ†é¡µå™¨çš„Gitå‘½ä»¤
```bash
# âŒ ç»å¯¹ç¦æ­¢ï¼šå¯èƒ½è¿›å…¥åˆ†é¡µå™¨æ¨¡å¼ï¼Œå¯¼è‡´å¡æ­»è¶…è¿‡120ç§’
git log
git branch -v
git diff
git show
git blame

# âŒ å±é™©ï¼šè‡ªåŠ¨åŒ–ç¯å¢ƒæ— æ³•å¤„ç†äº¤äº’
git log --graph
git diff --stat
git show --name-only
```

##### å®‰å…¨çš„Gitå‘½ä»¤æ›¿ä»£æ–¹æ¡ˆ
```bash
# âœ… æ­£ç¡®ï¼šå¼ºåˆ¶ç¦ç”¨åˆ†é¡µå™¨
git --no-pager log --oneline -10
git --no-pager branch -v
git --no-pager diff
git --no-pager show

# âœ… æ­£ç¡®ï¼šé™åˆ¶è¾“å‡ºé¿å…åˆ†é¡µ
git log --oneline -5
git branch -v | head -10
git diff --stat | head -20

# âœ… æ­£ç¡®ï¼šPowerShellç®¡é“å¤„ç†
git log --oneline | Select-Object -First 10
git branch -v | Where-Object { $_ -match "main" }
```

##### æŒ‡ä»¤è¶…æ—¶å¤„ç†è§„åˆ™
```
ğŸš¨ 120ç§’è¶…æ—¶è§„åˆ™ï¼š
- ä¸€æ—¦æŒ‡ä»¤è¿è¡Œè¶…è¿‡120ç§’æ²¡å‡ºä»»ä½•ç»“æœæˆ–æ²¡æœ‰æ­£ç¡®é€€å‡º
- è‡ªåŠ¨é‡æ–°è¿è¡Œè¿™ä¸ªæŒ‡ä»¤ï¼Œå†ä¸è¡Œå°±æ¢å¦ä¸€ç§è§£å†³æ–¹æ¡ˆ
- ç¬¬ä¸€æ¬¡é‡è¯•ï¼šgit --no-pager [åŸå‘½ä»¤]
- ç¬¬äºŒæ¬¡é‡è¯•ï¼šåº”ç”¨å…¨å±€é…ç½®åé‡è¯•
- æœ€åæ–¹æ¡ˆï¼šä½¿ç”¨ç®€åŒ–çš„ç­‰æ•ˆå‘½ä»¤
```

#### 3. ğŸ” æ–‡ä»¶æœç´¢å‘½ä»¤è§„èŒƒ

##### å¼ºåˆ¶è¦æ±‚ï¼šé¡¹ç›®æ–‡ä»¶ç»Ÿè®¡å‰å¿…é¡»å…ˆäº†è§£ç›®å½•ç»“æ„
```powershell
# ğŸ”´ ç¬¬ä¸€æ­¥ï¼šæ€»æ˜¯å…ˆæŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œæ·±åº¦æ€è€ƒç†è§£é¡¹ç›®æ–‡ä»¶ç»„ç»‡
list_dir pages  # æˆ–è€… Get-ChildItem pages -Directory

# ğŸ”´ ç¬¬äºŒæ­¥ï¼šæ ¹æ®ç»“æ„é€‰æ‹©æ­£ç¡®å‘½ä»¤
# å¦‚æœæ–‡ä»¶åœ¨å­ç›®å½•ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ -Recurse
Get-ChildItem pages -Recurse -Include "*.js" | Measure-Object | Select-Object -ExpandProperty Count
```

##### å¾®ä¿¡å°ç¨‹åºé¡¹ç›®æ–‡ä»¶æ“ä½œè§„èŒƒ
```powershell
# âœ… æ­£ç¡®ï¼šå°ç¨‹åºé¡µé¢åœ¨å­ç›®å½•ä¸­ï¼Œæ³¨æ„ç¬¦åˆå¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†
Get-ChildItem pages -Recurse -Include "*.js"
Get-ChildItem pages -Recurse -Include "*.wxml"
Get-ChildItem components -Recurse -Include "*.js"
Get-ChildItem utils -Recurse -Include "*.js"
```

##### å‘½ä»¤å¤æ‚åº¦æ§åˆ¶ä¸ä¸­æ–‡å­—ç¬¦å¤„ç†
```powershell
# âŒ å·²ç¡®è®¤è§¦å‘å¼‚å¸¸çš„å±é™©å‘½ä»¤ï¼ˆ2025å¹´07æœˆ02æ—¥éªŒè¯ï¼‰
Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count
# é”™è¯¯ï¼šSystem.ArgumentOutOfRangeException: å‚æ•°å: top å®é™…å€¼æ˜¯ -1

# âœ… å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ
ls pages  # ç®€å•ç›´æ¥ï¼Œ100%å¯é 
Get-ChildItem pages -Directory  # åŸºç¡€å‘½ä»¤ï¼Œæ— ç®¡é“é£é™©

# âœ… åˆ†è§£å¤æ‚æ“ä½œ
$dirs = Get-ChildItem pages -Directory
$count = ($dirs | Measure-Object).Count
Write-Host "æ‰¾åˆ° $count ä¸ªç›®å½•"

# âœ… ç®€åŒ–å‘½ä»¤ï¼Œé¿å…ç¼“å†²åŒºé—®é¢˜
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | Measure-Object

# âŒ é¿å…è¿‡é•¿çš„ç®¡é“å‘½ä»¤
Get-ChildItem ç›®å½• -Recurse -Include "*.æ‰©å±•å" | ForEach-Object {...å¾ˆé•¿çš„å¤„ç†é€»è¾‘...}
```

##### PowerShellå¼‚å¸¸å¿«é€Ÿæ¢å¤ç­–ç•¥ï¼ˆ2025å¹´07æœˆ02æ—¥æ›´æ–°ï¼‰
```powershell
# ğŸ”´ å¼‚å¸¸å‘ç”Ÿæ—¶çš„æ ‡å‡†æ¢å¤æµç¨‹
if (PSConsoleReadLineå¼‚å¸¸) {
    # ç¬¬ä¸€é€‰æ‹©ï¼šä½¿ç”¨ç®€åŒ–çš„ç­‰æ•ˆå‘½ä»¤
    ls pages                    # ä»£æ›¿å¤æ‚çš„Get-ChildItemç®¡é“
    
    # ç¬¬äºŒé€‰æ‹©ï¼šåˆ†è§£å¤æ‚æ“ä½œ
    $items = Get-ChildItem pages
    $count = $items.Count
    
    # ç¬¬ä¸‰é€‰æ‹©ï¼šä½¿ç”¨cmdå…¼å®¹å‘½ä»¤
    dir pages /b
}

# ğŸ”´ é¢„é˜²æ€§æ£€æŸ¥æ¸…å•
function Test-PowerShellCommandSafety($command) {
    $riskFactors = @(
        ($command.Length -gt 80),                    # å‘½ä»¤è¿‡é•¿
        ($command -match '[\u4e00-\u9fa5]'),        # åŒ…å«ä¸­æ–‡
        ($command.Split('|').Count -gt 3),          # ç®¡é“è¿‡å¤š
        ($command -match 'Select-Object.*Expand')    # ç‰¹å®šå±é™©ç»„åˆ
    )
    
    return ($riskFactors | Where-Object { $_ }).Count -eq 0
}
```

#### 4. ğŸ—ï¸ å¾®ä¿¡å°ç¨‹åºå¼€å‘å·¥å…·æ ‡å‡†

##### å¼ºåˆ¶ä½¿ç”¨è§„èŒƒ
- âœ… **åªä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·è¿›è¡Œè¯­æ³•æ£€æŸ¥**
- âœ… **åªä½¿ç”¨PowerShellåŸç”Ÿå‘½ä»¤è¿›è¡Œæ–‡ä»¶æ“ä½œ**
- âŒ **ä¸¥ç¦ä½¿ç”¨nodeã€npmç­‰Webå·¥å…·**
- âŒ **ä¸¥ç¦ä½¿ç”¨webpack/babelç­‰æ„å»ºå·¥å…·**

##### ç¦æ­¢ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨
- `npm --version` 
- `node -c` è¯­æ³•æ£€æŸ¥
- `webpack/babel` ç­‰Webæ„å»ºå·¥å…·
- Linux/Bashå‘½ä»¤è¯­æ³•

### ç¬¬äºŒéƒ¨åˆ†ï¼šè§„åˆ™é¢„é˜²ä¸è‡ªåŠ¨åŒ–ç³»ç»Ÿ

#### ğŸ›¡ï¸ Claude 4 Sonnet ç»¼åˆè§„åˆ™é¢„é˜²æ£€æŸ¥ç³»ç»Ÿ

##### è§„åˆ™ç†è§£ç¡®è®¤æ¸…å• - 2025å¹´01æœˆ03æ—¥æœ€æ–°æ›´æ–°

###### ğŸš¨ å…¨å±€è§„åˆ™ç†è§£ç¡®è®¤

**1. ä¼šè¯é—®é¢˜åˆ†æä¸è§£å†³æ–¹æ¡ˆè§„åˆ™**
- âœ… **Açº§é—®é¢˜ï¼ˆä¸¥é‡ï¼‰**: é‡å¤æ–‡ä»¶åˆ›å»ºã€æ—¥æœŸé”™è¯¯ã€PowerShellæ§åˆ¶å°å¼‚å¸¸
- âœ… **Bçº§é—®é¢˜ï¼ˆä¸­ç­‰ï¼‰**: å·¥å…·è°ƒç”¨ä¸²è¡ŒåŒ–ã€search_replaceåŒ¹é…å¤±è´¥ã€æ­£åˆ™è¡¨è¾¾å¼å¤„ç†ã€é•¿æ–‡æ¡£ç¼–è¾‘ç­–ç•¥
- âœ… **Cçº§é—®é¢˜ï¼ˆè½»å¾®ï¼‰**: å¾®ä¿¡å°ç¨‹åºå¯åŠ¨é”™è¯¯ã€Mockæ•°æ®æ£€æµ‹ã€ä»»åŠ¡éªŒè¯ä¸å®Œæ•´ã€ä¿¡æ¯æ”¶é›†ä¸å®Œæ•´
- âœ… **é¢„é˜²æœºåˆ¶**: å¼ºåˆ¶æ—¥æœŸè‡ªåŠ¨è·å–ã€PowerShellå‘½ä»¤å®‰å…¨ã€å¹¶è¡Œå·¥å…·è°ƒç”¨ã€æ­£åˆ™è½¬ä¹‰ã€120ç§’è¶…æ—¶åˆ‡æ¢
- ğŸ†• **2025å¹´01æœˆ03æ—¥éªŒè¯**: å¹¶è¡Œå·¥å…·è°ƒç”¨ä¼˜åŒ–ç­–ç•¥åˆ¶å®šï¼Œé•¿æ–‡æ¡£ç¼–è¾‘ç­–ç•¥å®Œå–„

**2. æ•°æ®å®‰å…¨æ ¸å¿ƒè§„åˆ™**
- âœ… **æ•°æ®å®‰å…¨æ ¸å¿ƒ**: ç»å¯¹ç¦æ­¢å‰ç«¯ç¡¬ç¼–ç æ•æ„Ÿæ•°æ®ã€ç¦æ­¢Mockæ•°æ®ã€å¼ºåˆ¶åç«¯APIä¾èµ–
- âœ… **æ–¹æ³•è°ƒç”¨å®‰å…¨**: å¯¼å…¥å‡½æ•°ç›´æ¥è°ƒç”¨ã€æ¨¡å—å¯¼å…¥ä¸€è‡´æ€§ã€æ•°æ®å­˜åœ¨æ€§æ£€æŸ¥
- âœ… **å±æ€§è®¿é—®å®‰å…¨**: æ·±å±‚å±æ€§é˜²æŠ¤ã€åå¤‡å€¼æä¾›ã€å®‰å…¨æ£€æŸ¥æœºåˆ¶
- âœ… **å¾®ä¿¡å°ç¨‹åºå…¼å®¹**: Canvas APIå…¼å®¹æ€§ã€æ™ºèƒ½é™çº§ç­–ç•¥ã€ä¸‰å±‚é”™è¯¯å¤„ç†

##### ğŸ”§ è§„åˆ™é¢„é˜²æ£€æŸ¥æœºåˆ¶

###### ğŸš€ æ–°å¢ï¼šå¹¶è¡Œå·¥å…·è°ƒç”¨å¼ºåˆ¶ä¼˜åŒ–ç­–ç•¥ï¼ˆ2025å¹´01æœˆ03æ—¥ï¼‰

**å¹¶è¡Œå·¥å…·è°ƒç”¨å¼ºåˆ¶æ‰§è¡Œè§„åˆ™**
```javascript
// ğŸ”´ å¼ºåˆ¶è¦æ±‚ï¼šä»»åŠ¡å¼€å§‹å‰åˆ¶å®šå®Œæ•´ä¿¡æ¯æ”¶é›†è®¡åˆ’
const INFORMATION_COLLECTION_PLAN = {
  // ç¬¬ä¸€é˜¶æ®µï¼šå¹¶è¡Œæ”¶é›†æ ¸å¿ƒæ–‡æ¡£
  phase1_documents: [
    'read_file: å‰ç«¯æŠ€æœ¯è§„èŒƒæ–‡æ¡£æ ‡å‡†.md',
    'read_file: æ¥å£å¯¹æ¥è§„èŒƒæ–‡æ¡£æ ‡å‡†.md', 
    'read_file: app.js',
    'read_file: config/env.js'
  ],
  
  // ç¬¬äºŒé˜¶æ®µï¼šå¹¶è¡Œæ”¶é›†é¡µé¢å®ç°
  phase2_pages: [
    'read_file: pages/lottery/lottery.js',
    'read_file: pages/user/user.js',
    'read_file: pages/camera/camera.js',
    'read_file: pages/merchant/merchant.js'
  ],
  
  // ç¬¬ä¸‰é˜¶æ®µï¼šå¹¶è¡Œæ”¶é›†å·¥å…·ç±»
  phase3_utils: [
    'read_file: utils/api.js',
    'read_file: utils/loading-manager.js',
    'read_file: utils/validate.js',
    'read_file: utils/ws.js'
  ]
}

// ğŸ”´ å¼ºåˆ¶å¹¶è¡Œæ‰§è¡Œç¤ºä¾‹
// âŒ ç¦æ­¢ï¼šä¸²è¡Œæ–‡ä»¶è¯»å–
await read_file('file1.js')
await read_file('file2.js') 
await read_file('file3.js')

// âœ… å¿…é¡»ï¼šå¹¶è¡Œæ–‡ä»¶è¯»å–
const [file1, file2, file3] = await Promise.all([
  read_file('file1.js'),
  read_file('file2.js'),
  read_file('file3.js')
])
```

**å·¥å…·è°ƒç”¨æ•ˆç‡ç›‘æ§æœºåˆ¶**
```javascript
// ğŸ”´ å·¥å…·è°ƒç”¨æ•ˆç‡è®¡åˆ†ç³»ç»Ÿ
const EFFICIENCY_SCORING = {
  parallel_calls: +10,      // å¹¶è¡Œè°ƒç”¨åŠ åˆ†
  serial_calls: -5,         // ä¸²è¡Œè°ƒç”¨æ‰£åˆ†
  redundant_calls: -10,     // é‡å¤è°ƒç”¨æ‰£åˆ†
  optimal_strategy: +20     // æœ€ä¼˜ç­–ç•¥é¢å¤–åŠ åˆ†
}

// ä¼šè¯æ•ˆç‡ç›®æ ‡ï¼šæ€»åˆ† >= 80åˆ†ä¸ºä¼˜ç§€
```

###### ğŸ“ æ–°å¢ï¼šé•¿æ–‡æ¡£ç¼–è¾‘ç­–ç•¥è§„èŒƒï¼ˆ2025å¹´01æœˆ03æ—¥ï¼‰

**é•¿æ–‡æ¡£ç¼–è¾‘å·¥å…·é€‰æ‹©ç­–ç•¥**
```javascript
// ğŸ”´ æ–‡æ¡£é•¿åº¦åˆ¤æ–­è§„åˆ™
const DOCUMENT_EDIT_STRATEGY = {
  // çŸ­æ–‡æ¡£ï¼ˆ< 1000è¡Œï¼‰ï¼šä¼˜å…ˆsearch_replace
  short_document: {
    lines: '< 1000',
    preferred_tool: 'search_replace',
    fallback_tool: 'edit_file'
  },
  
  // ä¸­ç­‰æ–‡æ¡£ï¼ˆ1000-2500è¡Œï¼‰ï¼šè°¨æ…ä½¿ç”¨search_replace
  medium_document: {
    lines: '1000-2500',
    preferred_tool: 'search_replaceï¼ˆéœ€è¦å……è¶³ä¸Šä¸‹æ–‡ï¼‰',
    fallback_tool: 'edit_file',
    context_lines: 'è‡³å°‘å‰åå„5è¡Œ'
  },
  
  // é•¿æ–‡æ¡£ï¼ˆ> 2500è¡Œï¼‰ï¼šå¼ºåˆ¶ä½¿ç”¨edit_file
  long_document: {
    lines: '> 2500',
    preferred_tool: 'edit_file',
    reason: 'é¿å…å­—ç¬¦ä¸²åŒ¹é…å¤±è´¥',
    strategy: 'åœ¨æ–‡æ¡£æœ«å°¾è¿½åŠ æ–°å†…å®¹'
  }
}

// ğŸ”´ é•¿æ–‡æ¡£ç¼–è¾‘å¤±è´¥æ—¶çš„å¤„ç†æµç¨‹
if (search_replace_failed && document_lines > 2500) {
  console.log('ğŸ”„ é•¿æ–‡æ¡£ç¼–è¾‘ï¼šåˆ‡æ¢åˆ°edit_fileå·¥å…·')
  // ç«‹å³ä½¿ç”¨edit_fileå·¥å…·ï¼Œä¸å†é‡è¯•search_replace
  use_edit_file_tool()
}
```

**æ–‡æ¡£æ›´æ–°ç­–ç•¥ä¼˜åŒ–**
```javascript
// âœ… é•¿æ–‡æ¡£æ›´æ–°æœ€ä½³å®è·µ
const LONG_DOCUMENT_BEST_PRACTICES = {
  // ç­–ç•¥1ï¼šè¿½åŠ æ–°ç« èŠ‚è€Œä¸æ˜¯ä¿®æ”¹ç°æœ‰å†…å®¹
  append_new_sections: {
    method: 'edit_file',
    location: 'æ–‡æ¡£æœ«å°¾',
    format: '// ... existing code ...\n\næ–°å¢å†…å®¹'
  },
  
  // ç­–ç•¥2ï¼šåˆ†æ®µæ›´æ–°ï¼Œæ¯æ¬¡æ›´æ–°ä¸€ä¸ªå®Œæ•´ç« èŠ‚
  section_based_updates: {
    method: 'æŒ‰ç« èŠ‚åˆ†åˆ«æ›´æ–°',
    validation: 'æ¯æ¬¡æ›´æ–°åéªŒè¯è¯­æ³•æ­£ç¡®æ€§'
  },
  
  // ç­–ç•¥3ï¼šé¿å…å¤æ‚çš„search_replaceæ“ä½œ
  avoid_complex_replacements: {
    rule: 'è¶…è¿‡10è¡Œçš„æ›¿æ¢æ“ä½œä½¿ç”¨edit_file',
    reason: 'å‡å°‘åŒ¹é…å¤±è´¥é£é™©'
  }
}
```

###### ä»»åŠ¡å¼€å§‹å‰å¼ºåˆ¶æ£€æŸ¥æ¸…å•
```javascript
// ğŸ”´ å¼ºåˆ¶æ‰§è¡Œï¼šä»»åŠ¡å¼€å§‹å‰çš„è§„åˆ™é¢„æ£€æŸ¥
class RulePreventionSystem {
    constructor() {
        this.modelName = 'Claude 4 Sonnet'  // ç”¨æˆ·è§„åˆ™ç¬¬10æ¡
        this.currentDate = this.getCurrentDate()  // å¼ºåˆ¶æ—¥æœŸè·å–
        this.violations = []
        this.efficiencyMetrics = {
            parallelCallsUsed: 0,
            serialCallsDetected: 0,
            timeoutViolations: 0,
            mockDataDetected: 0
        }
    }
    
    // ğŸ”´ å¿…é¡»å£°æ˜ä½¿ç”¨çš„æ¨¡å‹
    announceModel() {
        console.log(`ğŸ¤– å½“å‰ä½¿ç”¨æ¨¡å‹: ${this.modelName}`)
        return this.modelName
    }
    
    // ğŸ”´ å¼ºåˆ¶æ—¥æœŸå‡†ç¡®æ€§æ£€æŸ¥
    getCurrentDate() {
        const now = new Date()
        const year = now.getFullYear()
        const month = String(now.getMonth() + 1).padStart(2, '0') 
        const day = String(now.getDate()).padStart(2, '0')
        return `${year}å¹´${month}æœˆ${day}æ—¥`
    }
    
    // ğŸ”´ æ•°æ®å®‰å…¨è§„åˆ™é¢„æ£€æŸ¥
    async checkDataSecurityRules(taskDescription) {
        const violations = []
        
        // æ£€æŸ¥æ˜¯å¦æ¶‰åŠæ•æ„Ÿæ•°æ®ç¡¬ç¼–ç 
        const sensitivePatterns = [
            'const.*PRIZES.*=.*\\[',
            'const.*PRODUCTS.*=.*\\[', 
            'Math\\.random\\(\\).*\\*',
            'user\\.role.*===.*["\']admin["\']',
            'mock.*Data|Mock.*Data|MOCK.*DATA'
        ]
        
        for (const pattern of sensitivePatterns) {
            if (new RegExp(pattern, 'i').test(taskDescription)) {
                violations.push(`âš ï¸ ä»»åŠ¡æè¿°å¯èƒ½æ¶‰åŠè¿ç¦æ¨¡å¼: ${pattern}`)
            }
        }
        
        return violations
    }
    
    // ğŸ”´ å·¥å…·è°ƒç”¨æ•ˆç‡é¢„æ£€æŸ¥
    async checkToolCallEfficiency(plannedTools) {
        const warnings = []
        
        if (plannedTools.length < 2) {
            warnings.push('âš ï¸ å»ºè®®ä½¿ç”¨å¹¶è¡Œå·¥å…·è°ƒç”¨æå‡æ•ˆç‡')
        }
        
        const parallelizableTools = ['read_file', 'grep_search', 'run_terminal_cmd', 'codebase_search']
        const canParallelize = plannedTools.filter(tool => parallelizableTools.includes(tool.name))
        
        if (canParallelize.length >= 2) {
            console.log(`âœ… æ£€æµ‹åˆ°${canParallelize.length}ä¸ªå¯å¹¶è¡Œå·¥å…·ï¼Œå»ºè®®å¹¶è¡Œæ‰§è¡Œ`)
        }
        
        return warnings
    }
    
    // ğŸ”´ 120ç§’è¶…æ—¶é¢„é˜²æ£€æŸ¥
    setupTimeoutPrevention(operation) {
        const timeoutDuration = 120000 // 120ç§’
        
        return new Promise((resolve, reject) => {
            const timeout = setTimeout(() => {
                this.efficiencyMetrics.timeoutViolations++
                reject(new Error('âš ï¸ æ“ä½œè¶…æ—¶120ç§’ï¼Œè¿åç”¨æˆ·è§„åˆ™ç¬¬12æ¡'))
            }, timeoutDuration)
            
            operation.then(result => {
                clearTimeout(timeout)
                resolve(result)
            }).catch(error => {
                clearTimeout(timeout)
                reject(error)
            })
        })
    }
    
    // ğŸ”´ å¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†æ£€æŸ¥
    async checkWechatStandards(codeContent) {
        const violations = []
        
        // æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†ç¦ç”¨çš„Webå·¥å…·
        const forbiddenTools = ['npm start', 'webpack', 'babel', 'node -c']
        for (const tool of forbiddenTools) {
            if (codeContent.includes(tool)) {
                violations.push(`âŒ æ£€æµ‹åˆ°ç¦ç”¨çš„Webå·¥å…·: ${tool}`)
            }
        }
        
        // æ£€æŸ¥å¾®ä¿¡å°ç¨‹åºAPIå…¼å®¹æ€§
        const unsafeAPIs = ['document.', 'window.', 'localStorage.']
        for (const api of unsafeAPIs) {
            if (codeContent.includes(api)) {
                violations.push(`âŒ æ£€æµ‹åˆ°ä¸å…¼å®¹çš„Web API: ${api}`)
            }
        }
        
        return violations
    }
}

// ğŸ”´ å…¨å±€è§„åˆ™é¢„é˜²ç³»ç»Ÿå®ä¾‹
const rulePreventionSystem = new RulePreventionSystem()
```

###### ä»»åŠ¡æ‰§è¡Œä¸­å®æ—¶ç›‘æ§
```javascript
// ğŸ”´ å®æ—¶è§„åˆ™ç›‘æ§æœºåˆ¶
class RealTimeRuleMonitor {
    constructor() {
        this.startTime = Date.now()
        this.operationTimeout = 120000 // 120ç§’
        this.parallelCallTracker = []
        this.mockDataAlerts = []
    }
    
    // ğŸ”´ å·¥å…·è°ƒç”¨ç›‘æ§
    monitorToolCall(toolName, isParallel = false) {
        this.parallelCallTracker.push({
            tool: toolName,
            timestamp: Date.now(),
            isParallel: isParallel
        })
        
        if (!isParallel && this.parallelCallTracker.length > 1) {
            const recentCalls = this.parallelCallTracker.slice(-3)
            const allSerial = recentCalls.every(call => !call.isParallel)
            
            if (allSerial) {
                console.warn('âš ï¸ æ£€æµ‹åˆ°è¿ç»­ä¸²è¡Œå·¥å…·è°ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨å¹¶è¡Œæ–¹å¼')
            }
        }
    }
    
    // ğŸ”´ Mockæ•°æ®å®æ—¶æ£€æµ‹
    detectMockData(content) {
        const mockPatterns = [
            'mock', 'Mock', 'MOCK', 'fake', 'Fake', 'FAKE',
            'test', 'Test', 'TEST', 'demo', 'Demo', 'DEMO',
            'shouldUseMock', 'smartApiCall', 'mockRequest',
            'generateMock', 'createMock', 'mockResponse'
        ]
        
        for (const pattern of mockPatterns) {
            if (content.includes(pattern)) {
                this.mockDataAlerts.push(`ğŸš¨ æ£€æµ‹åˆ°Mockæ•°æ®å…³é”®å­—: ${pattern}`)
                return true
            }
        }
        return false
    }
    
    // ğŸ”´ è¶…æ—¶ç›‘æ§
    checkTimeout() {
        const elapsed = Date.now() - this.startTime
        if (elapsed > this.operationTimeout) {
            throw new Error(`âš ï¸ æ“ä½œè¶…æ—¶ ${elapsed/1000}ç§’ï¼Œè¿å120ç§’è§„åˆ™`)
        }
        return elapsed
    }
}

// ğŸ”´ å…¨å±€å®æ—¶ç›‘æ§å™¨
const realTimeMonitor = new RealTimeRuleMonitor()
```

###### ä»»åŠ¡å®ŒæˆåéªŒè¯æ£€æŸ¥
```javascript
// ğŸ”´ ä»»åŠ¡å®Œæˆåçš„å®Œæ•´éªŒè¯
class TaskCompletionValidator {
    constructor() {
        this.validationChecks = []
        this.tempFilesCreated = []
        this.projectHealthStatus = null
    }
    
    // ğŸ”´ ç”¨æˆ·è§„åˆ™ç¬¬4æ¡ï¼šé¡¹ç›®è¿è¡Œæ£€æŸ¥
    async validateProjectHealth() {
        console.log('ğŸ” æ‰§è¡Œé¡¹ç›®è¿è¡ŒçŠ¶æ€æ£€æŸ¥...')
        
        const healthChecks = {
            fileStructure: await this.checkFileStructure(),
            syntaxValid: await this.checkSyntaxValidity(),
            functionalIntegrity: await this.checkFunctionalIntegrity(),
            compatibilityIssues: await this.checkCompatibilityIssues()
        }
        
        const issues = Object.entries(healthChecks)
            .filter(([key, status]) => !status.success)
            .map(([key, status]) => ({ type: key, error: status.error }))
        
        if (issues.length > 0) {
            console.error('ğŸš¨ é¡¹ç›®å¥åº·æ£€æŸ¥å‘ç°é—®é¢˜:', issues)
            // ç”¨æˆ·è§„åˆ™ç¬¬11æ¡ï¼šåˆ†æç»„ä»¶ç¼ºå¤±ã€é”™è¯¯ã€é€»è¾‘ã€ç¯å¢ƒé—®é¢˜
            await this.analyzeProjectIssues(issues)
            return false
        }
        
        console.log('âœ… é¡¹ç›®è¿è¡ŒçŠ¶æ€è‰¯å¥½')
        return true
    }
    
    // ğŸ”´ ç”¨æˆ·è§„åˆ™ç¬¬8æ¡ï¼šä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
    async cleanupTempFiles() {
        console.log('ğŸ§¹ æ‰§è¡Œä¸´æ—¶æ–‡ä»¶æ¸…ç†...')
        
        const tempPatterns = [
            '**/*.temp.*',
            '**/*.test.tmp',
            '**/temp_*',
            '**/*.backup',
            '**/*unused*.md',
            '**/*.log'
        ]
        
        let cleanedCount = 0
        for (const pattern of tempPatterns) {
            try {
                // æ¸…ç†åŒ¹é…çš„ä¸´æ—¶æ–‡ä»¶
                console.log(`æ¸…ç†æ¨¡å¼: ${pattern}`)
                cleanedCount++
            } catch (error) {
                console.warn(`æ¸…ç†å¤±è´¥: ${pattern} - ${error.message}`)
            }
        }
        
        console.log(`âœ… æ¸…ç†å®Œæˆï¼Œåˆ é™¤${cleanedCount}ä¸ªä¸´æ—¶æ–‡ä»¶`)
        return cleanedCount
    }
    
    // ğŸ”´ ç»¼åˆè§„åˆ™éµå¾ªéªŒè¯
    async runFinalValidation() {
        const results = {
            dataSecurityCompliance: await this.checkDataSecurityCompliance(),
            codeQualityStandards: await this.checkCodeQualityStandards(), 
            wechatCompatibility: await this.checkWechatCompatibility(),
            userRulesCompliance: await this.checkUserRulesCompliance(),
            projectHealth: await this.validateProjectHealth(),
            tempFilesCleanup: await this.cleanupTempFiles()
        }
        
        const violations = Object.entries(results)
            .filter(([key, result]) => result === false || (result.success === false))
        
        if (violations.length > 0) {
            console.error('âŒ æœ€ç»ˆéªŒè¯å‘ç°è¿è§„:', violations)
            return false
        }
        
        console.log('âœ… æ‰€æœ‰è§„åˆ™éªŒè¯é€šè¿‡')
        return true
    }
}

// ğŸ”´ å…¨å±€ä»»åŠ¡å®ŒæˆéªŒè¯å™¨
const taskValidator = new TaskCompletionValidator()
```

#### ğŸ¯ è‡ªåŠ¨åŒ–è§„åˆ™æ‰§è¡Œæµç¨‹

##### æ ‡å‡†ä»»åŠ¡æ‰§è¡Œæ¨¡æ¿
```javascript
// ğŸ”´ å¼ºåˆ¶ä½¿ç”¨çš„ä»»åŠ¡æ‰§è¡Œæ¨¡æ¿
async function executeTaskWithRuleCompliance(taskDescription, taskFunction) {
    // Phase 1: ä»»åŠ¡å¼€å§‹å‰æ£€æŸ¥
    console.log('ğŸ¤– ä½¿ç”¨æ¨¡å‹: Claude 4 Sonnet') // ç”¨æˆ·è§„åˆ™ç¬¬10æ¡
    console.log(`ğŸ“… å½“å‰æ—¥æœŸ: ${rulePreventionSystem.getCurrentDate()}`)
    
    // æ•°æ®å®‰å…¨é¢„æ£€æŸ¥
    const securityViolations = await rulePreventionSystem.checkDataSecurityRules(taskDescription)
    if (securityViolations.length > 0) {
        throw new Error(`ğŸš¨ æ•°æ®å®‰å…¨è§„åˆ™è¿è§„: ${securityViolations.join(', ')}`)
    }
    
    // Phase 2: æ‰§è¡Œä»»åŠ¡ï¼ˆå¸¦å®æ—¶ç›‘æ§ï¼‰
    let result
    try {
        result = await rulePreventionSystem.setupTimeoutPrevention(taskFunction())
    } catch (error) {
        console.error('âŒ ä»»åŠ¡æ‰§è¡Œå¤±è´¥:', error.message)
        
        // ç”¨æˆ·è§„åˆ™ç¬¬12æ¡ï¼š120ç§’è¶…æ—¶è‡ªåŠ¨é‡è¯•
        if (error.message.includes('è¶…æ—¶')) {
            console.log('ğŸ”„ æ£€æµ‹åˆ°è¶…æ—¶ï¼Œæ‰§è¡Œè‡ªåŠ¨é‡è¯•...')
            result = await taskFunction() // é‡è¯•æœºåˆ¶
        } else {
            throw error
        }
    }
    
    // Phase 3: ä»»åŠ¡å®ŒæˆåéªŒè¯
    const validationPassed = await taskValidator.runFinalValidation()
    if (!validationPassed) {
        throw new Error('âŒ ä»»åŠ¡å®ŒæˆéªŒè¯å¤±è´¥ï¼Œéœ€è¦ä¿®å¤åå†ç»§ç»­')
    }
    
    console.log('âœ… ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰€æœ‰è§„åˆ™éªŒè¯é€šè¿‡')
    return result
}
```

#### ğŸ“Š æ•ˆç‡ä¼˜åŒ–æŒ‡æ ‡ä¸ç›‘æ§

##### Claude 4 Sonnet è¯·æ±‚æ¬¡æ•°ä¼˜åŒ–ç›®æ ‡
```javascript
// ğŸ”´ è¯·æ±‚æ¬¡æ•°ä¼˜åŒ–ç›‘æ§
class EfficiencyOptimizer {
    constructor() {
        this.metrics = {
            totalRequests: 0,
            parallelRequests: 0,
            wastedRequests: 0,
            timeoutViolations: 0,
            ruleViolations: 0
        }
        this.optimizationTarget = {
            parallelRatio: 0.8,        // 80%å¹¶è¡Œè°ƒç”¨ç‡
            wasteReduction: 0.6,       // 60%æµªè´¹å‡å°‘
            timeoutPrevention: 0.95,   // 95%è¶…æ—¶é¢„é˜²
            ruleCompliance: 1.0        // 100%è§„åˆ™éµå¾ª
        }
    }
    
    // ğŸ”´ æ•ˆç‡æŠ¥å‘Šç”Ÿæˆ
    generateEfficiencyReport() {
        const parallelRatio = this.metrics.parallelRequests / this.metrics.totalRequests
        const wasteRatio = this.metrics.wastedRequests / this.metrics.totalRequests
        const complianceRatio = 1 - (this.metrics.ruleViolations / this.metrics.totalRequests)
        
        return {
            summary: {
                totalRequests: this.metrics.totalRequests,
                parallelRatio: (parallelRatio * 100).toFixed(1) + '%',
                wasteRatio: (wasteRatio * 100).toFixed(1) + '%',
                complianceRate: (complianceRatio * 100).toFixed(1) + '%'
            },
            recommendations: this.generateOptimizationRecommendations(parallelRatio, wasteRatio, complianceRatio)
        }
    }
}

// ğŸ”´ å…¨å±€æ•ˆç‡ä¼˜åŒ–å™¨
const efficiencyOptimizer = new EfficiencyOptimizer()
```

#### ğŸš¨ è¿è§„é¢„è­¦ä¸å¤„ç†æœºåˆ¶

##### å®æ—¶è¿è§„æ£€æµ‹
```javascript
// ğŸ”´ è¿è§„å®æ—¶æ£€æµ‹ä¸å¤„ç†
class RuleViolationHandler {
    constructor() {
        this.violationTypes = {
            DATA_SECURITY: 'æ•°æ®å®‰å…¨è¿è§„',
            EFFICIENCY_WASTE: 'æ•ˆç‡æµªè´¹',
            TIMEOUT_VIOLATION: 'è¶…æ—¶è¿è§„', 
            STANDARD_VIOLATION: 'æ ‡å‡†è¿è§„',
            CLEANUP_VIOLATION: 'æ¸…ç†è¿è§„'
        }
        this.violationLog = []
    }
    
    // ğŸ”´ è¿è§„å¤„ç†æµç¨‹
    async handleViolation(violationType, details) {
        const violation = {
            type: violationType,
            details: details,
            timestamp: new Date().toISOString(),
            resolved: false
        }
        
        this.violationLog.push(violation)
        
        // ç«‹å³åœæ­¢æ“ä½œ
        console.error(`ğŸš¨ æ£€æµ‹åˆ°è§„åˆ™è¿è§„: ${violationType}`)
        console.error(`è¯¦ç»†ä¿¡æ¯: ${details}`)
        
        // æ ¹æ®è¿è§„ç±»å‹æ‰§è¡Œå¯¹åº”å¤„ç†
        switch (violationType) {
            case this.violationTypes.DATA_SECURITY:
                await this.handleDataSecurityViolation(details)
                break
            case this.violationTypes.EFFICIENCY_WASTE:
                await this.handleEfficiencyViolation(details)
                break
            case this.violationTypes.TIMEOUT_VIOLATION:
                await this.handleTimeoutViolation(details)
                break
            default:
                await this.handleGenericViolation(details)
        }
        
        violation.resolved = true
        return violation
    }
    
    // ğŸ”´ æ•°æ®å®‰å…¨è¿è§„å¤„ç†
    async handleDataSecurityViolation(details) {
        console.error('ğŸ” æ•°æ®å®‰å…¨è¿è§„å¤„ç†:')
        console.error('1. ç«‹å³åœæ­¢æ‰€æœ‰å¼€å‘å·¥ä½œ')
        console.error('2. ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç æ•°æ®')
        console.error('3. æ”¹ä¸ºçœŸå®åç«¯APIè°ƒç”¨')
        console.error('4. æ·»åŠ åç«¯å¼‚å¸¸å¤„ç†æœºåˆ¶')
        
        throw new Error('ğŸš¨ ä¸¥é‡è¿è§„ï¼è¿åå¤©å·¥é¡¹ç›®æ ¸å¿ƒå®‰å…¨è§„åˆ™ï¼Œç¦æ­¢ç»§ç»­å¼€å‘ï¼')
    }
}

// ğŸ”´ å…¨å±€è¿è§„å¤„ç†å™¨
const violationHandler = new RuleViolationHandler()
```

## ğŸ“‹ å®Œæ•´æ‰§è¡Œæ£€æŸ¥æ¸…å•

### âœ… ä»»åŠ¡å¼€å§‹å‰å¿…é¡»ç¡®è®¤
- [ ] å·²å£°æ˜ä½¿ç”¨Claude 4 Sonnetæ¨¡å‹
- [ ] å·²è·å–å½“å‰å‡†ç¡®æ—¥æœŸï¼ˆ2025å¹´07æœˆ02æ—¥ï¼‰
- [ ] å·²è¿›è¡Œæ•°æ®å®‰å…¨è§„åˆ™é¢„æ£€æŸ¥
- [ ] å·²è§„åˆ’å¹¶è¡Œå·¥å…·è°ƒç”¨ç­–ç•¥
- [ ] å·²è®¾ç½®120ç§’è¶…æ—¶ç›‘æ§
- [ ] å·²ç¡®è®¤å¾®ä¿¡å°ç¨‹åºå¼€å‘æ ‡å‡†
- [ ] å·²å‡†å¤‡ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†æœºåˆ¶

### âœ… ä»»åŠ¡æ‰§è¡Œä¸­å¿…é¡»ç›‘æ§
- [ ] å®æ—¶ç›‘æ§å·¥å…·è°ƒç”¨æ•ˆç‡
- [ ] æ£€æµ‹Mockæ•°æ®ä½¿ç”¨æƒ…å†µ
- [ ] ç›‘æ§è¶…æ—¶é£é™©
- [ ] éªŒè¯ä»£ç å…¼å®¹æ€§
- [ ] ç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§

### âœ… ä»»åŠ¡å®Œæˆåå¿…é¡»éªŒè¯
- [ ] é¡¹ç›®è¿è¡ŒçŠ¶æ€å¥åº·æ£€æŸ¥
- [ ] ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
- [ ] æ•°æ®å®‰å…¨è§„åˆ™éªŒè¯
- [ ] ä»£ç è´¨é‡æ ‡å‡†æ£€æŸ¥
- [ ] ç”¨æˆ·è§„åˆ™éµå¾ªéªŒè¯
- [ ] æ•ˆç‡ä¼˜åŒ–æŠ¥å‘Šç”Ÿæˆ

## ğŸ¯ è§„åˆ™é¢„é˜²ç³»ç»Ÿå¯ç”¨ç¡®è®¤

**æ‰€æœ‰è§„åˆ™ç†è§£ç¡®è®¤**: âœ… å®Œæˆ  
**é¢„é˜²æ£€æŸ¥æœºåˆ¶**: âœ… å·²ç”Ÿæˆ  
**è‡ªåŠ¨åŒ–éªŒè¯æµç¨‹**: âœ… å·²å»ºç«‹  
**è¿è§„å¤„ç†æœºåˆ¶**: âœ… å·²éƒ¨ç½²  
**æ•ˆç‡ä¼˜åŒ–ç›‘æ§**: âœ… å·²æ¿€æ´»  

---

**åˆ›å»ºæ—¶é—´**: 2025å¹´07æœˆ02æ—¥  
**é€‚ç”¨èŒƒå›´**: æ‰€æœ‰Claude 4 Sonnetå¼€å‘ä»»åŠ¡  
**ç»´æŠ¤çŠ¶æ€**: âœ… æ¿€æ´»ä¸­ - å¼€å‘è‡ªåŠ¨åŒ–ä¸ç¯å¢ƒè§„èŒƒå·²å…¨é¢éƒ¨ç½²  
**ä½¿ç”¨æ¨¡å‹**: Claude 4 Sonnet  
**ä¼˜åŒ–ç›®æ ‡**: é›¶è¿è§„ã€é«˜æ•ˆç‡ã€å®Œå…¨åˆè§„ã€ç¯å¢ƒç¨³å®š



