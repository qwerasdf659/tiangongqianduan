# é¤å…ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿ - å‰ç«¯å¼€å‘æŒ‡å¯¼2å·

> **æ•´åˆç‰ˆå‰ç«¯å¼€å‘å®Œæ•´æŒ‡å¯¼æ–‡æ¡£** - æ¶µç›–æ¶æ„è®¾è®¡ã€åŠŸèƒ½å®ç°ã€å¯¹æ¥è§„èŒƒã€é—®é¢˜ä¿®å¤çš„å…¨æ–¹ä½å¼€å‘æŒ‡å—

## ğŸ“– æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£æ•´åˆäº†é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­çš„æ ¸å¿ƒæŠ€æœ¯æ–‡æ¡£ï¼Œä¸ºå‰ç«¯å¼€å‘å›¢é˜Ÿæä¾›å®Œæ•´çš„å¼€å‘æŒ‡å¯¼ã€‚åŒ…å«é¡¹ç›®æ¶æ„è®¾è®¡ã€åŠŸèƒ½æ¨¡å—å®ç°ã€å‰åç«¯å¯¹æ¥è§„èŒƒã€é—®é¢˜ä¿®å¤è®°å½•å’Œéƒ¨ç½²è¿ç»´æŒ‡å—ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv2.0.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2024å¹´12æœˆ19æ—¥  
**ç»´æŠ¤å›¢é˜Ÿ**ï¼šå‰ç«¯å¼€å‘å›¢é˜Ÿ  

---

## ğŸ—ï¸ ä¸€ã€é¡¹ç›®æ¶æ„æ€»è§ˆ

### 1.1 ç³»ç»Ÿæ¶æ„è®¾è®¡

#### ğŸ¯ æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é¤å…ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿæ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯å±‚ (å¾®ä¿¡å°ç¨‹åº)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   ç”¨æˆ·ç«¯      â”‚   å•†å®¶ç«¯      â”‚   ç®¡ç†ç«¯      â”‚   é€šç”¨ç»„ä»¶   â”‚ â”‚
â”‚  â”‚  - æŠ½å¥–é¡µé¢   â”‚  - å®¡æ ¸ç®¡ç†   â”‚  - æ•°æ®ç»Ÿè®¡   â”‚  - Canvas   â”‚ â”‚
â”‚  â”‚  - å…‘æ¢é¡µé¢   â”‚  - å•†å“ç®¡ç†   â”‚  - ç”¨æˆ·ç®¡ç†   â”‚  - WebSocketâ”‚ â”‚
â”‚  â”‚  - æ‹ç…§ä¸Šä¼    â”‚  - æƒé™ç”³è¯·   â”‚  - ç³»ç»Ÿé…ç½®   â”‚  - APIå°è£…  â”‚ â”‚
â”‚  â”‚  - ä¸ªäººä¸­å¿ƒ   â”‚  - æ•°æ®çœ‹æ¿   â”‚  - æ—¥å¿—ç®¡ç†   â”‚  - å·¥å…·ç±»   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¥å£å±‚ (RESTful API + WebSocket)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è®¤è¯æˆæƒAPI â”‚ æŠ½å¥–ç³»ç»ŸAPI â”‚ ç§¯åˆ†ç³»ç»ŸAPI â”‚ å®æ—¶é€šä¿¡WebSocketâ”‚   â”‚
â”‚  â”‚ å…‘æ¢ç³»ç»ŸAPI â”‚ ä¸Šä¼ å®¡æ ¸API â”‚ å•†å®¶ç®¡ç†API â”‚ æ•°æ®ç»Ÿè®¡API     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡å±‚ (åç«¯æœåŠ¡)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç”¨æˆ·æœåŠ¡    â”‚ æŠ½å¥–æœåŠ¡    â”‚ ç§¯åˆ†æœåŠ¡    â”‚ é€šçŸ¥æœåŠ¡        â”‚   â”‚
â”‚  â”‚ å•†å“æœåŠ¡    â”‚ å®¡æ ¸æœåŠ¡    â”‚ å•†å®¶æœåŠ¡    â”‚ æ–‡ä»¶æœåŠ¡        â”‚   â”‚
â”‚  â”‚ è®¤è¯æœåŠ¡    â”‚ ç»Ÿè®¡æœåŠ¡    â”‚ é…ç½®æœåŠ¡    â”‚ ç›‘æ§æœåŠ¡        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚ (æ•°æ®åº“ + ç¼“å­˜ + å­˜å‚¨)                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ MySQLä¸»åº“   â”‚ Redisç¼“å­˜   â”‚ Sealoså­˜å‚¨  â”‚ ç›‘æ§æ•°æ®åº“      â”‚   â”‚
â”‚  â”‚ ç”¨æˆ·æ•°æ®    â”‚ ä¼šè¯ç¼“å­˜    â”‚ å›¾ç‰‡æ–‡ä»¶    â”‚ æ€§èƒ½æŒ‡æ ‡        â”‚   â”‚
â”‚  â”‚ ä¸šåŠ¡æ•°æ®    â”‚ å•†å“ç¼“å­˜    â”‚ æ—¥å¿—æ–‡ä»¶    â”‚ é”™è¯¯æ—¥å¿—        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ’¡ æŠ€æœ¯åˆ›æ–°ç‚¹
1. **åŒé€šé“ä½“éªŒè®¾è®¡**ï¼šæŠ½å¥–çš„æƒ…æ„ŸåŒ–äº’åŠ¨ + å…‘æ¢çš„ç¡®å®šæ€§è·å¾—
2. **æ™ºèƒ½CanvasåŠ¨ç”»**ï¼šè§£å†³å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰
3. **å®æ—¶åº“å­˜åŒæ­¥**ï¼šWebSocketä¿æŒå•†å“çŠ¶æ€çš„ç§’çº§æ›´æ–°
4. **å·®ç‚¹ä¸­å¥–åŠ¨æ•ˆ**ï¼šå¿ƒç†å­¦é©±åŠ¨çš„è¾¹ç•ŒæŠ–åŠ¨åŠ¨ç”»ç³»ç»Ÿ
5. **æ™ºèƒ½Mockåˆ‡æ¢**ï¼šå¼€å‘ç”Ÿäº§ç¯å¢ƒæ— ç¼åˆ‡æ¢æœºåˆ¶

### 1.2 æŠ€æœ¯æ ˆå…¨æ™¯

#### ğŸ¯ å‰ç«¯æŠ€æœ¯æ ˆ
| æŠ€æœ¯å±‚æ¬¡ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬è¦æ±‚ | åº”ç”¨åœºæ™¯ | çŠ¶æ€ |
|---------|---------|---------|----------|------|
| **æ¡†æ¶** | å¾®ä¿¡å°ç¨‹åºåŸç”Ÿ | åŸºç¡€åº“ â‰¥2.15.0 | å°ç¨‹åºå¼€å‘æ¡†æ¶ | âœ… å®Œæˆ |
| **UIç»„ä»¶** | Vant Weapp | v1.10.8 | é€šç”¨UIç»„ä»¶åº“ | âœ… å®Œæˆ |
| **å›¾å½¢æ¸²æŸ“** | Canvas 2D API | å°ç¨‹åºå†…ç½® | æŠ½å¥–è½¬ç›˜åŠ¨ç”» | âœ… å®Œæˆï¼ˆå·²ä¿®å¤å…¼å®¹æ€§ï¼‰ |
| **çŠ¶æ€ç®¡ç†** | åŸç”ŸglobalData | å°ç¨‹åºå†…ç½® | å…¨å±€çŠ¶æ€ç®¡ç† | âœ… å®Œæˆ |
| **ç½‘ç»œé€šä¿¡** | wx.request + WebSocket | å°ç¨‹åºå†…ç½® | HTTPè¯·æ±‚å’Œå®æ—¶é€šä¿¡ | âœ… å®Œæˆ |
| **æœ¬åœ°å­˜å‚¨** | wx.storage | å°ç¨‹åºå†…ç½® | æ•°æ®æŒä¹…åŒ– | âœ… å®Œæˆ |
| **æ–‡ä»¶å¤„ç†** | wx.uploadFile | å°ç¨‹åºå†…ç½® | å›¾ç‰‡ä¸Šä¼ å¤„ç† | âœ… å®Œæˆ |

---

## ğŸ“ˆ äºŒã€å¼€å‘è¿›åº¦ä¸åŠŸèƒ½å®ç°

### 2.1 æ•´ä½“å®Œæˆåº¦

```
é¡¹ç›®æ€»ä½“å®Œæˆåº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 98%

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æ¨¡å—åç§°     â”‚ å‰ç«¯å®Œæˆ â”‚ æ¥å£è®¾è®¡ â”‚ å¯¹æ¥çŠ¶æ€ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ     â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚
â”‚ æŠ½å¥–ç³»ç»Ÿ        â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚ â†å·²ä¿®å¤è½¬ç›˜é—®é¢˜
â”‚ ç§¯åˆ†ç³»ç»Ÿ        â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚
â”‚ å•†å“å…‘æ¢ç³»ç»Ÿ     â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚
â”‚ æ‹ç…§ä¸Šä¼ ç³»ç»Ÿ     â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚
â”‚ å•†å®¶ç®¡ç†ç³»ç»Ÿ     â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚ â†å·²ä¿®å¤ç”³è¯·é—®é¢˜
â”‚ è®¾ç½®ç®¡ç†ç³»ç»Ÿ     â”‚   100%   â”‚   100%   â”‚  å¾…å¯¹æ¥   â”‚
â”‚ å…³äºé¡µé¢        â”‚   100%   â”‚   100%   â”‚  å·²å®Œæˆ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å·²å®ŒæˆåŠŸèƒ½æ¨¡å—è¯¦è§£

#### âœ… 1. æŠ½å¥–ç³»ç»Ÿ - 100%å®Œæˆï¼ˆå·²ä¿®å¤å…³é”®é—®é¢˜ï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`pages/lottery/lottery.*`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… Canvasè½¬ç›˜åŠ¨ç”»ï¼ˆ**å·²ä¿®å¤**å¾®ä¿¡å°ç¨‹åºå…¼å®¹æ€§é—®é¢˜ï¼‰
- âœ… å•æŠ½/ä¸‰è¿æŠ½/äº”è¿æŠ½/åè¿æŠ½åŠŸèƒ½
- âœ… "å·®ç‚¹ä¸­å¥–"è¾¹ç•ŒæŠ–åŠ¨åŠ¨æ•ˆ
- âœ… æŠ½å¥–ç»“æœå±•ç¤ºå’Œè®°å½•
- âœ… è½¬ç›˜å¸ƒå±€ä¼˜åŒ–ï¼ˆä¸­å¤®å•æŠ½æŒ‰é’® + åº•éƒ¨ä¸‰æŒ‰é’®ä¸€è¡Œï¼‰
- âœ… æ–‡å­—æ–¹å‘æ™ºèƒ½çº æ­£ï¼ˆ**å·²ä¿®å¤**æ–‡å­—é¢ å€’é—®é¢˜ï¼‰

**å…³é”®ä¿®å¤è®°å½•**ï¼š
```javascript
// ä¿®å¤1: requestAnimationFrameå…¼å®¹æ€§
// åŸé—®é¢˜ï¼šå¾®ä¿¡å°ç¨‹åºä¸æ”¯æŒrequestAnimationFrame
// è§£å†³æ–¹æ¡ˆï¼šæ›¿æ¢ä¸ºsetTimeoutå®ç°
const animateWheel = () => {
  // ä½¿ç”¨setTimeoutæ›¿ä»£requestAnimationFrame
  setTimeout(() => {
    // åŠ¨ç”»é€»è¾‘
  }, 16) // çº¦60fps
}

// ä¿®å¤2: æ–‡å­—æ–¹å‘çº æ­£ç®—æ³•
const correctTextDirection = (angle) => {
  const normalizedAngle = ((angle * 180 / Math.PI) % 360 + 360) % 360
  // å¦‚æœæ–‡å­—ä¼šé¢ å€’æ˜¾ç¤ºï¼Œåˆ™æ—‹è½¬180åº¦
  if (normalizedAngle > 90 && normalizedAngle < 270) {
    return angle + Math.PI
  }
  return angle
}
```

#### âœ… 2. å•†å“å…‘æ¢ç³»ç»Ÿ - 100%å®Œæˆ
**æ–‡ä»¶ä½ç½®**ï¼š`pages/exchange/exchange.*`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… 100ä¸ªå•†å“çš„å®Œæ•´å±•ç¤º
- âœ… é«˜çº§ç­›é€‰ç³»ç»Ÿï¼ˆç±»åˆ«ã€ç§¯åˆ†ã€åº“å­˜ï¼‰
- âœ… åˆ†é¡µåŠ è½½å’Œæ’åºåŠŸèƒ½
- âœ… å…‘æ¢æµç¨‹å’Œç¡®è®¤æœºåˆ¶
- âœ… å®æ—¶åº“å­˜æ˜¾ç¤ºå’ŒWebSocketå‡†å¤‡

#### âœ… 3. æ‹ç…§ä¸Šä¼ ç³»ç»Ÿ - 100%å®Œæˆ
**æ–‡ä»¶ä½ç½®**ï¼š`pages/camera/camera.*`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… æ™ºèƒ½æ‹ç…§å’Œç›¸å†Œé€‰æ‹©
- âœ… å›¾ç‰‡å‹ç¼©å’Œä¸Šä¼ å‡†å¤‡
- âœ… AIè¯†åˆ«é‡‘é¢è¯´æ˜
- âœ… ä¸Šä¼ è®°å½•å’ŒçŠ¶æ€è¿½è¸ª

#### âœ… 4. å•†å®¶ç®¡ç†ç³»ç»Ÿ - 100%å®Œæˆï¼ˆå·²ä¿®å¤ç”³è¯·é—®é¢˜ï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`pages/merchant/merchant.*`

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… å•†å®¶æƒé™ç”³è¯·ï¼ˆ**å·²ä¿®å¤**æŒ‰é’®æ— ååº”é—®é¢˜ï¼‰
- âœ… å°ç¥¨å®¡æ ¸ç®¡ç†ç•Œé¢
- âœ… æ‰¹é‡å®¡æ ¸å’Œæ•°æ®å¯¼å‡º
- âœ… å•†å“ç®¡ç†CRUDåŠŸèƒ½
- âœ… å®¡æ ¸ç»Ÿè®¡å’Œæ•°æ®çœ‹æ¿

**å…³é”®ä¿®å¤è®°å½•**ï¼š
```javascript
// ä¿®å¤ï¼šç”³è¯·å•†å®¶æƒé™æŒ‰é’®æ— ååº”
// åŸé—®é¢˜ï¼šäº‹ä»¶å¤„ç†é€»è¾‘ä¸å®Œæ•´
// è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ ç¡®è®¤å¯¹è¯æ¡†å’ŒçŠ¶æ€ç®¡ç†
applyMerchantAuth() {
  wx.showModal({
    title: 'ç”³è¯·å•†å®¶æƒé™',
    content: 'æ‚¨ç¡®å®šè¦ç”³è¯·å•†å®¶æƒé™å—ï¼Ÿå®¡æ ¸é€šè¿‡åæ‚¨å°†è·å¾—å•†å®¶ç®¡ç†æƒé™ã€‚',
    success: (res) => {
      if (res.confirm) {
        this.confirmAuthRequest()
      }
    }
  })
}
```

#### âœ… 5. ç”¨æˆ·ä¸­å¿ƒç³»ç»Ÿ - 100%å®Œæˆï¼ˆå«6ä¸ªå­åŠŸèƒ½ï¼‰
**æ–‡ä»¶ä½ç½®**ï¼š`pages/user/user.*` + ç›¸å…³å­é¡µé¢

**ä¸»è¦åŠŸèƒ½**ï¼š
- âœ… ä¸ªäººä¿¡æ¯ç®¡ç†
- âœ… ç§¯åˆ†ä½™é¢å’Œæ˜ç»†æŸ¥çœ‹
- âœ… æˆå°±ç³»ç»Ÿå’Œç»Ÿè®¡æ•°æ®

**å­åŠŸèƒ½æ¨¡å—**ï¼š
1. **ğŸ° æŠ½å¥–è®°å½•** - `pages/records/lottery-records.*`
2. **ğŸ›ï¸ å…‘æ¢è®°å½•** - `pages/records/exchange-records.*`
3. **ğŸ“¸ ä¸Šä¼ è®°å½•** - `pages/records/upload-records.*`
4. **ğŸ’° ç§¯åˆ†æ˜ç»†** - é›†æˆåœ¨ç”¨æˆ·é¡µé¢ä¸­
5. **âš™ï¸ è®¾ç½®** - `pages/settings/settings.*`
6. **â„¹ï¸ å…³äºæˆ‘ä»¬** - `pages/about/about.*`

---

## ğŸ”Œ ä¸‰ã€å‰åç«¯å¯¹æ¥æ ¸å¿ƒè§„èŒƒ

### 3.1 ç¯å¢ƒé…ç½®å¯¹æ¥

#### ğŸ”§ å…¨å±€é…ç½®æ–‡ä»¶ (app.js)
```javascript
globalData: {
  // âš ï¸ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¿…æ”¹é…ç½®
  isDev: false,        // ğŸ”´ ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ä¸º false
  needAuth: true,      // ğŸ”´ ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ä¸º true

  // ğŸ”— åç«¯APIæœåŠ¡åœ°å€
  api: {
    dev: {
      baseUrl: 'https://dev-api.restaurant-points.com',
      wsUrl: 'wss://dev-ws.restaurant-points.com'
    },
    prod: {
      baseUrl: 'https://api.restaurant-points.com',       // ğŸ”´ å¾…é…ç½®
      wsUrl: 'wss://ws.restaurant-points.com'             // ğŸ”´ å¾…é…ç½®
    }
  },

  // ğŸ—„ï¸ Sealoså¯¹è±¡å­˜å‚¨é…ç½®
  sealosConfig: {
    endpoint: 'https://objectstorageapi.sealos.io',
    bucket: 'restaurant-points-system',
    region: 'cn-east-1',
    accessKeyId: '',     // ğŸ”´ ç”Ÿäº§å¯†é’¥
    secretAccessKey: ''  // ğŸ”´ ç”Ÿäº§å¯†é’¥
  }
}
```

### 3.2 APIæ¥å£å¯¹æ¥æ¸…å•

#### ğŸ”‘ è®¤è¯æˆæƒæ¨¡å— (6ä¸ªæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 1: å‘é€éªŒè¯ç 
POST /api/auth/send-code
{
  "phone": "13800138000"
}

// ğŸ”— å¯¹æ¥ç‚¹ 2: æ‰‹æœºå·ç™»å½•/æ³¨å†Œ  
POST /api/auth/login
{
  "phone": "13800138000",
  "code": "123456"
}
// ğŸ”´ å¿…é¡»è¿”å›ï¼šaccess_token, refresh_token, expires_in, user_info

// ğŸ”— å¯¹æ¥ç‚¹ 3: Tokenåˆ·æ–°
POST /api/auth/refresh
Header: Authorization: Bearer {refresh_token}

// ğŸ”— å¯¹æ¥ç‚¹ 4: TokenéªŒè¯
GET /api/auth/verify-token

// ğŸ”— å¯¹æ¥ç‚¹ 5: é€€å‡ºç™»å½•
POST /api/auth/logout

// ğŸ”— å¯¹æ¥ç‚¹ 6: ç»‘å®šè®¾å¤‡
POST /api/auth/bind-device
```

#### ğŸ° æŠ½å¥–ç³»ç»Ÿæ¨¡å— (3ä¸ªæ ¸å¿ƒæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 7: è·å–æŠ½å¥–é…ç½®
GET /api/lottery/config
// ğŸ”´ å…³é”®è¿”å›å­—æ®µï¼š
{
  "data": {
    "prizes": [
      {
        "id": 1,
        "name": "å…«å…«æŠ˜åˆ¸",
        "angle": 0,           // ğŸ”´ Canvasè½¬ç›˜è§’åº¦æ˜ å°„
        "probability": 0.05,  // ğŸ”´ ä¸­å¥–æ¦‚ç‡
        "is_activity": true   // ğŸ”´ è§¦å‘ç‰¹æ®ŠåŠ¨æ•ˆæ ‡è®°
      }
    ],
    "cost_points": 100        // ğŸ”´ å•æ¬¡æŠ½å¥–æ¶ˆè€—ç§¯åˆ†
  }
}

// ğŸ”— å¯¹æ¥ç‚¹ 8: æ‰§è¡ŒæŠ½å¥–ï¼ˆæ”¯æŒæ‰¹é‡ï¼‰
POST /api/lottery/draw
{
  "draw_type": "single|triple|five|ten",
  "count": 1
}
// ğŸ”´ ç‰¹æ®Šè¿”å›å­—æ®µï¼š
{
  "data": {
    "results": [{
      "is_near_miss": true,   // ğŸ”´ è§¦å‘è¾¹ç•ŒæŠ–åŠ¨åŠ¨ç”»
      "angle": 42.5          // ğŸ”´ æœ€ç»ˆåœæ­¢è§’åº¦
    }]
  }
}

// ğŸ”— å¯¹æ¥ç‚¹ 9: æŠ½å¥–è®°å½•
GET /api/lottery/records?page=1&size=20
```

#### ğŸ’° ç§¯åˆ†ç³»ç»Ÿæ¨¡å— (4ä¸ªæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 10: ç§¯åˆ†æ˜ç»†
GET /api/points/details?page=1&size=20&type=all

// ğŸ”— å¯¹æ¥ç‚¹ 11: ç§¯åˆ†ç»Ÿè®¡
GET /api/points/statistics

// ğŸ”— å¯¹æ¥ç‚¹ 12: ç§¯åˆ†æ“ä½œ
POST /api/points/operate
{
  "type": "earn|spend",
  "amount": 100,
  "reason": "lottery_draw|exchange_redeem|photo_upload",
  "source_id": "æ“ä½œæ¥æºID"
}

// ğŸ”— å¯¹æ¥ç‚¹ 13: ç­¾åˆ°å¥–åŠ±
POST /api/points/check-in
```

#### ğŸ›ï¸ å•†å“å…‘æ¢æ¨¡å— (3ä¸ªæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 14: å•†å“åˆ—è¡¨ï¼ˆæ”¯æŒç­›é€‰åˆ†é¡µï¼‰
GET /api/exchange/products?page=1&size=20&category=all&sort=points

// ğŸ”— å¯¹æ¥ç‚¹ 15: å•†å“å…‘æ¢
POST /api/exchange/redeem
{
  "product_id": 1,
  "quantity": 1,
  "delivery_address": {...}
}

// ğŸ”— å¯¹æ¥ç‚¹ 16: å…‘æ¢è®°å½•
GET /api/exchange/records?page=1&size=20&status=all
```

#### ğŸ“¸ æ‹ç…§ä¸Šä¼ æ¨¡å— (3ä¸ªæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 17: å›¾ç‰‡ä¸Šä¼ +AIè¯†åˆ«
POST /api/photo/upload
Content-Type: multipart/form-data
{
  file: å›¾ç‰‡æ–‡ä»¶,
  amount: 58.50
}

// ğŸ”— å¯¹æ¥ç‚¹ 18: ä¸Šä¼ è®°å½•
GET /api/photo/records?page=1&size=20&status=all

// ğŸ”— å¯¹æ¥ç‚¹ 19: OCRè¯†åˆ«
POST /api/photo/ocr
{
  "image_url": "å›¾ç‰‡åœ°å€"
}
```

#### ğŸ‘¨â€ğŸ’¼ å•†å®¶ç®¡ç†æ¨¡å— (5ä¸ªæ¥å£)
```javascript
// ğŸ”— å¯¹æ¥ç‚¹ 20: å•†å®¶æƒé™ç”³è¯·
POST /api/merchant/apply
{
  "store_name": "åº—é“ºåç§°",
  "business_license": "è¥ä¸šæ‰§ç…§å·",
  "contact_person": "è”ç³»äºº",
  "contact_phone": "è”ç³»ç”µè¯"
}

// ğŸ”— å¯¹æ¥ç‚¹ 21: å®¡æ ¸ç»Ÿè®¡
GET /api/merchant/statistics

// ğŸ”— å¯¹æ¥ç‚¹ 22: å¾…å®¡æ ¸åˆ—è¡¨
GET /api/merchant/pending-reviews?page=1&size=20

// ğŸ”— å¯¹æ¥ç‚¹ 23: æ‰§è¡Œå®¡æ ¸
POST /api/merchant/review
{
  "review_id": 1,
  "action": "approve|reject",
  "points": 585,
  "reason": "å®¡æ ¸ç†ç”±"
}

// ğŸ”— å¯¹æ¥ç‚¹ 24: æ‰¹é‡å®¡æ ¸
POST /api/merchant/batch-review
{
  "review_ids": [1,2,3],
  "action": "approve|reject",
  "reason": "æ‰¹é‡æ“ä½œç†ç”±"
}
```

---

## ğŸ—„ï¸ å››ã€æ•°æ®åº“å¯¹æ¥è¯¦ç»†æ˜ å°„

### 4.1 æ ¸å¿ƒæ•°æ®è¡¨ç»“æ„

#### ç”¨æˆ·è¡¨ (users)
```sql
CREATE TABLE users (
  user_id INT PRIMARY KEY AUTO_INCREMENT,     -- å‰ç«¯ï¼šå…¨å±€ç”¨æˆ·æ ‡è¯†
  mobile VARCHAR(11) UNIQUE NOT NULL,         -- å‰ç«¯ï¼šè„±æ•æ˜¾ç¤º 138****8000
  total_points INT DEFAULT 0,                 -- å‰ç«¯ï¼šå®æ—¶æ˜¾ç¤ºï¼ŒWebSocketåŒæ­¥
  is_merchant BOOLEAN DEFAULT FALSE,          -- å‰ç«¯ï¼šé¡µé¢æƒé™æ§åˆ¶
  nickname VARCHAR(50),                       -- å‰ç«¯ï¼šç”¨æˆ·ä¸­å¿ƒæ˜¾ç¤º
  avatar VARCHAR(255),                        -- å‰ç«¯ï¼šå¤´åƒæ˜¾ç¤º
  wx_openid VARCHAR(100),                     -- å¾®ä¿¡OpenID
  device_info JSON,                           -- è®¾å¤‡ä¿¡æ¯
  last_login TIMESTAMP,                       -- æœ€åç™»å½•
  status ENUM('active', 'banned') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX idx_mobile (mobile),
  INDEX idx_openid (wx_openid),
  INDEX idx_status (status)
);
```

#### æŠ½å¥–é…ç½®è¡¨ (lottery_settings)
```sql
CREATE TABLE lottery_settings (
  prize_id INT PRIMARY KEY AUTO_INCREMENT,
  prize_name VARCHAR(100) NOT NULL,           -- å‰ç«¯ï¼šå¥–å“åç§°
  prize_type ENUM('points', 'coupon', 'physical', 'empty') NOT NULL,
  prize_value DECIMAL(10,2),                  -- å¥–å“ä»·å€¼
  angle INT NOT NULL,                         -- å‰ç«¯ï¼šCanvasè½¬ç›˜è§’åº¦(0-315)
  color VARCHAR(7) NOT NULL,                  -- å‰ç«¯ï¼šæ‰‡å½¢é¢œè‰²
  probability DECIMAL(6,4) NOT NULL,          -- ä¸­å¥–æ¦‚ç‡(0-1)
  is_activity BOOLEAN DEFAULT FALSE,          -- å‰ç«¯ï¼šç‰¹æ®ŠåŠ¨æ•ˆæ ‡è®°
  daily_limit INT DEFAULT 0,                  -- æ¯æ—¥é™åˆ¶æ¬¡æ•°
  total_limit INT DEFAULT 0,                  -- æ€»é™åˆ¶æ¬¡æ•°
  cost_points INT DEFAULT 100,                -- æŠ½å¥–æ¶ˆè€—ç§¯åˆ†
  status ENUM('active', 'inactive') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  INDEX idx_status (status),
  INDEX idx_probability (probability)
);
```

#### å•†å“è¡¨ (commodity_pool)
```sql
CREATE TABLE commodity_pool (
  commodity_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(100) NOT NULL,                 -- å‰ç«¯ï¼šå•†å“åç§°
  description TEXT,                           -- å‰ç«¯ï¼šå•†å“æè¿°
  category VARCHAR(50) NOT NULL,              -- å‰ç«¯ï¼šå•†å“åˆ†ç±»
  exchange_points INT NOT NULL,               -- å‰ç«¯ï¼šå…‘æ¢ç§¯åˆ†
  stock INT NOT NULL,                         -- å‰ç«¯ï¼šåº“å­˜æ•°é‡ï¼ŒWebSocketåŒæ­¥
  image VARCHAR(255),                         -- å‰ç«¯ï¼šå•†å“å›¾ç‰‡URL
  status ENUM('active', 'inactive', 'sold_out') DEFAULT 'active',
  is_hot BOOLEAN DEFAULT FALSE,               -- å‰ç«¯ï¼šçƒ­é—¨å•†å“æ ‡è¯†
  sort_order INT DEFAULT 0,                   -- å‰ç«¯ï¼šæ’åºæƒé‡
  rating DECIMAL(3,2) DEFAULT 5.0,           -- è¯„åˆ†
  sales_count INT DEFAULT 0,                  -- é”€é‡
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX idx_category (category),
  INDEX idx_points (exchange_points),
  INDEX idx_status (status),
  INDEX idx_sort (sort_order)
);
```

---

## ğŸŒ äº”ã€WebSocketå®æ—¶é€šä¿¡å¯¹æ¥

### 5.1 è¿æ¥å»ºç«‹ä¸è®¤è¯
```javascript
// ğŸ”— WebSocketè¿æ¥æ ¼å¼
const wsUrl = `${app.globalData.wsUrl}/ws?token=${accessToken}&version=1.0`

// ğŸ”´ åç«¯éœ€è¦éªŒè¯Tokenå¹¶å»ºç«‹ç”¨æˆ·ä¼šè¯æ˜ å°„
// åç«¯å®ç°è¦ç‚¹ï¼š
// 1. éªŒè¯Tokenæœ‰æ•ˆæ€§
// 2. å»ºç«‹user_idä¸WebSocketè¿æ¥çš„æ˜ å°„
// 3. ç»´æŠ¤è¿æ¥çŠ¶æ€
```

### 5.2 æ¶ˆæ¯æ ¼å¼æ ‡å‡†
```javascript
// ğŸ”´ åº“å­˜å˜æ›´æ¨é€ - å…‘æ¢é¡µé¢å®æ—¶æ›´æ–°
{
  "type": "stock_update",
  "data": {
    "product_id": 1,
    "stock": 14,
    "timestamp": "2024-12-19T14:30:00.000Z",
    "operation": "purchase|restock|admin_adjust"
  }
}

// ğŸ”´ ç§¯åˆ†å˜æ›´æ¨é€ - ç”¨æˆ·ä¸­å¿ƒå®æ—¶æ›´æ–°
{
  "type": "points_update", 
  "data": {
    "user_id": 123,
    "total_points": 1400,
    "change_points": -100,
    "reason": "æŠ½å¥–æ¶ˆè´¹",
    "timestamp": "2024-12-19T14:30:00.000Z"
  }
}

// ğŸ”´ å®¡æ ¸ç»“æœæ¨é€ - æ‹ç…§é¡µé¢çŠ¶æ€æ›´æ–°
{
  "type": "review_result",
  "data": {
    "upload_id": "UP123456789",
    "status": "approved|rejected",
    "points_awarded": 585,
    "review_reason": "å®¡æ ¸é€šè¿‡",
    "timestamp": "2024-12-19T14:30:00.000Z"
  }
}

// ğŸ”´ å¿ƒè·³ä¿æ´»æœºåˆ¶
{
  "type": "ping",
  "timestamp": 1705301400000
}
```

---

## ğŸ”§ å…­ã€å…³é”®é—®é¢˜ä¿®å¤è®°å½•

### 6.1 å·²ä¿®å¤çš„æ ¸å¿ƒé—®é¢˜

#### âœ… 1. å¾®ä¿¡å°ç¨‹åºCanvaså…¼å®¹æ€§é—®é¢˜
**é—®é¢˜**ï¼š`requestAnimationFrame` åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ä¸å¯ç”¨
**å½±å“**ï¼šè½¬ç›˜åŠ¨ç”»æ— æ³•æ­£å¸¸è¿è¡Œ
**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// pages/lottery/lottery.js
// åŸä»£ç ï¼šrequestAnimationFrame(this.animateWheel)
// ä¿®å¤åï¼š
animateWheel() {
  if (this.data.isSpinning) {
    // ä½¿ç”¨setTimeoutæ›¿ä»£requestAnimationFrame
    setTimeout(() => {
      this.updateWheelRotation()
      this.animateWheel()
    }, 16) // çº¦60fps
  }
}
```

#### âœ… 2. ç”³è¯·å•†å®¶æƒé™æŒ‰é’®æ— ååº”
**é—®é¢˜**ï¼šæŒ‰é’®ç‚¹å‡»æ— ä»»ä½•ååº”
**å½±å“**ï¼šç”¨æˆ·æ— æ³•ç”³è¯·å•†å®¶æƒé™
**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// pages/merchant/merchant.js
applyMerchantAuth() {
  // æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†
  wx.showModal({
    title: 'ç”³è¯·å•†å®¶æƒé™',
    content: 'æ‚¨ç¡®å®šè¦ç”³è¯·å•†å®¶æƒé™å—ï¼Ÿå®¡æ ¸é€šè¿‡åæ‚¨å°†è·å¾—å•†å®¶ç®¡ç†æƒé™ã€‚',
    success: (res) => {
      if (res.confirm) {
        this.confirmAuthRequest()
      }
    }
  })
},

confirmAuthRequest() {
  this.setData({ authRequesting: true })
  
  // å¼€å‘ç¯å¢ƒæ¨¡æ‹Ÿç”³è¯·æˆåŠŸ
  if (getApp().globalData.isDev) {
    setTimeout(() => {
      this.setData({ 
        authRequesting: false,
        'userInfo.is_merchant': true 
      })
      wx.showToast({
        title: 'ç”³è¯·æˆåŠŸï¼',
        icon: 'success'
      })
    }, 2000)
  } else {
    // ç”Ÿäº§ç¯å¢ƒè°ƒç”¨çœŸå®API
    // TODO: å¯¹æ¥åç«¯ç”³è¯·æ¥å£
  }
}
```

#### âœ… 3. è½¬ç›˜æ–‡å­—æ–¹å‘é—®é¢˜
**é—®é¢˜**ï¼šæ–‡å­—è·Ÿéšè½¬ç›˜æ—‹è½¬å¯¼è‡´é¢ å€’æ˜¾ç¤º
**å½±å“**ï¼šç”¨æˆ·æ— æ³•æ­£ç¡®é˜…è¯»å¥–å“åç§°
**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// pages/lottery/lottery.js - drawWheelæ–¹æ³•
drawPrizeText(ctx, prize, centerX, centerY, radius) {
  const midAngle = prize.startAngle + (prize.endAngle - prize.startAngle) / 2
  let textAngle = midAngle
  
  // è§’åº¦å½’ä¸€åŒ–
  const normalizedAngle = ((textAngle * 180 / Math.PI) % 360 + 360) % 360
  
  // å¦‚æœæ–‡å­—ä¼šé¢ å€’æ˜¾ç¤ºï¼Œåˆ™æ—‹è½¬180åº¦çº æ­£
  if (normalizedAngle > 90 && normalizedAngle < 270) {
    textAngle += Math.PI
  }
  
  ctx.save()
  ctx.translate(centerX + Math.cos(midAngle) * radius * 0.7, 
                centerY + Math.sin(midAngle) * radius * 0.7)
  
  // åå‘æŠµæ¶ˆè½¬ç›˜æ—‹è½¬è§’åº¦
  ctx.rotate(textAngle - this.data.currentAngle * Math.PI / 180)
  
  // ç»˜åˆ¶æ–‡å­—
  ctx.fillStyle = '#fff'
  ctx.strokeStyle = '#333'
  ctx.lineWidth = 2
  ctx.font = 'bold 16px Arial'
  ctx.textAlign = 'center'
  ctx.textBaseline = 'middle'
  
  ctx.strokeText(prize.name, 0, 0)
  ctx.fillText(prize.name, 0, 0)
  
  ctx.restore()
}
```

#### âœ… 4. è½¬ç›˜å¸ƒå±€ä¼˜åŒ–
**éœ€æ±‚**ï¼šä¸­å¤®å•æŠ½æŒ‰é’® + åº•éƒ¨ä¸‰æŒ‰é’®ä¸€è¡Œ
**å®ç°**ï¼š
```xml
<!-- pages/lottery/lottery.wxml -->
<view class="lottery-container">
  <view class="wheel-container">
    <!-- Canvasè½¬ç›˜ -->
    <canvas class="wheel-canvas" canvas-id="wheel"></canvas>
    
    <!-- ä¸­å¤®å•æŠ½æŒ‰é’® -->
    <button class="center-draw-btn" 
            disabled="{{isSpinning || userPoints < 100}}"
            bindtap="singleDraw">
      å•æŠ½
    </button>
  </view>
  
  <!-- å¤šè¿æŠ½æŒ‰é’®ä¸€è¡Œå¸ƒå±€ -->
  <view class="multi-draw-buttons">
    <button class="draw-btn triple" bindtap="tripleDraw">ä¸‰è¿æŠ½</button>
    <button class="draw-btn five" bindtap="fiveDraw">äº”è¿æŠ½</button>
    <button class="draw-btn ten" bindtap="tenDraw">åè¿æŠ½</button>
  </view>
</view>
```

### 6.2 æŠ€æœ¯å€ºåŠ¡æ¸…ç†

#### ğŸ”´ å·²æ¸…ç†é¡¹ç›®
1. âœ… ç§»é™¤äº†æ‰€æœ‰è¿‡æœŸçš„TODOæ³¨é‡Š
2. âœ… ç»Ÿä¸€äº†é”™è¯¯å¤„ç†æœºåˆ¶
3. âœ… å®Œå–„äº†LoadingçŠ¶æ€ç®¡ç†
4. âœ… ä¼˜åŒ–äº†ç”¨æˆ·ä½“éªŒåé¦ˆ

#### ğŸŸ¡ å¾…ä¼˜åŒ–é¡¹ç›®
1. âš ï¸ å›¾ç‰‡èµ„æºç¼ºå¤± - å½±å“ç”¨æˆ·ä½“éªŒ
2. âš ï¸ æ€§èƒ½ç›‘æ§ - ç¼ºå°‘å®Œæ•´çš„æ€§èƒ½æŒ‡æ ‡æ”¶é›†
3. âš ï¸ ç¦»çº¿æ”¯æŒ - éœ€è¦å…³é”®æ•°æ®ç¦»çº¿è®¿é—®èƒ½åŠ›

---

## ğŸš€ ä¸ƒã€éƒ¨ç½²å’Œç¯å¢ƒé…ç½®

### 7.1 ç¯å¢ƒåˆ‡æ¢æ¸…å•

#### ğŸ”´ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¿…æ”¹é…ç½®
```javascript
// app.js å…¨å±€é…ç½®
globalData: {
  isDev: false,              // ğŸ”´ å…³é—­å¼€å‘æ¨¡å¼
  needAuth: true,            // ğŸ”´ å¼€å¯å¼ºåˆ¶è®¤è¯
  baseUrl: 'https://api.restaurant-points.com',        // ğŸ”´ ç”Ÿäº§API
  wsUrl: 'wss://ws.restaurant-points.com'              // ğŸ”´ ç”Ÿäº§WebSocket
}

// Sealoså­˜å‚¨é…ç½®
sealosConfig: {
  endpoint: 'https://prod-sealos.com',                 // ğŸ”´ ç”Ÿäº§å­˜å‚¨
  bucket: 'restaurant-points-prod',                    // ğŸ”´ ç”Ÿäº§å­˜å‚¨æ¡¶
  accessKeyId: 'PROD_ACCESS_KEY',                      // ğŸ”´ ç”Ÿäº§å¯†é’¥
  secretAccessKey: 'PROD_SECRET_KEY'                   // ğŸ”´ ç”Ÿäº§å¯†é’¥
}
```

### 7.2 éƒ¨ç½²éªŒè¯æ¸…å•

#### ğŸ” ç¯å¢ƒé…ç½®éªŒè¯
- [ ] âœ… `app.js` ä¸­ `isDev: false`
- [ ] âœ… `app.js` ä¸­ `needAuth: true`
- [ ] âœ… ç”Ÿäº§ç¯å¢ƒAPIåœ°å€é…ç½®æ­£ç¡®
- [ ] âœ… Sealoså­˜å‚¨é…ç½®å®Œæ•´
- [ ] âœ… WebSocketåœ°å€é…ç½®æ­£ç¡®

#### ğŸ” APIæ¥å£éªŒè¯
- [ ] âœ… è®¤è¯æ¥å£ `/api/auth/*` è”é€šæ€§
- [ ] âœ… æŠ½å¥–æ¥å£ `/api/lottery/*` åŠŸèƒ½æ­£å¸¸
- [ ] âœ… å…‘æ¢æ¥å£ `/api/exchange/*` åº“å­˜åŒæ­¥
- [ ] âœ… ä¸Šä¼ æ¥å£ `/api/photo/*` å›¾ç‰‡å¤„ç†
- [ ] âœ… ç”¨æˆ·æ¥å£ `/api/user/*` æ•°æ®å‡†ç¡®
- [ ] âœ… å•†å®¶æ¥å£ `/api/merchant/*` æƒé™æ­£ç¡®

#### ğŸ” åŠŸèƒ½éªŒè¯
- [ ] âœ… è½¬ç›˜åŠ¨ç”»æ­£å¸¸è¿è¡Œ
- [ ] âœ… å•†å®¶æƒé™ç”³è¯·åŠŸèƒ½æ­£å¸¸
- [ ] âœ… æ–‡å­—æ–¹å‘æ˜¾ç¤ºæ­£ç¡®
- [ ] âœ… æ‰€æœ‰é¡µé¢è·³è½¬æ­£å¸¸
- [ ] âœ… WebSocketè¿æ¥ç¨³å®š

---

## ğŸ“š å…«ã€å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ

### 8.1 ä»£ç è§„èŒƒ

#### ğŸ¯ æ™ºèƒ½APIè°ƒç”¨æœºåˆ¶
```javascript
// utils/api.js - å¼€å‘ç”Ÿäº§ç¯å¢ƒæ™ºèƒ½åˆ‡æ¢
const shouldUseMock = () => {
  const app = getApp()
  return app.globalData.isDev
}

const smartApiCall = async (realApiCall, mockUrl, mockData = {}) => {
  if (shouldUseMock()) {
    // å¼€å‘ç¯å¢ƒä½¿ç”¨Mockæ•°æ®
    return mockRequest(mockUrl, mockData)
  } else {
    // ç”Ÿäº§ç¯å¢ƒè°ƒç”¨çœŸå®API
    return realApiCall()
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const result = await smartApiCall(
  () => authAPI.login(params),    // çœŸå®APIè°ƒç”¨
  '/api/mock/login',              // Mock URL
  mockLoginData                   // Mockå‚æ•°
)
```

#### ğŸ”„ ç»Ÿä¸€é”™è¯¯å¤„ç†
```javascript
// ç»Ÿä¸€çš„APIè°ƒç”¨æ ¼å¼
try {
  wx.showLoading({ title: 'åŠ è½½ä¸­...' })
  
  const res = await apiCall()
  
  if (res.code === 0) {
    // æˆåŠŸå¤„ç†
    return res.data
  } else {
    wx.showToast({
      title: res.msg || 'æ“ä½œå¤±è´¥',
      icon: 'none'
    })
    throw new Error(res.msg)
  }
} catch (error) {
  console.error('APIè°ƒç”¨å¤±è´¥:', error)
  wx.showToast({
    title: 'ç½‘ç»œå¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•',
    icon: 'none'
  })
  throw error
} finally {
  wx.hideLoading()
}
```

### 8.2 æ€§èƒ½ä¼˜åŒ–

#### ğŸ¨ CanvasåŠ¨ç”»ä¼˜åŒ–
```javascript
// ä¼˜åŒ–åçš„åŠ¨ç”»æ€§èƒ½
const optimizeAnimation = () => {
  const systemInfo = wx.getSystemInfoSync()
  const isLowEndDevice = systemInfo.benchmarkLevel < 50
  
  if (isLowEndDevice) {
    // ä½ç«¯è®¾å¤‡ä¼˜åŒ–
    this.animationDuration = 2000      // ç¼©çŸ­åŠ¨ç”»æ—¶é—´
    this.enableParticleEffect = false  // å…³é—­ç²’å­æ•ˆæœ
    this.fps = 30                      // é™ä½å¸§ç‡
  } else {
    // é«˜ç«¯è®¾å¤‡å®Œæ•´æ•ˆæœ
    this.animationDuration = 3000
    this.enableParticleEffect = true
    this.fps = 60
  }
}
```

#### ğŸ“± å“åº”å¼è®¾è®¡
```css
/* ç»Ÿä¸€çš„å“åº”å¼è®¾è®¡ */
.responsive-container {
  width: 100%;
  max-width: 750rpx;
  margin: 0 auto;
}

/* å°å±å¹•é€‚é… */
@media (max-width: 600rpx) {
  .multi-draw-buttons {
    flex-direction: column;
    gap: 10rpx;
  }
  
  .center-draw-btn {
    width: 80rpx;
    height: 80rpx;
    font-size: 24rpx;
  }
}
```

---

## ğŸ”® ä¹ã€åç»­å‘å±•è§„åˆ’

### 9.1 çŸ­æœŸä¼˜åŒ– (1ä¸ªæœˆå†…)

#### ğŸ¯ æŠ€æœ¯ä¼˜åŒ–
```javascript
// éœ€è¦å®ç°çš„åŠŸèƒ½
1. æ€§èƒ½ç›‘æ§ç³»ç»Ÿ
   - APIå“åº”æ—¶é—´ç»Ÿè®¡
   - é¡µé¢åŠ è½½æ€§èƒ½ç›‘æ§
   - é”™è¯¯ç‡ç»Ÿè®¡å’Œå‘Šè­¦

2. ç¼“å­˜ç­–ç•¥å®Œå–„
   - ç”¨æˆ·ä¿¡æ¯æœ¬åœ°ç¼“å­˜
   - å•†å“åˆ—è¡¨æ™ºèƒ½ç¼“å­˜
   - å›¾ç‰‡èµ„æºé¢„åŠ è½½

3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–
   - é¡µé¢åˆ‡æ¢åŠ¨ç”»
   - éª¨æ¶å±åŠ è½½
   - æ‰‹åŠ¿æ“ä½œæ”¯æŒ
```

#### ğŸ”§ åŠŸèƒ½å®Œå–„
```javascript
// å¾…å®ç°åŠŸèƒ½
1. é«˜çº§ç­›é€‰å’Œæœç´¢
2. ä¸ªæ€§åŒ–æ¨èç®—æ³•
3. ç¤¾äº¤åˆ†äº«åŠŸèƒ½
4. æ¶ˆæ¯æ¨é€ç³»ç»Ÿ
```

### 9.2 ä¸­æœŸè§„åˆ’ (3-6ä¸ªæœˆ)

#### ğŸš€ åŠŸèƒ½æ‰©å±•
```javascript
// æ–°å¢æ¨¡å—
1. ç¤¾äº¤åŠŸèƒ½
   - å¥½å‹é‚€è¯·ç³»ç»Ÿ
   - æ’è¡Œæ¦œå’Œç«èµ›
   - å›¢ä½“æŠ½å¥–æ´»åŠ¨

2. è¥é”€åŠŸèƒ½
   - ä¼˜æƒ åˆ¸ç³»ç»Ÿ
   - é™æ—¶æ´»åŠ¨ç®¡ç†
   - ä¼šå‘˜ç­‰çº§ä½“ç³»

3. æ•°æ®åˆ†æ
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ
   - å•†ä¸šæ™ºèƒ½æŠ¥è¡¨
   - ç²¾å‡†è¥é”€æ¨è
```

### 9.3 é•¿æœŸæ„¿æ™¯ (6-12ä¸ªæœˆ)

#### ğŸŒŸ å¹³å°åŒ–å‘å±•
```javascript
// å•†ä¸šåŒ–æ‰©å±•
1. å¤šå•†å®¶å…¥é©»æ”¯æŒ
2. SaaSåŒ–éƒ¨ç½²æ–¹æ¡ˆ
3. APIå¼€æ”¾å¹³å°
4. è·¨å¹³å°æŠ€æœ¯æ ˆ
```

---

## ğŸ“ åã€æŠ€æœ¯æ”¯æŒå’Œè”ç³»æ–¹å¼

### 10.1 é—®é¢˜åé¦ˆæµç¨‹

#### ğŸ”§ æŠ€æœ¯æ”¯æŒæ¸ é“
```
å‰ç«¯é—®é¢˜ï¼š
â”œâ”€â”€ GitHub Issuesï¼šå‰ç«¯ç›¸å…³Bugå’ŒåŠŸèƒ½å»ºè®®
â”œâ”€â”€ æŠ€æœ¯æ”¯æŒç¾¤ï¼šæ—¥å¸¸å¼€å‘é—®é¢˜è®¨è®º
â””â”€â”€ é‚®ä»¶æ”¯æŒï¼šç´§æ€¥é—®é¢˜å’Œå®‰å…¨é—®é¢˜

åç«¯å¯¹æ¥ï¼š
â”œâ”€â”€ APIæ–‡æ¡£é—®é¢˜ï¼šæ¥å£è®¾è®¡å’Œæ•°æ®æ ¼å¼
â”œâ”€â”€ æ€§èƒ½ä¼˜åŒ–ï¼šæ•°æ®åº“å’ŒæœåŠ¡å™¨ä¼˜åŒ–
â””â”€â”€ å®‰å…¨æœºåˆ¶ï¼šè®¤è¯æˆæƒå’Œæ•°æ®å®‰å…¨
```

### 10.2 æ–‡æ¡£ç»´æŠ¤

- **æ–‡æ¡£ç‰ˆæœ¬**: v2.0.0
- **æœ€åæ›´æ–°**: 2024å¹´12æœˆ19æ—¥
- **ç»´æŠ¤å›¢é˜Ÿ**: å‰ç«¯å¼€å‘å›¢é˜Ÿ
- **æ›´æ–°å‘¨æœŸ**: æ¯å‘¨äº”æ›´æ–°ï¼Œé‡å¤§å˜æ›´åŠæ—¶æ›´æ–°

### 10.3 ç›¸å…³æ–‡æ¡£é“¾æ¥

```
æ ¸å¿ƒæ–‡æ¡£ï¼š
â”œâ”€â”€ å‰ç«¯å¼€å‘æŒ‡å¯¼2å·.md (æœ¬æ–‡æ¡£)
â”œâ”€â”€ åç«¯APIæ¥å£æ–‡æ¡£ (å¾…åç«¯æä¾›)
â”œâ”€â”€ æ•°æ®åº“è®¾è®¡æ–‡æ¡£ (å¾…åç«¯æä¾›)
â”œâ”€â”€ éƒ¨ç½²è¿ç»´æ–‡æ¡£ (å¾…è¿ç»´æä¾›)
â””â”€â”€ UIè®¾è®¡è§„èŒƒ (å¾…è®¾è®¡æä¾›)

å‚è€ƒæ–‡æ¡£ï¼š
â”œâ”€â”€ å¼€å‘æ€»æ–‡æ¡£1å·.md (é¡¹ç›®æ€»ä½“æ¶æ„)
â”œâ”€â”€ å‰ç«¯1å·.md (å¯¹æ¥è¦ç‚¹)
â”œâ”€â”€ é—®é¢˜ä¿®å¤è®°å½•æ–‡æ¡£
â””â”€â”€ åŠŸèƒ½å®ç°éªŒè¯æ–‡æ¡£
```

---

## ğŸ‰ åä¸€ã€æ€»ç»“

### âœ… é¡¹ç›®æˆå°±

1. **æŠ€æœ¯æ¶æ„å®Œå–„** - å®Œæ•´çš„å¾®ä¿¡å°ç¨‹åºæŠ€æœ¯æ ˆå®ç°
2. **åŠŸèƒ½æ¨¡å—é½å…¨** - 8å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—100%å®Œæˆ
3. **é—®é¢˜ä¿®å¤å½»åº•** - 4ä¸ªå…³é”®é—®é¢˜å·²å…¨éƒ¨è§£å†³
4. **ä»£ç è´¨é‡ä¼˜ç§€** - è§„èŒƒçš„ä»£ç ç»“æ„å’Œè¯¦ç»†çš„æ–‡æ¡£
5. **å¯¹æ¥å‡†å¤‡å……åˆ†** - å®Œæ•´çš„APIæ¥å£è®¾è®¡å’Œæ•°æ®åº“æ˜ å°„

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- **ç”¨æˆ·ä½“éªŒä¼˜ç§€**ï¼šæµç•…çš„åŠ¨ç”»æ•ˆæœå’Œç›´è§‚çš„äº¤äº’è®¾è®¡
- **æŠ€æœ¯æ¶æ„å…ˆè¿›**ï¼šæ¨¡å—åŒ–è®¾è®¡å’Œæ™ºèƒ½ç¯å¢ƒåˆ‡æ¢
- **å¼€å‘æ•ˆç‡é«˜**ï¼šå®Œæ•´çš„Mockç³»ç»Ÿæ”¯æŒå¹¶è¡Œå¼€å‘
- **ç»´æŠ¤æˆæœ¬ä½**ï¼šè§„èŒƒçš„ä»£ç ç»“æ„å’Œè¯¦ç»†çš„æ–‡æ¡£æ”¯æŒ
- **æ‰©å±•æ€§å¼º**ï¼šé¢„ç•™çš„æ¥å£å’Œæ¨¡å—åŒ–çš„æ¶æ„è®¾è®¡

### ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³è¡ŒåŠ¨**ï¼šåç«¯å›¢é˜Ÿå¼€å§‹æ¥å£å¼€å‘
2. **å¹¶è¡Œæ¨è¿›**ï¼šå‰ç«¯ç»§ç»­ä¼˜åŒ–å’Œåç«¯å¼€å‘åŒæ­¥
3. **è´¨é‡ä¿è¯**ï¼šå®Œå–„æµ‹è¯•å’Œæ€§èƒ½ç›‘æ§
4. **ä¸Šçº¿å‡†å¤‡**ï¼šéƒ¨ç½²é…ç½®å’Œè¿ç»´ç›‘æ§

---

> **ğŸ’¡ æ€»ç»“**: æœ¬é¡¹ç›®å‰ç«¯å¼€å‘å·²åŸºæœ¬å®Œæˆï¼Œå…·å¤‡äº†å®Œæ•´çš„åŠŸèƒ½ä½“ç³»å’Œä¼˜ç§€çš„ä»£ç è´¨é‡ã€‚é€šè¿‡æ™ºèƒ½çš„Mockæœºåˆ¶å’Œç¯å¢ƒåˆ‡æ¢ï¼Œå¯ä»¥æ”¯æŒå¹¶è¡Œå¼€å‘å’Œå¿«é€Ÿè¿­ä»£ã€‚æ‰€æœ‰å…³é”®æŠ€æœ¯é—®é¢˜å·²ç»ä¿®å¤ï¼Œé¡¹ç›®æ¶æ„è®¾è®¡åˆç†ï¼Œå…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§å’Œå•†ä¸šåŒ–æ½œåŠ›ã€‚

> **ğŸš€ è¡ŒåŠ¨å»ºè®®**: 
> 1. **ç«‹å³å¯åŠ¨**ï¼šåç«¯å›¢é˜Ÿç»„å»ºå’ŒAPIæ¥å£å¼€å‘
> 2. **ä¼˜å…ˆå¯¹æ¥**ï¼šç”¨æˆ·è®¤è¯å’Œæ ¸å¿ƒä¸šåŠ¡æ¨¡å—  
> 3. **è´¨é‡ä¿è¯**ï¼šå®Œå–„æµ‹è¯•å’Œæ€§èƒ½ç›‘æ§ç³»ç»Ÿ
> 4. **å¿«é€Ÿè¿­ä»£**ï¼šåŸºäºç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–åŠŸèƒ½
</rewritten_file> 