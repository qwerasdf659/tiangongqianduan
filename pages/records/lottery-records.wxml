<!--pages/records/lottery-records.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <view class="header-content">
      <view class="back-btn" bindtap="onBack">
        <text class="back-icon">â—€</text>
      </view>
      <view class="header-title">
        <text class="title-text">æŠ½å¥–è®°å½•</text>
        <text class="title-desc">æˆ‘çš„æŠ½å¥–å†å²</text>
      </view>
      <view class="header-actions">
        <text class="total-count">å…±{{total}}æ¬¡</text>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡å¡ç‰‡ -->
  <view class="statistics-card" wx:if="{{!loading}}">
    <view class="stat-item">
      <text class="stat-number">{{statistics.totalCount}}</text>
      <text class="stat-label">æŠ½å¥–æ¬¡æ•°</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{statistics.totalPoints}}</text>
      <text class="stat-label">æ¶ˆè´¹ç§¯åˆ†</text>
    </view>
    <!-- ğŸ”´ ç§»é™¤ä¸­å¥–ç‡æ˜¾ç¤º -->
    <!-- <view class="stat-item">
      <text class="stat-number">{{statistics.successRate}}%</text>
      <text class="stat-label">ä¸­å¥–ç‡</text>
    </view> -->
    <view class="stat-item best-prize">
      <text class="stat-number">{{statistics.bestPrize}}</text>
      <text class="stat-label">æœ€ä½³å¥–å“</text>
    </view>
  </view>

  <!-- ç­›é€‰æ ‡ç­¾ -->
  <view class="filter-tabs">
    <view 
      class="filter-tab {{filterType === 'all' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="all"
    >
      <text>å…¨éƒ¨</text>
    </view>
    <!-- ğŸ”´ ç§»é™¤å•æŠ½å’Œäº”è¿æŠ½ç­›é€‰æŒ‰é’® -->
    <!-- <view 
      class="filter-tab {{filterType === 'single' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="single"
    >
      <text>å•æŠ½</text>
    </view>
    <view 
      class="filter-tab {{filterType === 'five' ? 'active' : ''}}"
      bindtap="onFilterChange"
      data-type="five"
    >
      <text>äº”è¿æŠ½</text>
    </view> -->
  </view>

  <!-- è®°å½•åˆ—è¡¨ -->
  <view class="records-list" wx:if="{{!loading}}">
    <view 
      class="record-item"
      wx:for="{{records}}" 
      wx:key="id"
      bindtap="onViewDetail"
      data-record="{{item}}"
    >
      <view class="record-left">
        <view class="record-type">
          <text class="type-icon">{{item.draw_type === 'five' ? 'ğŸ°' : 'ğŸ²'}}</text>
          <text class="type-text">{{item.draw_type === 'five' ? 'äº”è¿æŠ½' : 'å•æŠ½'}}</text>
        </view>
        <view class="record-time">{{item.created_at}}</view>
      </view>
      
      <view class="record-center">
        <view class="prize-info">
          <text class="prize-name {{item.prize_name === 'è°¢è°¢å‚ä¸' ? 'no-prize' : 'has-prize'}}">
            {{item.prize_name}}
          </text>
          <text class="prize-value" wx:if="{{item.prize_value > 0}}">
            ä»·å€¼{{item.prize_value}}ç§¯åˆ†
          </text>
        </view>
      </view>
      
      <view class="record-right">
        <view class="points-cost">
          <text class="cost-label">èŠ±è´¹</text>
          <text class="cost-value">{{item.points_cost}}ç§¯åˆ†</text>
        </view>
        <text class="detail-arrow">â–¶</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{records.length === 0}}">
      <text class="empty-icon">ğŸ°</text>
      <text class="empty-text">è¿˜æ²¡æœ‰æŠ½å¥–è®°å½•</text>
      <text class="empty-desc">å¿«å»ç§¯åˆ†è½¬ç›˜è¯•è¯•æ‰‹æ°”å§ï¼</text>
      <button class="goto-lottery-btn" bindtap="onGoToLottery">
        å»æŠ½å¥–
      </button>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore && records.length > 0}}" bindtap="loadMoreRecords">
      <text class="load-text">{{loading ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š'}}</text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view class="no-more" wx:if="{{!hasMore && records.length > 0}}">
      <text class="no-more-text">æ²¡æœ‰æ›´å¤šè®°å½•äº†</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view> 