# é—®é¢˜ä¿®å¤éªŒè¯æ–‡æ¡£

## ðŸ“‹ ä¿®å¤ä»»åŠ¡æ¸…å•

### âœ… 1. ç”³è¯·å•†å®¶æƒé™æŒ‰é’®æ²¡æœ‰ååº”
**é—®é¢˜åˆ†æž**ï¼š
- åŽŸå› ï¼šæŒ‰é’®äº‹ä»¶ç»‘å®šæ­£ç¡®ï¼Œä½†å‡½æ•°å†…éƒ¨é€»è¾‘ä¸å®Œæ•´
- ç¼ºå°‘å¿…è¦çš„çŠ¶æ€ç®¡ç†å’Œç”¨æˆ·åé¦ˆ

**ä¿®å¤å†…å®¹**ï¼š
- ä¿®æ”¹ `pages/merchant/merchant.wxml`ï¼šæ·»åŠ æŒ‰é’®çŠ¶æ€æ˜¾ç¤ºå’Œç¦ç”¨çŠ¶æ€
- é‡æž„ `pages/merchant/merchant.js` ä¸­çš„ç”³è¯·é€»è¾‘ï¼š
  - æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†
  - å®Œå–„çŠ¶æ€ç®¡ç†ï¼ˆ`authRequesting`ï¼‰
  - å¢žå¼ºé”™è¯¯å¤„ç†
  - æ·»åŠ å¼€å‘çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒçš„åŒºåˆ†å¤„ç†
  - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼ˆåŠ è½½æç¤ºã€æˆåŠŸåé¦ˆï¼‰

**ä¿®å¤åŽæ•ˆæžœ**ï¼š
- âœ… ç‚¹å‡»æŒ‰é’®æœ‰æ˜Žç¡®çš„ç”¨æˆ·åé¦ˆ
- âœ… ç”³è¯·è¿‡ç¨‹ä¸­æŒ‰é’®æ˜¾ç¤º"ç”³è¯·ä¸­..."çŠ¶æ€
- âœ… ç”³è¯·æˆåŠŸåŽæ­£ç¡®æ›´æ–°é¡µé¢çŠ¶æ€
- âœ… é”™è¯¯å¤„ç†å®Œå–„ï¼Œç”¨æˆ·ä½“éªŒè‰¯å¥½

### âœ… 2. è½¬ç›˜å¥–å“æ–‡å­—æ–¹å‘é—®é¢˜
**é—®é¢˜åˆ†æž**ï¼š
- åŽŸå› ï¼šæ–‡å­—è·Ÿéšè½¬ç›˜æ—‹è½¬ï¼Œå¯¼è‡´åœ¨æŸäº›è§’åº¦ä¸‹æ–‡å­—é¢ å€’æ˜¾ç¤º
- éœ€è¦ç¡®ä¿æ–‡å­—å§‹ç»ˆä¿æŒæ­£ç¡®çš„é˜…è¯»æ–¹å‘

**ä¿®å¤å†…å®¹**ï¼š
- é‡æž„ `pages/lottery/lottery.js` ä¸­çš„ `drawWheel()` å‡½æ•°ï¼š
  - æ”¹è¿›æ–‡å­—å®šä½ç®—æ³•
  - æ·»åŠ æ–‡å­—è§’åº¦æ£€æµ‹é€»è¾‘
  - å½“æ–‡å­—ä¼šé¢ å€’æ—¶è‡ªåŠ¨æ—‹è½¬180åº¦çº æ­£
  - å¢žå¼ºæ–‡å­—æ˜¾ç¤ºæ•ˆæžœï¼ˆæè¾¹+å¡«å……ï¼‰
  - åå‘æŠµæ¶ˆè½¬ç›˜æ—‹è½¬è§’åº¦çš„å½±å“

**ä¿®å¤åŽæ•ˆæžœ**ï¼š
- âœ… ç«–å‘æ–‡å­—å§‹ç»ˆä»Žä¸Šåˆ°ä¸‹æ˜¾ç¤º
- âœ… æ¨ªå‘æ–‡å­—å§‹ç»ˆä»Žå·¦åˆ°å³æ˜¾ç¤º
- âœ… æ— è®ºè½¬ç›˜å¦‚ä½•æ—‹è½¬ï¼Œæ–‡å­—éƒ½ä¿æŒæ­£ç¡®æ–¹å‘
- âœ… æ–‡å­—æ˜¾ç¤ºæ›´æ¸…æ™°ï¼ˆæ·»åŠ äº†æè¾¹æ•ˆæžœï¼‰

### âœ… 3. è½¬ç›˜å¸ƒå±€ä¼˜åŒ–
**é—®é¢˜åˆ†æž**ï¼š
- åŽŸéœ€æ±‚ï¼šåœ¨è½¬ç›˜ä¸­å¿ƒæ·»åŠ å•æŠ½æŒ‰é’®
- åŽŸéœ€æ±‚ï¼šå°†ä¸‰è¿žæŠ½ã€äº”è¿žæŠ½ã€åè¿žæŠ½æŽ’æˆä¸€è¡Œ

**ä¿®å¤å†…å®¹**ï¼š

#### 3.1 é¡µé¢ç»“æž„è°ƒæ•´ (`pages/lottery/lottery.wxml`)
- åœ¨è½¬ç›˜å®¹å™¨ä¸­æ·»åŠ ä¸­å¤®å•æŠ½æŒ‰é’®
- é‡æ–°è®¾è®¡å¤šè¿žæŠ½æŒ‰é’®å¸ƒå±€ï¼ˆä»Ž2Ã—2ç½‘æ ¼æ”¹ä¸ºä¸€è¡Œä¸‰ä¸ªï¼‰
- ä¼˜åŒ–æŒ‰é’®å±‚çº§å…³ç³»ï¼ˆz-indexç®¡ç†ï¼‰

#### 3.2 æ ·å¼é‡æž„ (`pages/lottery/lottery.wxss`)
- **æ–°å¢žä¸­å¤®å•æŠ½æŒ‰é’®æ ·å¼**ï¼š
  - åœ†å½¢æŒ‰é’®ï¼Œå±…ä¸­å®šä½
  - æ¸å˜èƒŒæ™¯ï¼Œç™½è‰²è¾¹æ¡†
  - æ‚¬åœå’Œç¦ç”¨çŠ¶æ€
  - é€‚é…å“åº”å¼è®¾è®¡

- **é‡æž„å¤šè¿žæŠ½æŒ‰é’®å¸ƒå±€**ï¼š
  - ä»Žç½‘æ ¼å¸ƒå±€æ”¹ä¸ºå¼¹æ€§å¸ƒå±€
  - ä¸€è¡Œä¸‰ä¸ªæŒ‰é’®ï¼Œè‡ªé€‚åº”å®½åº¦
  - ä¿æŒåŽŸæœ‰çš„æ¸å˜èƒŒæ™¯è®¾è®¡
  - ä¼˜åŒ–æŒ‰é’®é—´è·å’Œå¤§å°

- **å“åº”å¼è®¾è®¡**ï¼š
  - å°å±å¹•ä¸‹æŒ‰é’®åž‚ç›´æŽ’åˆ—
  - ä¸­å¤®æŒ‰é’®å¤§å°è‡ªé€‚åº”
  - æ–‡å­—å¤§å°åŠ¨æ€è°ƒæ•´

**ä¿®å¤åŽæ•ˆæžœ**ï¼š
- âœ… è½¬ç›˜ä¸­å¤®æ˜¾ç¤ºåœ†å½¢å•æŠ½æŒ‰é’®
- âœ… ä¸‰è¿žæŠ½ã€äº”è¿žæŠ½ã€åè¿žæŠ½æ°´å¹³æŽ’åˆ—
- âœ… æ•´ä½“å¸ƒå±€æ›´ç¾Žè§‚ã€æ›´ç¬¦åˆç”¨æˆ·æ“ä½œä¹ æƒ¯
- âœ… å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒä¸åŒå±å¹•å°ºå¯¸

## ðŸŽ¯ æŠ€æœ¯å®žçŽ°è¦ç‚¹

### 1. å•†å®¶æƒé™ç”³è¯·ä¼˜åŒ–
```javascript
// æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†
wx.showModal({
  title: 'ç”³è¯·å•†å®¶æƒé™',
  content: 'æ‚¨ç¡®å®šè¦ç”³è¯·å•†å®¶æƒé™å—ï¼Ÿ...',
  success: (res) => {
    if (res.confirm) {
      this.confirmAuthRequest()
    }
  }
})

// å®Œå–„çŠ¶æ€ç®¡ç†
this.setData({ authRequesting: true })
// ... ç”³è¯·é€»è¾‘
this.setData({ authRequesting: false })
```

### 2. è½¬ç›˜æ–‡å­—æ–¹å‘ä¿®å¤
```javascript
// è®¡ç®—æ–‡å­—è§’åº¦å¹¶çº æ­£æ–¹å‘
let textAngle = midAngle
const normalizedAngle = ((textAngle * 180 / Math.PI) % 360 + 360) % 360

// å¦‚æžœæ–‡å­—ä¼šé¢ å€’æ˜¾ç¤ºï¼Œåˆ™æ—‹è½¬180åº¦
if (normalizedAngle > 90 && normalizedAngle < 270) {
  textAngle += Math.PI
}

// åå‘æŠµæ¶ˆè½¬ç›˜æ—‹è½¬
ctx.rotate(textAngle - this.data.currentAngle * Math.PI / 180)
```

### 3. è½¬ç›˜å¸ƒå±€é‡æž„
```css
/* ä¸­å¤®å•æŠ½æŒ‰é’® */
.center-draw-btn {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100rpx;
  height: 100rpx;
  border-radius: 50%;
  /* ... æ›´å¤šæ ·å¼ */
}

/* å¤šè¿žæŠ½æŒ‰é’®ä¸€è¡Œå¸ƒå±€ */
.multi-draw-buttons {
  display: flex;
  gap: 20rpx;
  justify-content: center;
  flex-wrap: wrap;
}
```

## ðŸ”§ åŽç«¯å¯¹æŽ¥è¯´æ˜Ž

### å•†å®¶æƒé™ç”³è¯·æŽ¥å£
```javascript
// TODO: åŽç«¯å®žçŽ°
// POST /api/merchant/auth
// è¯·æ±‚ä½“ï¼š{
//   store_name: "é¤åŽ…åç§°",
//   business_license: "è¥ä¸šæ‰§ç…§å·", 
//   contact_person: "è”ç³»äºº",
//   contact_phone: "è”ç³»ç”µè¯"
// }
```

### æŠ½å¥–é…ç½®æŽ¥å£
```javascript
// TODO: åŽç«¯å®žçŽ°
// GET /api/lottery/config
// è¿”å›žè½¬ç›˜å¥–å“é…ç½®å’Œè§„åˆ™
```

## ðŸ“± æµ‹è¯•æŒ‡å—

### å•†å®¶æƒé™ç”³è¯·æµ‹è¯•
1. è¿›å…¥ç”¨æˆ·é¡µé¢ï¼Œç‚¹å‡»å•†å®¶ç®¡ç†å…¥å£
2. åœ¨éžå•†å®¶çŠ¶æ€ä¸‹ï¼Œåº”æ˜¾ç¤ºç”³è¯·æƒé™ç•Œé¢
3. ç‚¹å‡»"ç”³è¯·å•†å®¶æƒé™"æŒ‰é’®
4. åº”æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
5. ç¡®è®¤åŽæ˜¾ç¤º"ç”³è¯·ä¸­..."çŠ¶æ€
6. ç”³è¯·æˆåŠŸåŽé¡µé¢è‡ªåŠ¨åˆ‡æ¢åˆ°å•†å®¶ç®¡ç†ç•Œé¢

### è½¬ç›˜åŠŸèƒ½æµ‹è¯•
1. è¿›å…¥æŠ½å¥–é¡µé¢
2. æ£€æŸ¥è½¬ç›˜æ–‡å­—æ˜¯å¦å§‹ç»ˆä¿æŒæ­£ç¡®æ–¹å‘
3. ç‚¹å‡»ä¸­å¤®å•æŠ½æŒ‰é’®æµ‹è¯•åŠŸèƒ½
4. ç‚¹å‡»ä¸‹æ–¹ä¸‰è¿žæŠ½ã€äº”è¿žæŠ½ã€åè¿žæŠ½æŒ‰é’®
5. åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹æµ‹è¯•å“åº”å¼æ•ˆæžœ

## ðŸŽ‰ æ€»ç»“

æ‰€æœ‰ä¸‰ä¸ªé—®é¢˜éƒ½å·²æˆåŠŸä¿®å¤ï¼š
1. âœ… ç”³è¯·å•†å®¶æƒé™åŠŸèƒ½æ­£å¸¸å·¥ä½œ
2. âœ… è½¬ç›˜æ–‡å­—æ–¹å‘å§‹ç»ˆæ­£ç¡®æ˜¾ç¤º
3. âœ… è½¬ç›˜å¸ƒå±€ä¼˜åŒ–å®Œæˆï¼Œä¸­å¤®å•æŠ½+åº•éƒ¨ä¸‰æŒ‰é’®ä¸€è¡Œ

ä»£ç è´¨é‡ï¼š
- ä¿æŒäº†åŽŸæœ‰åŠŸèƒ½çš„å®Œæ•´æ€§
- æ·»åŠ äº†å®Œå–„çš„æ³¨é‡Šå’Œæ–‡æ¡£
- è€ƒè™‘äº†åŽç«¯å¯¹æŽ¥çš„éœ€æ±‚
- å®žçŽ°äº†å“åº”å¼è®¾è®¡
- é”™è¯¯å¤„ç†å®Œå–„ 